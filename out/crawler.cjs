"use strict";var Ff=Object.create;var ls=Object.defineProperty;var Nf=Object.getOwnPropertyDescriptor;var Wf=Object.getOwnPropertyNames;var $f=Object.getPrototypeOf,Uf=Object.prototype.hasOwnProperty;var Ht=(t,e)=>()=>(t&&(e=t(t=0)),e);var R=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),zf=(t,e)=>{for(var r in e)ls(t,r,{get:e[r],enumerable:!0})},Qf=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Wf(e))!Uf.call(t,o)&&o!==r&&ls(t,o,{get:()=>e[o],enumerable:!(s=Nf(e,o))||s.enumerable});return t};var Se=(t,e,r)=>(r=t!=null?Ff($f(t)):{},Qf(e||!t||!t.__esModule?ls(r,"default",{value:t,enumerable:!0}):r,t));var ua=R((Km,aa)=>{function de(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}aa.exports=de;de.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};de.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};de.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},r),this._options.unref&&this._timer.unref(),!0};de.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};de.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};de.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};de.prototype.start=de.prototype.try;de.prototype.errors=function(){return this._errors};de.prototype.attempts=function(){return this._attempts};de.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,s=0;s<this._errors.length;s++){var o=this._errors[s],u=o.message,l=(t[u]||0)+1;t[u]=l,l>=r&&(e=o,r=l)}return e}});var la=R(tt=>{var jf=ua();tt.operation=function(t){var e=tt.timeouts(t);return new jf(e,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};tt.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var s=[],o=0;o<e.retries;o++)s.push(this.createTimeout(o,e));return t&&t.forever&&!s.length&&s.push(this.createTimeout(o,e)),s.sort(function(u,l){return u-l}),s};tt.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,s=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return s=Math.min(s,e.maxTimeout),s};tt.wrap=function(t,e,r){if(e instanceof Array&&(r=e,e=null),!r){r=[];for(var s in t)typeof t[s]=="function"&&r.push(s)}for(var o=0;o<r.length;o++){var u=r[o],l=t[u];t[u]=function(d){var f=tt.operation(e),m=Array.prototype.slice.call(arguments,1),y=m.pop();m.push(function(g){f.retry(g)||(g&&(arguments[0]=f.mainError()),y.apply(this,arguments))}),f.attempt(function(){d.apply(t,m)})}.bind(t,l),t[u].options=e}}});var fa=R((Zm,ca)=>{ca.exports=la()});var ha=R((Xm,da)=>{var Hf=fa();function Gf(t,e){function r(s,o){var u=e||{},l;"randomize"in u||(u.randomize=!0),l=Hf.operation(u);function p(m){o(m||new Error("Aborted"))}function d(m,y){if(m.bail){p(m);return}l.retry(m)?u.onRetry&&u.onRetry(m,y):o(l.mainError())}function f(m){var y;try{y=t(p,m)}catch(g){d(g,m);return}Promise.resolve(y).then(s).catch(function(S){d(S,m)})}l.attempt(f)}return new Promise(r)}da.exports=Gf});var ya=R((Gr,ma)=>{(function(t,e){typeof Gr=="object"&&typeof ma<"u"?e(Gr):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis<"u"?globalThis:t||self,e(t.WebStreamsPolyfill={}))})(Gr,function(t){"use strict";let e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:n=>`Symbol(${n})`;function r(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let o=s();function u(n){return typeof n=="object"&&n!==null||typeof n=="function"}let l=r,p=Promise,d=Promise.prototype.then,f=Promise.resolve.bind(p),m=Promise.reject.bind(p);function y(n){return new p(n)}function g(n){return f(n)}function S(n){return m(n)}function w(n,i,a){return d.call(n,i,a)}function I(n,i,a){w(w(n,i,a),void 0,l)}function D(n,i){I(n,i)}function k(n,i){I(n,void 0,i)}function W(n,i,a){return w(n,i,a)}function ee(n){w(n,void 0,l)}let x=(()=>{let n=o&&o.queueMicrotask;if(typeof n=="function")return n;let i=g(void 0);return a=>w(i,a)})();function j(n,i,a){if(typeof n!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(n,i,a)}function M(n,i,a){try{return g(j(n,i,a))}catch(c){return S(c)}}let Le=16384;class oe{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(i){let a=this._back,c=a;a._elements.length===Le-1&&(c={_elements:[],_next:void 0}),a._elements.push(i),c!==a&&(this._back=c,a._next=c),++this._size}shift(){let i=this._front,a=i,c=this._cursor,h=c+1,_=i._elements,b=_[c];return h===Le&&(a=i._next,h=0),--this._size,this._cursor=h,i!==a&&(this._front=a),_[c]=void 0,b}forEach(i){let a=this._cursor,c=this._front,h=c._elements;for(;(a!==h.length||c._next!==void 0)&&!(a===h.length&&(c=c._next,h=c._elements,a=0,h.length===0));)i(h[a]),++a}peek(){let i=this._front,a=this._cursor;return i._elements[a]}}function ji(n,i){n._ownerReadableStream=i,i._reader=n,i._state==="readable"?xn(n):i._state==="closed"?dc(n):Hi(n,i._storedError)}function Dn(n,i){let a=n._ownerReadableStream;return be(a,i)}function Ce(n){n._ownerReadableStream._state==="readable"?qn(n,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):hc(n,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),n._ownerReadableStream._reader=void 0,n._ownerReadableStream=void 0}function at(n){return new TypeError("Cannot "+n+" a stream using a released reader")}function xn(n){n._closedPromise=y((i,a)=>{n._closedPromise_resolve=i,n._closedPromise_reject=a})}function Hi(n,i){xn(n),qn(n,i)}function dc(n){xn(n),Gi(n)}function qn(n,i){n._closedPromise_reject!==void 0&&(ee(n._closedPromise),n._closedPromise_reject(i),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0)}function hc(n,i){Hi(n,i)}function Gi(n){n._closedPromise_resolve!==void 0&&(n._closedPromise_resolve(void 0),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0)}let Yi=e("[[AbortSteps]]"),Vi=e("[[ErrorSteps]]"),Bn=e("[[CancelSteps]]"),kn=e("[[PullSteps]]"),Ki=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},pc=Math.trunc||function(n){return n<0?Math.ceil(n):Math.floor(n)};function mc(n){return typeof n=="object"||typeof n=="function"}function Pe(n,i){if(n!==void 0&&!mc(n))throw new TypeError(`${i} is not an object.`)}function ye(n,i){if(typeof n!="function")throw new TypeError(`${i} is not a function.`)}function yc(n){return typeof n=="object"&&n!==null||typeof n=="function"}function Ji(n,i){if(!yc(n))throw new TypeError(`${i} is not an object.`)}function Ae(n,i,a){if(n===void 0)throw new TypeError(`Parameter ${i} is required in '${a}'.`)}function Mn(n,i,a){if(n===void 0)throw new TypeError(`${i} is required in '${a}'.`)}function Ln(n){return Number(n)}function Zi(n){return n===0?0:n}function _c(n){return Zi(pc(n))}function Xi(n,i){let c=Number.MAX_SAFE_INTEGER,h=Number(n);if(h=Zi(h),!Ki(h))throw new TypeError(`${i} is not a finite number`);if(h=_c(h),h<0||h>c)throw new TypeError(`${i} is outside the accepted range of ${0} to ${c}, inclusive`);return!Ki(h)||h===0?0:h}function Fn(n,i){if(!Ue(n))throw new TypeError(`${i} is not a ReadableStream.`)}function ut(n){return new Dt(n)}function eo(n,i){n._reader._readRequests.push(i)}function Nn(n,i,a){let h=n._reader._readRequests.shift();a?h._closeSteps():h._chunkSteps(i)}function mr(n){return n._reader._readRequests.length}function to(n){let i=n._reader;return!(i===void 0||!Fe(i))}class Dt{constructor(i){if(Ae(i,1,"ReadableStreamDefaultReader"),Fn(i,"First parameter"),ze(i))throw new TypeError("This stream has already been locked for exclusive reading by another reader");ji(this,i),this._readRequests=new oe}get closed(){return Fe(this)?this._closedPromise:S(yr("closed"))}cancel(i=void 0){return Fe(this)?this._ownerReadableStream===void 0?S(at("cancel")):Dn(this,i):S(yr("cancel"))}read(){if(!Fe(this))return S(yr("read"));if(this._ownerReadableStream===void 0)return S(at("read from"));let i,a,c=y((_,b)=>{i=_,a=b});return xt(this,{_chunkSteps:_=>i({value:_,done:!1}),_closeSteps:()=>i({value:void 0,done:!0}),_errorSteps:_=>a(_)}),c}releaseLock(){if(!Fe(this))throw yr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Ce(this)}}}Object.defineProperties(Dt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Dt.prototype,e.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function Fe(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_readRequests")?!1:n instanceof Dt}function xt(n,i){let a=n._ownerReadableStream;a._disturbed=!0,a._state==="closed"?i._closeSteps():a._state==="errored"?i._errorSteps(a._storedError):a._readableStreamController[kn](i)}function yr(n){return new TypeError(`ReadableStreamDefaultReader.prototype.${n} can only be used on a ReadableStreamDefaultReader`)}let ro=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class no{constructor(i,a){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=i,this._preventCancel=a}next(){let i=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?W(this._ongoingPromise,i,i):i(),this._ongoingPromise}return(i){let a=()=>this._returnSteps(i);return this._ongoingPromise?W(this._ongoingPromise,a,a):a()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let i=this._reader;if(i._ownerReadableStream===void 0)return S(at("iterate"));let a,c,h=y((b,E)=>{a=b,c=E});return xt(i,{_chunkSteps:b=>{this._ongoingPromise=void 0,x(()=>a({value:b,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,Ce(i),a({value:void 0,done:!0})},_errorSteps:b=>{this._ongoingPromise=void 0,this._isFinished=!0,Ce(i),c(b)}}),h}_returnSteps(i){if(this._isFinished)return Promise.resolve({value:i,done:!0});this._isFinished=!0;let a=this._reader;if(a._ownerReadableStream===void 0)return S(at("finish iterating"));if(!this._preventCancel){let c=Dn(a,i);return Ce(a),W(c,()=>({value:i,done:!0}))}return Ce(a),g({value:i,done:!0})}}let so={next(){return io(this)?this._asyncIteratorImpl.next():S(oo("next"))},return(n){return io(this)?this._asyncIteratorImpl.return(n):S(oo("return"))}};ro!==void 0&&Object.setPrototypeOf(so,ro);function bc(n,i){let a=ut(n),c=new no(a,i),h=Object.create(so);return h._asyncIteratorImpl=c,h}function io(n){if(!u(n)||!Object.prototype.hasOwnProperty.call(n,"_asyncIteratorImpl"))return!1;try{return n._asyncIteratorImpl instanceof no}catch{return!1}}function oo(n){return new TypeError(`ReadableStreamAsyncIterator.${n} can only be used on a ReadableSteamAsyncIterator`)}let ao=Number.isNaN||function(n){return n!==n};function qt(n){return n.slice()}function uo(n,i,a,c,h){new Uint8Array(n).set(new Uint8Array(a,c,h),i)}function Ym(n){return n}function _r(n){return!1}function lo(n,i,a){if(n.slice)return n.slice(i,a);let c=a-i,h=new ArrayBuffer(c);return uo(h,0,n,i,c),h}function gc(n){return!(typeof n!="number"||ao(n)||n<0)}function co(n){let i=lo(n.buffer,n.byteOffset,n.byteOffset+n.byteLength);return new Uint8Array(i)}function Wn(n){let i=n._queue.shift();return n._queueTotalSize-=i.size,n._queueTotalSize<0&&(n._queueTotalSize=0),i.value}function $n(n,i,a){if(!gc(a)||a===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");n._queue.push({value:i,size:a}),n._queueTotalSize+=a}function Sc(n){return n._queue.peek().value}function Ne(n){n._queue=new oe,n._queueTotalSize=0}class Bt{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Un(this))throw Hn("view");return this._view}respond(i){if(!Un(this))throw Hn("respond");if(Ae(i,1,"respond"),i=Xi(i,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");_r(this._view.buffer),Er(this._associatedReadableByteStreamController,i)}respondWithNewView(i){if(!Un(this))throw Hn("respondWithNewView");if(Ae(i,1,"respondWithNewView"),!ArrayBuffer.isView(i))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");_r(i.buffer),Rr(this._associatedReadableByteStreamController,i)}}Object.defineProperties(Bt.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Bt.prototype,e.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class lt{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Ve(this))throw Mt("byobRequest");return jn(this)}get desiredSize(){if(!Ve(this))throw Mt("desiredSize");return go(this)}close(){if(!Ve(this))throw Mt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let i=this._controlledReadableByteStream._state;if(i!=="readable")throw new TypeError(`The stream (in ${i} state) is not in the readable state and cannot be closed`);kt(this)}enqueue(i){if(!Ve(this))throw Mt("enqueue");if(Ae(i,1,"enqueue"),!ArrayBuffer.isView(i))throw new TypeError("chunk must be an array buffer view");if(i.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(i.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let a=this._controlledReadableByteStream._state;if(a!=="readable")throw new TypeError(`The stream (in ${a} state) is not in the readable state and cannot be enqueued to`);wr(this,i)}error(i=void 0){if(!Ve(this))throw Mt("error");_e(this,i)}[Bn](i){fo(this),Ne(this);let a=this._cancelAlgorithm(i);return Sr(this),a}[kn](i){let a=this._controlledReadableByteStream;if(this._queueTotalSize>0){let h=this._queue.shift();this._queueTotalSize-=h.byteLength,yo(this);let _=new Uint8Array(h.buffer,h.byteOffset,h.byteLength);i._chunkSteps(_);return}let c=this._autoAllocateChunkSize;if(c!==void 0){let h;try{h=new ArrayBuffer(c)}catch(b){i._errorSteps(b);return}let _={buffer:h,bufferByteLength:c,byteOffset:0,byteLength:c,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(_)}eo(a,i),Ke(this)}}Object.defineProperties(lt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(lt.prototype,e.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Ve(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledReadableByteStream")?!1:n instanceof lt}function Un(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_associatedReadableByteStreamController")?!1:n instanceof Bt}function Ke(n){if(!vc(n))return;if(n._pulling){n._pullAgain=!0;return}n._pulling=!0;let a=n._pullAlgorithm();I(a,()=>{n._pulling=!1,n._pullAgain&&(n._pullAgain=!1,Ke(n))},c=>{_e(n,c)})}function fo(n){Qn(n),n._pendingPullIntos=new oe}function zn(n,i){let a=!1;n._state==="closed"&&(a=!0);let c=ho(i);i.readerType==="default"?Nn(n,c,a):Pc(n,c,a)}function ho(n){let i=n.bytesFilled,a=n.elementSize;return new n.viewConstructor(n.buffer,n.byteOffset,i/a)}function br(n,i,a,c){n._queue.push({buffer:i,byteOffset:a,byteLength:c}),n._queueTotalSize+=c}function po(n,i){let a=i.elementSize,c=i.bytesFilled-i.bytesFilled%a,h=Math.min(n._queueTotalSize,i.byteLength-i.bytesFilled),_=i.bytesFilled+h,b=_-_%a,E=h,P=!1;b>c&&(E=b-i.bytesFilled,P=!0);let O=n._queue;for(;E>0;){let q=O.peek(),B=Math.min(E,q.byteLength),H=i.byteOffset+i.bytesFilled;uo(i.buffer,H,q.buffer,q.byteOffset,B),q.byteLength===B?O.shift():(q.byteOffset+=B,q.byteLength-=B),n._queueTotalSize-=B,mo(n,B,i),E-=B}return P}function mo(n,i,a){a.bytesFilled+=i}function yo(n){n._queueTotalSize===0&&n._closeRequested?(Sr(n),Qt(n._controlledReadableByteStream)):Ke(n)}function Qn(n){n._byobRequest!==null&&(n._byobRequest._associatedReadableByteStreamController=void 0,n._byobRequest._view=null,n._byobRequest=null)}function _o(n){for(;n._pendingPullIntos.length>0;){if(n._queueTotalSize===0)return;let i=n._pendingPullIntos.peek();po(n,i)&&(gr(n),zn(n._controlledReadableByteStream,i))}}function wc(n,i,a){let c=n._controlledReadableByteStream,h=1;i.constructor!==DataView&&(h=i.constructor.BYTES_PER_ELEMENT);let _=i.constructor,b=i.buffer,E={buffer:b,bufferByteLength:b.byteLength,byteOffset:i.byteOffset,byteLength:i.byteLength,bytesFilled:0,elementSize:h,viewConstructor:_,readerType:"byob"};if(n._pendingPullIntos.length>0){n._pendingPullIntos.push(E),Eo(c,a);return}if(c._state==="closed"){let P=new _(E.buffer,E.byteOffset,0);a._closeSteps(P);return}if(n._queueTotalSize>0){if(po(n,E)){let P=ho(E);yo(n),a._chunkSteps(P);return}if(n._closeRequested){let P=new TypeError("Insufficient bytes to fill elements in the given buffer");_e(n,P),a._errorSteps(P);return}}n._pendingPullIntos.push(E),Eo(c,a),Ke(n)}function Ec(n,i){let a=n._controlledReadableByteStream;if(Gn(a))for(;Ro(a)>0;){let c=gr(n);zn(a,c)}}function Rc(n,i,a){if(mo(n,i,a),a.bytesFilled<a.elementSize)return;gr(n);let c=a.bytesFilled%a.elementSize;if(c>0){let h=a.byteOffset+a.bytesFilled,_=lo(a.buffer,h-c,h);br(n,_,0,_.byteLength)}a.bytesFilled-=c,zn(n._controlledReadableByteStream,a),_o(n)}function bo(n,i){let a=n._pendingPullIntos.peek();Qn(n),n._controlledReadableByteStream._state==="closed"?Ec(n):Rc(n,i,a),Ke(n)}function gr(n){return n._pendingPullIntos.shift()}function vc(n){let i=n._controlledReadableByteStream;return i._state!=="readable"||n._closeRequested||!n._started?!1:!!(to(i)&&mr(i)>0||Gn(i)&&Ro(i)>0||go(n)>0)}function Sr(n){n._pullAlgorithm=void 0,n._cancelAlgorithm=void 0}function kt(n){let i=n._controlledReadableByteStream;if(!(n._closeRequested||i._state!=="readable")){if(n._queueTotalSize>0){n._closeRequested=!0;return}if(n._pendingPullIntos.length>0&&n._pendingPullIntos.peek().bytesFilled>0){let c=new TypeError("Insufficient bytes to fill elements in the given buffer");throw _e(n,c),c}Sr(n),Qt(i)}}function wr(n,i){let a=n._controlledReadableByteStream;if(n._closeRequested||a._state!=="readable")return;let c=i.buffer,h=i.byteOffset,_=i.byteLength,b=c;if(n._pendingPullIntos.length>0){let E=n._pendingPullIntos.peek();_r(E.buffer),E.buffer=E.buffer}if(Qn(n),to(a))if(mr(a)===0)br(n,b,h,_);else{n._pendingPullIntos.length>0&&gr(n);let E=new Uint8Array(b,h,_);Nn(a,E,!1)}else Gn(a)?(br(n,b,h,_),_o(n)):br(n,b,h,_);Ke(n)}function _e(n,i){let a=n._controlledReadableByteStream;a._state==="readable"&&(fo(n),Ne(n),Sr(n),Go(a,i))}function jn(n){if(n._byobRequest===null&&n._pendingPullIntos.length>0){let i=n._pendingPullIntos.peek(),a=new Uint8Array(i.buffer,i.byteOffset+i.bytesFilled,i.byteLength-i.bytesFilled),c=Object.create(Bt.prototype);Cc(c,n,a),n._byobRequest=c}return n._byobRequest}function go(n){let i=n._controlledReadableByteStream._state;return i==="errored"?null:i==="closed"?0:n._strategyHWM-n._queueTotalSize}function Er(n,i){let a=n._pendingPullIntos.peek();if(n._controlledReadableByteStream._state==="closed"){if(i!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(i===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(a.bytesFilled+i>a.byteLength)throw new RangeError("bytesWritten out of range")}a.buffer=a.buffer,bo(n,i)}function Rr(n,i){let a=n._pendingPullIntos.peek();if(n._controlledReadableByteStream._state==="closed"){if(i.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(i.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(a.byteOffset+a.bytesFilled!==i.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(a.bufferByteLength!==i.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(a.bytesFilled+i.byteLength>a.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let h=i.byteLength;a.buffer=i.buffer,bo(n,h)}function So(n,i,a,c,h,_,b){i._controlledReadableByteStream=n,i._pullAgain=!1,i._pulling=!1,i._byobRequest=null,i._queue=i._queueTotalSize=void 0,Ne(i),i._closeRequested=!1,i._started=!1,i._strategyHWM=_,i._pullAlgorithm=c,i._cancelAlgorithm=h,i._autoAllocateChunkSize=b,i._pendingPullIntos=new oe,n._readableStreamController=i;let E=a();I(g(E),()=>{i._started=!0,Ke(i)},P=>{_e(i,P)})}function Tc(n,i,a){let c=Object.create(lt.prototype),h=()=>{},_=()=>g(void 0),b=()=>g(void 0);i.start!==void 0&&(h=()=>i.start(c)),i.pull!==void 0&&(_=()=>i.pull(c)),i.cancel!==void 0&&(b=P=>i.cancel(P));let E=i.autoAllocateChunkSize;if(E===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");So(n,c,h,_,b,a,E)}function Cc(n,i,a){n._associatedReadableByteStreamController=i,n._view=a}function Hn(n){return new TypeError(`ReadableStreamBYOBRequest.prototype.${n} can only be used on a ReadableStreamBYOBRequest`)}function Mt(n){return new TypeError(`ReadableByteStreamController.prototype.${n} can only be used on a ReadableByteStreamController`)}function wo(n){return new Lt(n)}function Eo(n,i){n._reader._readIntoRequests.push(i)}function Pc(n,i,a){let h=n._reader._readIntoRequests.shift();a?h._closeSteps(i):h._chunkSteps(i)}function Ro(n){return n._reader._readIntoRequests.length}function Gn(n){let i=n._reader;return!(i===void 0||!Je(i))}class Lt{constructor(i){if(Ae(i,1,"ReadableStreamBYOBReader"),Fn(i,"First parameter"),ze(i))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Ve(i._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");ji(this,i),this._readIntoRequests=new oe}get closed(){return Je(this)?this._closedPromise:S(vr("closed"))}cancel(i=void 0){return Je(this)?this._ownerReadableStream===void 0?S(at("cancel")):Dn(this,i):S(vr("cancel"))}read(i){if(!Je(this))return S(vr("read"));if(!ArrayBuffer.isView(i))return S(new TypeError("view must be an array buffer view"));if(i.byteLength===0)return S(new TypeError("view must have non-zero byteLength"));if(i.buffer.byteLength===0)return S(new TypeError("view's buffer must have non-zero byteLength"));if(_r(i.buffer),this._ownerReadableStream===void 0)return S(at("read from"));let a,c,h=y((b,E)=>{a=b,c=E});return vo(this,i,{_chunkSteps:b=>a({value:b,done:!1}),_closeSteps:b=>a({value:b,done:!0}),_errorSteps:b=>c(b)}),h}releaseLock(){if(!Je(this))throw vr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Ce(this)}}}Object.defineProperties(Lt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Lt.prototype,e.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Je(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_readIntoRequests")?!1:n instanceof Lt}function vo(n,i,a){let c=n._ownerReadableStream;c._disturbed=!0,c._state==="errored"?a._errorSteps(c._storedError):wc(c._readableStreamController,i,a)}function vr(n){return new TypeError(`ReadableStreamBYOBReader.prototype.${n} can only be used on a ReadableStreamBYOBReader`)}function Ft(n,i){let{highWaterMark:a}=n;if(a===void 0)return i;if(ao(a)||a<0)throw new RangeError("Invalid highWaterMark");return a}function Tr(n){let{size:i}=n;return i||(()=>1)}function Cr(n,i){Pe(n,i);let a=n?.highWaterMark,c=n?.size;return{highWaterMark:a===void 0?void 0:Ln(a),size:c===void 0?void 0:Ac(c,`${i} has member 'size' that`)}}function Ac(n,i){return ye(n,i),a=>Ln(n(a))}function Oc(n,i){Pe(n,i);let a=n?.abort,c=n?.close,h=n?.start,_=n?.type,b=n?.write;return{abort:a===void 0?void 0:Ic(a,n,`${i} has member 'abort' that`),close:c===void 0?void 0:Dc(c,n,`${i} has member 'close' that`),start:h===void 0?void 0:xc(h,n,`${i} has member 'start' that`),write:b===void 0?void 0:qc(b,n,`${i} has member 'write' that`),type:_}}function Ic(n,i,a){return ye(n,a),c=>M(n,i,[c])}function Dc(n,i,a){return ye(n,a),()=>M(n,i,[])}function xc(n,i,a){return ye(n,a),c=>j(n,i,[c])}function qc(n,i,a){return ye(n,a),(c,h)=>M(n,i,[c,h])}function To(n,i){if(!ct(n))throw new TypeError(`${i} is not a WritableStream.`)}function Bc(n){if(typeof n!="object"||n===null)return!1;try{return typeof n.aborted=="boolean"}catch{return!1}}let kc=typeof AbortController=="function";function Mc(){if(kc)return new AbortController}class Nt{constructor(i={},a={}){i===void 0?i=null:Ji(i,"First parameter");let c=Cr(a,"Second parameter"),h=Oc(i,"First parameter");if(Po(this),h.type!==void 0)throw new RangeError("Invalid type is specified");let b=Tr(c),E=Ft(c,1);Kc(this,h,E,b)}get locked(){if(!ct(this))throw Dr("locked");return ft(this)}abort(i=void 0){return ct(this)?ft(this)?S(new TypeError("Cannot abort a stream that already has a writer")):Pr(this,i):S(Dr("abort"))}close(){return ct(this)?ft(this)?S(new TypeError("Cannot close a stream that already has a writer")):Re(this)?S(new TypeError("Cannot close an already-closing stream")):Ao(this):S(Dr("close"))}getWriter(){if(!ct(this))throw Dr("getWriter");return Co(this)}}Object.defineProperties(Nt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Nt.prototype,e.toStringTag,{value:"WritableStream",configurable:!0});function Co(n){return new Wt(n)}function Lc(n,i,a,c,h=1,_=()=>1){let b=Object.create(Nt.prototype);Po(b);let E=Object.create(dt.prototype);return Bo(b,E,n,i,a,c,h,_),b}function Po(n){n._state="writable",n._storedError=void 0,n._writer=void 0,n._writableStreamController=void 0,n._writeRequests=new oe,n._inFlightWriteRequest=void 0,n._closeRequest=void 0,n._inFlightCloseRequest=void 0,n._pendingAbortRequest=void 0,n._backpressure=!1}function ct(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_writableStreamController")?!1:n instanceof Nt}function ft(n){return n._writer!==void 0}function Pr(n,i){var a;if(n._state==="closed"||n._state==="errored")return g(void 0);n._writableStreamController._abortReason=i,(a=n._writableStreamController._abortController)===null||a===void 0||a.abort();let c=n._state;if(c==="closed"||c==="errored")return g(void 0);if(n._pendingAbortRequest!==void 0)return n._pendingAbortRequest._promise;let h=!1;c==="erroring"&&(h=!0,i=void 0);let _=y((b,E)=>{n._pendingAbortRequest={_promise:void 0,_resolve:b,_reject:E,_reason:i,_wasAlreadyErroring:h}});return n._pendingAbortRequest._promise=_,h||Vn(n,i),_}function Ao(n){let i=n._state;if(i==="closed"||i==="errored")return S(new TypeError(`The stream (in ${i} state) is not in the writable state and cannot be closed`));let a=y((h,_)=>{let b={_resolve:h,_reject:_};n._closeRequest=b}),c=n._writer;return c!==void 0&&n._backpressure&&i==="writable"&&ss(c),Jc(n._writableStreamController),a}function Fc(n){return y((a,c)=>{let h={_resolve:a,_reject:c};n._writeRequests.push(h)})}function Yn(n,i){if(n._state==="writable"){Vn(n,i);return}Kn(n)}function Vn(n,i){let a=n._writableStreamController;n._state="erroring",n._storedError=i;let c=n._writer;c!==void 0&&Io(c,i),!zc(n)&&a._started&&Kn(n)}function Kn(n){n._state="errored",n._writableStreamController[Vi]();let i=n._storedError;if(n._writeRequests.forEach(h=>{h._reject(i)}),n._writeRequests=new oe,n._pendingAbortRequest===void 0){Ar(n);return}let a=n._pendingAbortRequest;if(n._pendingAbortRequest=void 0,a._wasAlreadyErroring){a._reject(i),Ar(n);return}let c=n._writableStreamController[Yi](a._reason);I(c,()=>{a._resolve(),Ar(n)},h=>{a._reject(h),Ar(n)})}function Nc(n){n._inFlightWriteRequest._resolve(void 0),n._inFlightWriteRequest=void 0}function Wc(n,i){n._inFlightWriteRequest._reject(i),n._inFlightWriteRequest=void 0,Yn(n,i)}function $c(n){n._inFlightCloseRequest._resolve(void 0),n._inFlightCloseRequest=void 0,n._state==="erroring"&&(n._storedError=void 0,n._pendingAbortRequest!==void 0&&(n._pendingAbortRequest._resolve(),n._pendingAbortRequest=void 0)),n._state="closed";let a=n._writer;a!==void 0&&Fo(a)}function Uc(n,i){n._inFlightCloseRequest._reject(i),n._inFlightCloseRequest=void 0,n._pendingAbortRequest!==void 0&&(n._pendingAbortRequest._reject(i),n._pendingAbortRequest=void 0),Yn(n,i)}function Re(n){return!(n._closeRequest===void 0&&n._inFlightCloseRequest===void 0)}function zc(n){return!(n._inFlightWriteRequest===void 0&&n._inFlightCloseRequest===void 0)}function Qc(n){n._inFlightCloseRequest=n._closeRequest,n._closeRequest=void 0}function jc(n){n._inFlightWriteRequest=n._writeRequests.shift()}function Ar(n){n._closeRequest!==void 0&&(n._closeRequest._reject(n._storedError),n._closeRequest=void 0);let i=n._writer;i!==void 0&&rs(i,n._storedError)}function Jn(n,i){let a=n._writer;a!==void 0&&i!==n._backpressure&&(i?sf(a):ss(a)),n._backpressure=i}class Wt{constructor(i){if(Ae(i,1,"WritableStreamDefaultWriter"),To(i,"First parameter"),ft(i))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=i,i._writer=this;let a=i._state;if(a==="writable")!Re(i)&&i._backpressure?qr(this):No(this),xr(this);else if(a==="erroring")ns(this,i._storedError),xr(this);else if(a==="closed")No(this),rf(this);else{let c=i._storedError;ns(this,c),Lo(this,c)}}get closed(){return Ze(this)?this._closedPromise:S(Xe("closed"))}get desiredSize(){if(!Ze(this))throw Xe("desiredSize");if(this._ownerWritableStream===void 0)throw $t("desiredSize");return Vc(this)}get ready(){return Ze(this)?this._readyPromise:S(Xe("ready"))}abort(i=void 0){return Ze(this)?this._ownerWritableStream===void 0?S($t("abort")):Hc(this,i):S(Xe("abort"))}close(){if(!Ze(this))return S(Xe("close"));let i=this._ownerWritableStream;return i===void 0?S($t("close")):Re(i)?S(new TypeError("Cannot close an already-closing stream")):Oo(this)}releaseLock(){if(!Ze(this))throw Xe("releaseLock");this._ownerWritableStream!==void 0&&Do(this)}write(i=void 0){return Ze(this)?this._ownerWritableStream===void 0?S($t("write to")):xo(this,i):S(Xe("write"))}}Object.defineProperties(Wt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Wt.prototype,e.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Ze(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_ownerWritableStream")?!1:n instanceof Wt}function Hc(n,i){let a=n._ownerWritableStream;return Pr(a,i)}function Oo(n){let i=n._ownerWritableStream;return Ao(i)}function Gc(n){let i=n._ownerWritableStream,a=i._state;return Re(i)||a==="closed"?g(void 0):a==="errored"?S(i._storedError):Oo(n)}function Yc(n,i){n._closedPromiseState==="pending"?rs(n,i):nf(n,i)}function Io(n,i){n._readyPromiseState==="pending"?Wo(n,i):of(n,i)}function Vc(n){let i=n._ownerWritableStream,a=i._state;return a==="errored"||a==="erroring"?null:a==="closed"?0:ko(i._writableStreamController)}function Do(n){let i=n._ownerWritableStream,a=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Io(n,a),Yc(n,a),i._writer=void 0,n._ownerWritableStream=void 0}function xo(n,i){let a=n._ownerWritableStream,c=a._writableStreamController,h=Zc(c,i);if(a!==n._ownerWritableStream)return S($t("write to"));let _=a._state;if(_==="errored")return S(a._storedError);if(Re(a)||_==="closed")return S(new TypeError("The stream is closing or closed and cannot be written to"));if(_==="erroring")return S(a._storedError);let b=Fc(a);return Xc(c,i,h),b}let qo={};class dt{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Zn(this))throw ts("abortReason");return this._abortReason}get signal(){if(!Zn(this))throw ts("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(i=void 0){if(!Zn(this))throw ts("error");this._controlledWritableStream._state==="writable"&&Mo(this,i)}[Yi](i){let a=this._abortAlgorithm(i);return Or(this),a}[Vi](){Ne(this)}}Object.defineProperties(dt.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(dt.prototype,e.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Zn(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledWritableStream")?!1:n instanceof dt}function Bo(n,i,a,c,h,_,b,E){i._controlledWritableStream=n,n._writableStreamController=i,i._queue=void 0,i._queueTotalSize=void 0,Ne(i),i._abortReason=void 0,i._abortController=Mc(),i._started=!1,i._strategySizeAlgorithm=E,i._strategyHWM=b,i._writeAlgorithm=c,i._closeAlgorithm=h,i._abortAlgorithm=_;let P=es(i);Jn(n,P);let O=a(),q=g(O);I(q,()=>{i._started=!0,Ir(i)},B=>{i._started=!0,Yn(n,B)})}function Kc(n,i,a,c){let h=Object.create(dt.prototype),_=()=>{},b=()=>g(void 0),E=()=>g(void 0),P=()=>g(void 0);i.start!==void 0&&(_=()=>i.start(h)),i.write!==void 0&&(b=O=>i.write(O,h)),i.close!==void 0&&(E=()=>i.close()),i.abort!==void 0&&(P=O=>i.abort(O)),Bo(n,h,_,b,E,P,a,c)}function Or(n){n._writeAlgorithm=void 0,n._closeAlgorithm=void 0,n._abortAlgorithm=void 0,n._strategySizeAlgorithm=void 0}function Jc(n){$n(n,qo,0),Ir(n)}function Zc(n,i){try{return n._strategySizeAlgorithm(i)}catch(a){return Xn(n,a),1}}function ko(n){return n._strategyHWM-n._queueTotalSize}function Xc(n,i,a){try{$n(n,i,a)}catch(h){Xn(n,h);return}let c=n._controlledWritableStream;if(!Re(c)&&c._state==="writable"){let h=es(n);Jn(c,h)}Ir(n)}function Ir(n){let i=n._controlledWritableStream;if(!n._started||i._inFlightWriteRequest!==void 0)return;if(i._state==="erroring"){Kn(i);return}if(n._queue.length===0)return;let c=Sc(n);c===qo?ef(n):tf(n,c)}function Xn(n,i){n._controlledWritableStream._state==="writable"&&Mo(n,i)}function ef(n){let i=n._controlledWritableStream;Qc(i),Wn(n);let a=n._closeAlgorithm();Or(n),I(a,()=>{$c(i)},c=>{Uc(i,c)})}function tf(n,i){let a=n._controlledWritableStream;jc(a);let c=n._writeAlgorithm(i);I(c,()=>{Nc(a);let h=a._state;if(Wn(n),!Re(a)&&h==="writable"){let _=es(n);Jn(a,_)}Ir(n)},h=>{a._state==="writable"&&Or(n),Wc(a,h)})}function es(n){return ko(n)<=0}function Mo(n,i){let a=n._controlledWritableStream;Or(n),Vn(a,i)}function Dr(n){return new TypeError(`WritableStream.prototype.${n} can only be used on a WritableStream`)}function ts(n){return new TypeError(`WritableStreamDefaultController.prototype.${n} can only be used on a WritableStreamDefaultController`)}function Xe(n){return new TypeError(`WritableStreamDefaultWriter.prototype.${n} can only be used on a WritableStreamDefaultWriter`)}function $t(n){return new TypeError("Cannot "+n+" a stream using a released writer")}function xr(n){n._closedPromise=y((i,a)=>{n._closedPromise_resolve=i,n._closedPromise_reject=a,n._closedPromiseState="pending"})}function Lo(n,i){xr(n),rs(n,i)}function rf(n){xr(n),Fo(n)}function rs(n,i){n._closedPromise_reject!==void 0&&(ee(n._closedPromise),n._closedPromise_reject(i),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0,n._closedPromiseState="rejected")}function nf(n,i){Lo(n,i)}function Fo(n){n._closedPromise_resolve!==void 0&&(n._closedPromise_resolve(void 0),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0,n._closedPromiseState="resolved")}function qr(n){n._readyPromise=y((i,a)=>{n._readyPromise_resolve=i,n._readyPromise_reject=a}),n._readyPromiseState="pending"}function ns(n,i){qr(n),Wo(n,i)}function No(n){qr(n),ss(n)}function Wo(n,i){n._readyPromise_reject!==void 0&&(ee(n._readyPromise),n._readyPromise_reject(i),n._readyPromise_resolve=void 0,n._readyPromise_reject=void 0,n._readyPromiseState="rejected")}function sf(n){qr(n)}function of(n,i){ns(n,i)}function ss(n){n._readyPromise_resolve!==void 0&&(n._readyPromise_resolve(void 0),n._readyPromise_resolve=void 0,n._readyPromise_reject=void 0,n._readyPromiseState="fulfilled")}let $o=typeof DOMException<"u"?DOMException:void 0;function af(n){if(!(typeof n=="function"||typeof n=="object"))return!1;try{return new n,!0}catch{return!1}}function uf(){let n=function(a,c){this.message=a||"",this.name=c||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return n.prototype=Object.create(Error.prototype),Object.defineProperty(n.prototype,"constructor",{value:n,writable:!0,configurable:!0}),n}let lf=af($o)?$o:uf();function Uo(n,i,a,c,h,_){let b=ut(n),E=Co(i);n._disturbed=!0;let P=!1,O=g(void 0);return y((q,B)=>{let H;if(_!==void 0){if(H=()=>{let v=new lf("Aborted","AbortError"),A=[];c||A.push(()=>i._state==="writable"?Pr(i,v):g(void 0)),h||A.push(()=>n._state==="readable"?be(n,v):g(void 0)),te(()=>Promise.all(A.map(F=>F())),!0,v)},_.aborted){H();return}_.addEventListener("abort",H)}function ge(){return y((v,A)=>{function F(ae){ae?v():w(mt(),F,A)}F(!1)})}function mt(){return P?g(!0):w(E._readyPromise,()=>y((v,A)=>{xt(b,{_chunkSteps:F=>{O=w(xo(E,F),void 0,r),v(!1)},_closeSteps:()=>v(!0),_errorSteps:A})}))}if(Oe(n,b._closedPromise,v=>{c?fe(!0,v):te(()=>Pr(i,v),!0,v)}),Oe(i,E._closedPromise,v=>{h?fe(!0,v):te(()=>be(n,v),!0,v)}),J(n,b._closedPromise,()=>{a?fe():te(()=>Gc(E))}),Re(i)||i._state==="closed"){let v=new TypeError("the destination writable stream closed before all data could be piped to it");h?fe(!0,v):te(()=>be(n,v),!0,v)}ee(ge());function Qe(){let v=O;return w(O,()=>v!==O?Qe():void 0)}function Oe(v,A,F){v._state==="errored"?F(v._storedError):k(A,F)}function J(v,A,F){v._state==="closed"?F():D(A,F)}function te(v,A,F){if(P)return;P=!0,i._state==="writable"&&!Re(i)?D(Qe(),ae):ae();function ae(){I(v(),()=>Ie(A,F),yt=>Ie(!0,yt))}}function fe(v,A){P||(P=!0,i._state==="writable"&&!Re(i)?D(Qe(),()=>Ie(v,A)):Ie(v,A))}function Ie(v,A){Do(E),Ce(b),_!==void 0&&_.removeEventListener("abort",H),v?B(A):q(void 0)}})}class ht{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Br(this))throw Lr("desiredSize");return is(this)}close(){if(!Br(this))throw Lr("close");if(!pt(this))throw new TypeError("The stream is not in a state that permits close");zt(this)}enqueue(i=void 0){if(!Br(this))throw Lr("enqueue");if(!pt(this))throw new TypeError("The stream is not in a state that permits enqueue");return Mr(this,i)}error(i=void 0){if(!Br(this))throw Lr("error");We(this,i)}[Bn](i){Ne(this);let a=this._cancelAlgorithm(i);return kr(this),a}[kn](i){let a=this._controlledReadableStream;if(this._queue.length>0){let c=Wn(this);this._closeRequested&&this._queue.length===0?(kr(this),Qt(a)):Ut(this),i._chunkSteps(c)}else eo(a,i),Ut(this)}}Object.defineProperties(ht.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(ht.prototype,e.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Br(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledReadableStream")?!1:n instanceof ht}function Ut(n){if(!zo(n))return;if(n._pulling){n._pullAgain=!0;return}n._pulling=!0;let a=n._pullAlgorithm();I(a,()=>{n._pulling=!1,n._pullAgain&&(n._pullAgain=!1,Ut(n))},c=>{We(n,c)})}function zo(n){let i=n._controlledReadableStream;return!pt(n)||!n._started?!1:!!(ze(i)&&mr(i)>0||is(n)>0)}function kr(n){n._pullAlgorithm=void 0,n._cancelAlgorithm=void 0,n._strategySizeAlgorithm=void 0}function zt(n){if(!pt(n))return;let i=n._controlledReadableStream;n._closeRequested=!0,n._queue.length===0&&(kr(n),Qt(i))}function Mr(n,i){if(!pt(n))return;let a=n._controlledReadableStream;if(ze(a)&&mr(a)>0)Nn(a,i,!1);else{let c;try{c=n._strategySizeAlgorithm(i)}catch(h){throw We(n,h),h}try{$n(n,i,c)}catch(h){throw We(n,h),h}}Ut(n)}function We(n,i){let a=n._controlledReadableStream;a._state==="readable"&&(Ne(n),kr(n),Go(a,i))}function is(n){let i=n._controlledReadableStream._state;return i==="errored"?null:i==="closed"?0:n._strategyHWM-n._queueTotalSize}function cf(n){return!zo(n)}function pt(n){let i=n._controlledReadableStream._state;return!n._closeRequested&&i==="readable"}function Qo(n,i,a,c,h,_,b){i._controlledReadableStream=n,i._queue=void 0,i._queueTotalSize=void 0,Ne(i),i._started=!1,i._closeRequested=!1,i._pullAgain=!1,i._pulling=!1,i._strategySizeAlgorithm=b,i._strategyHWM=_,i._pullAlgorithm=c,i._cancelAlgorithm=h,n._readableStreamController=i;let E=a();I(g(E),()=>{i._started=!0,Ut(i)},P=>{We(i,P)})}function ff(n,i,a,c){let h=Object.create(ht.prototype),_=()=>{},b=()=>g(void 0),E=()=>g(void 0);i.start!==void 0&&(_=()=>i.start(h)),i.pull!==void 0&&(b=()=>i.pull(h)),i.cancel!==void 0&&(E=P=>i.cancel(P)),Qo(n,h,_,b,E,a,c)}function Lr(n){return new TypeError(`ReadableStreamDefaultController.prototype.${n} can only be used on a ReadableStreamDefaultController`)}function df(n,i){return Ve(n._readableStreamController)?pf(n):hf(n)}function hf(n,i){let a=ut(n),c=!1,h=!1,_=!1,b=!1,E,P,O,q,B,H=y(J=>{B=J});function ge(){return c?(h=!0,g(void 0)):(c=!0,xt(a,{_chunkSteps:te=>{x(()=>{h=!1;let fe=te,Ie=te;_||Mr(O._readableStreamController,fe),b||Mr(q._readableStreamController,Ie),c=!1,h&&ge()})},_closeSteps:()=>{c=!1,_||zt(O._readableStreamController),b||zt(q._readableStreamController),(!_||!b)&&B(void 0)},_errorSteps:()=>{c=!1}}),g(void 0))}function mt(J){if(_=!0,E=J,b){let te=qt([E,P]),fe=be(n,te);B(fe)}return H}function Qe(J){if(b=!0,P=J,_){let te=qt([E,P]),fe=be(n,te);B(fe)}return H}function Oe(){}return O=os(Oe,ge,mt),q=os(Oe,ge,Qe),k(a._closedPromise,J=>{We(O._readableStreamController,J),We(q._readableStreamController,J),(!_||!b)&&B(void 0)}),[O,q]}function pf(n){let i=ut(n),a=!1,c=!1,h=!1,_=!1,b=!1,E,P,O,q,B,H=y(v=>{B=v});function ge(v){k(v._closedPromise,A=>{v===i&&(_e(O._readableStreamController,A),_e(q._readableStreamController,A),(!_||!b)&&B(void 0))})}function mt(){Je(i)&&(Ce(i),i=ut(n),ge(i)),xt(i,{_chunkSteps:A=>{x(()=>{c=!1,h=!1;let F=A,ae=A;if(!_&&!b)try{ae=co(A)}catch(yt){_e(O._readableStreamController,yt),_e(q._readableStreamController,yt),B(be(n,yt));return}_||wr(O._readableStreamController,F),b||wr(q._readableStreamController,ae),a=!1,c?Oe():h&&J()})},_closeSteps:()=>{a=!1,_||kt(O._readableStreamController),b||kt(q._readableStreamController),O._readableStreamController._pendingPullIntos.length>0&&Er(O._readableStreamController,0),q._readableStreamController._pendingPullIntos.length>0&&Er(q._readableStreamController,0),(!_||!b)&&B(void 0)},_errorSteps:()=>{a=!1}})}function Qe(v,A){Fe(i)&&(Ce(i),i=wo(n),ge(i));let F=A?q:O,ae=A?O:q;vo(i,v,{_chunkSteps:_t=>{x(()=>{c=!1,h=!1;let bt=A?b:_;if(A?_:b)bt||Rr(F._readableStreamController,_t);else{let oa;try{oa=co(_t)}catch(us){_e(F._readableStreamController,us),_e(ae._readableStreamController,us),B(be(n,us));return}bt||Rr(F._readableStreamController,_t),wr(ae._readableStreamController,oa)}a=!1,c?Oe():h&&J()})},_closeSteps:_t=>{a=!1;let bt=A?b:_,Hr=A?_:b;bt||kt(F._readableStreamController),Hr||kt(ae._readableStreamController),_t!==void 0&&(bt||Rr(F._readableStreamController,_t),!Hr&&ae._readableStreamController._pendingPullIntos.length>0&&Er(ae._readableStreamController,0)),(!bt||!Hr)&&B(void 0)},_errorSteps:()=>{a=!1}})}function Oe(){if(a)return c=!0,g(void 0);a=!0;let v=jn(O._readableStreamController);return v===null?mt():Qe(v._view,!1),g(void 0)}function J(){if(a)return h=!0,g(void 0);a=!0;let v=jn(q._readableStreamController);return v===null?mt():Qe(v._view,!0),g(void 0)}function te(v){if(_=!0,E=v,b){let A=qt([E,P]),F=be(n,A);B(F)}return H}function fe(v){if(b=!0,P=v,_){let A=qt([E,P]),F=be(n,A);B(F)}return H}function Ie(){}return O=Ho(Ie,Oe,te),q=Ho(Ie,J,fe),ge(i),[O,q]}function mf(n,i){Pe(n,i);let a=n,c=a?.autoAllocateChunkSize,h=a?.cancel,_=a?.pull,b=a?.start,E=a?.type;return{autoAllocateChunkSize:c===void 0?void 0:Xi(c,`${i} has member 'autoAllocateChunkSize' that`),cancel:h===void 0?void 0:yf(h,a,`${i} has member 'cancel' that`),pull:_===void 0?void 0:_f(_,a,`${i} has member 'pull' that`),start:b===void 0?void 0:bf(b,a,`${i} has member 'start' that`),type:E===void 0?void 0:gf(E,`${i} has member 'type' that`)}}function yf(n,i,a){return ye(n,a),c=>M(n,i,[c])}function _f(n,i,a){return ye(n,a),c=>M(n,i,[c])}function bf(n,i,a){return ye(n,a),c=>j(n,i,[c])}function gf(n,i){if(n=`${n}`,n!=="bytes")throw new TypeError(`${i} '${n}' is not a valid enumeration value for ReadableStreamType`);return n}function Sf(n,i){Pe(n,i);let a=n?.mode;return{mode:a===void 0?void 0:wf(a,`${i} has member 'mode' that`)}}function wf(n,i){if(n=`${n}`,n!=="byob")throw new TypeError(`${i} '${n}' is not a valid enumeration value for ReadableStreamReaderMode`);return n}function Ef(n,i){Pe(n,i);let a=n?.preventCancel;return{preventCancel:Boolean(a)}}function jo(n,i){Pe(n,i);let a=n?.preventAbort,c=n?.preventCancel,h=n?.preventClose,_=n?.signal;return _!==void 0&&Rf(_,`${i} has member 'signal' that`),{preventAbort:Boolean(a),preventCancel:Boolean(c),preventClose:Boolean(h),signal:_}}function Rf(n,i){if(!Bc(n))throw new TypeError(`${i} is not an AbortSignal.`)}function vf(n,i){Pe(n,i);let a=n?.readable;Mn(a,"readable","ReadableWritablePair"),Fn(a,`${i} has member 'readable' that`);let c=n?.writable;return Mn(c,"writable","ReadableWritablePair"),To(c,`${i} has member 'writable' that`),{readable:a,writable:c}}class $e{constructor(i={},a={}){i===void 0?i=null:Ji(i,"First parameter");let c=Cr(a,"Second parameter"),h=mf(i,"First parameter");if(as(this),h.type==="bytes"){if(c.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let _=Ft(c,0);Tc(this,h,_)}else{let _=Tr(c),b=Ft(c,1);ff(this,h,b,_)}}get locked(){if(!Ue(this))throw et("locked");return ze(this)}cancel(i=void 0){return Ue(this)?ze(this)?S(new TypeError("Cannot cancel a stream that already has a reader")):be(this,i):S(et("cancel"))}getReader(i=void 0){if(!Ue(this))throw et("getReader");return Sf(i,"First parameter").mode===void 0?ut(this):wo(this)}pipeThrough(i,a={}){if(!Ue(this))throw et("pipeThrough");Ae(i,1,"pipeThrough");let c=vf(i,"First parameter"),h=jo(a,"Second parameter");if(ze(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(ft(c.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let _=Uo(this,c.writable,h.preventClose,h.preventAbort,h.preventCancel,h.signal);return ee(_),c.readable}pipeTo(i,a={}){if(!Ue(this))return S(et("pipeTo"));if(i===void 0)return S("Parameter 1 is required in 'pipeTo'.");if(!ct(i))return S(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let c;try{c=jo(a,"Second parameter")}catch(h){return S(h)}return ze(this)?S(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):ft(i)?S(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Uo(this,i,c.preventClose,c.preventAbort,c.preventCancel,c.signal)}tee(){if(!Ue(this))throw et("tee");let i=df(this);return qt(i)}values(i=void 0){if(!Ue(this))throw et("values");let a=Ef(i,"First parameter");return bc(this,a.preventCancel)}}Object.defineProperties($e.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty($e.prototype,e.toStringTag,{value:"ReadableStream",configurable:!0}),typeof e.asyncIterator=="symbol"&&Object.defineProperty($e.prototype,e.asyncIterator,{value:$e.prototype.values,writable:!0,configurable:!0});function os(n,i,a,c=1,h=()=>1){let _=Object.create($e.prototype);as(_);let b=Object.create(ht.prototype);return Qo(_,b,n,i,a,c,h),_}function Ho(n,i,a){let c=Object.create($e.prototype);as(c);let h=Object.create(lt.prototype);return So(c,h,n,i,a,0,void 0),c}function as(n){n._state="readable",n._reader=void 0,n._storedError=void 0,n._disturbed=!1}function Ue(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_readableStreamController")?!1:n instanceof $e}function ze(n){return n._reader!==void 0}function be(n,i){if(n._disturbed=!0,n._state==="closed")return g(void 0);if(n._state==="errored")return S(n._storedError);Qt(n);let a=n._reader;a!==void 0&&Je(a)&&(a._readIntoRequests.forEach(h=>{h._closeSteps(void 0)}),a._readIntoRequests=new oe);let c=n._readableStreamController[Bn](i);return W(c,r)}function Qt(n){n._state="closed";let i=n._reader;i!==void 0&&(Gi(i),Fe(i)&&(i._readRequests.forEach(a=>{a._closeSteps()}),i._readRequests=new oe))}function Go(n,i){n._state="errored",n._storedError=i;let a=n._reader;a!==void 0&&(qn(a,i),Fe(a)?(a._readRequests.forEach(c=>{c._errorSteps(i)}),a._readRequests=new oe):(a._readIntoRequests.forEach(c=>{c._errorSteps(i)}),a._readIntoRequests=new oe))}function et(n){return new TypeError(`ReadableStream.prototype.${n} can only be used on a ReadableStream`)}function Yo(n,i){Pe(n,i);let a=n?.highWaterMark;return Mn(a,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Ln(a)}}let Vo=n=>n.byteLength;try{Object.defineProperty(Vo,"name",{value:"size",configurable:!0})}catch{}class Fr{constructor(i){Ae(i,1,"ByteLengthQueuingStrategy"),i=Yo(i,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=i.highWaterMark}get highWaterMark(){if(!Jo(this))throw Ko("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!Jo(this))throw Ko("size");return Vo}}Object.defineProperties(Fr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Fr.prototype,e.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function Ko(n){return new TypeError(`ByteLengthQueuingStrategy.prototype.${n} can only be used on a ByteLengthQueuingStrategy`)}function Jo(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_byteLengthQueuingStrategyHighWaterMark")?!1:n instanceof Fr}let Zo=()=>1;try{Object.defineProperty(Zo,"name",{value:"size",configurable:!0})}catch{}class Nr{constructor(i){Ae(i,1,"CountQueuingStrategy"),i=Yo(i,"First parameter"),this._countQueuingStrategyHighWaterMark=i.highWaterMark}get highWaterMark(){if(!ea(this))throw Xo("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!ea(this))throw Xo("size");return Zo}}Object.defineProperties(Nr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Nr.prototype,e.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function Xo(n){return new TypeError(`CountQueuingStrategy.prototype.${n} can only be used on a CountQueuingStrategy`)}function ea(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_countQueuingStrategyHighWaterMark")?!1:n instanceof Nr}function Tf(n,i){Pe(n,i);let a=n?.flush,c=n?.readableType,h=n?.start,_=n?.transform,b=n?.writableType;return{flush:a===void 0?void 0:Cf(a,n,`${i} has member 'flush' that`),readableType:c,start:h===void 0?void 0:Pf(h,n,`${i} has member 'start' that`),transform:_===void 0?void 0:Af(_,n,`${i} has member 'transform' that`),writableType:b}}function Cf(n,i,a){return ye(n,a),c=>M(n,i,[c])}function Pf(n,i,a){return ye(n,a),c=>j(n,i,[c])}function Af(n,i,a){return ye(n,a),(c,h)=>M(n,i,[c,h])}class Wr{constructor(i={},a={},c={}){i===void 0&&(i=null);let h=Cr(a,"Second parameter"),_=Cr(c,"Third parameter"),b=Tf(i,"First parameter");if(b.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(b.writableType!==void 0)throw new RangeError("Invalid writableType specified");let E=Ft(_,0),P=Tr(_),O=Ft(h,1),q=Tr(h),B,H=y(ge=>{B=ge});Of(this,H,O,q,E,P),Df(this,b),b.start!==void 0?B(b.start(this._transformStreamController)):B(void 0)}get readable(){if(!ta(this))throw ia("readable");return this._readable}get writable(){if(!ta(this))throw ia("writable");return this._writable}}Object.defineProperties(Wr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Wr.prototype,e.toStringTag,{value:"TransformStream",configurable:!0});function Of(n,i,a,c,h,_){function b(){return i}function E(H){return Bf(n,H)}function P(H){return kf(n,H)}function O(){return Mf(n)}n._writable=Lc(b,E,O,P,a,c);function q(){return Lf(n)}function B(H){return Ur(n,H),g(void 0)}n._readable=os(b,q,B,h,_),n._backpressure=void 0,n._backpressureChangePromise=void 0,n._backpressureChangePromise_resolve=void 0,zr(n,!0),n._transformStreamController=void 0}function ta(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_transformStreamController")?!1:n instanceof Wr}function $r(n,i){We(n._readable._readableStreamController,i),Ur(n,i)}function Ur(n,i){ra(n._transformStreamController),Xn(n._writable._writableStreamController,i),n._backpressure&&zr(n,!1)}function zr(n,i){n._backpressureChangePromise!==void 0&&n._backpressureChangePromise_resolve(),n._backpressureChangePromise=y(a=>{n._backpressureChangePromise_resolve=a}),n._backpressure=i}class jt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Qr(this))throw jr("desiredSize");let i=this._controlledTransformStream._readable._readableStreamController;return is(i)}enqueue(i=void 0){if(!Qr(this))throw jr("enqueue");na(this,i)}error(i=void 0){if(!Qr(this))throw jr("error");xf(this,i)}terminate(){if(!Qr(this))throw jr("terminate");qf(this)}}Object.defineProperties(jt.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(jt.prototype,e.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Qr(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledTransformStream")?!1:n instanceof jt}function If(n,i,a,c){i._controlledTransformStream=n,n._transformStreamController=i,i._transformAlgorithm=a,i._flushAlgorithm=c}function Df(n,i){let a=Object.create(jt.prototype),c=_=>{try{return na(a,_),g(void 0)}catch(b){return S(b)}},h=()=>g(void 0);i.transform!==void 0&&(c=_=>i.transform(_,a)),i.flush!==void 0&&(h=()=>i.flush(a)),If(n,a,c,h)}function ra(n){n._transformAlgorithm=void 0,n._flushAlgorithm=void 0}function na(n,i){let a=n._controlledTransformStream,c=a._readable._readableStreamController;if(!pt(c))throw new TypeError("Readable side is not in a state that permits enqueue");try{Mr(c,i)}catch(_){throw Ur(a,_),a._readable._storedError}cf(c)!==a._backpressure&&zr(a,!0)}function xf(n,i){$r(n._controlledTransformStream,i)}function sa(n,i){let a=n._transformAlgorithm(i);return W(a,void 0,c=>{throw $r(n._controlledTransformStream,c),c})}function qf(n){let i=n._controlledTransformStream,a=i._readable._readableStreamController;zt(a);let c=new TypeError("TransformStream terminated");Ur(i,c)}function Bf(n,i){let a=n._transformStreamController;if(n._backpressure){let c=n._backpressureChangePromise;return W(c,()=>{let h=n._writable;if(h._state==="erroring")throw h._storedError;return sa(a,i)})}return sa(a,i)}function kf(n,i){return $r(n,i),g(void 0)}function Mf(n){let i=n._readable,a=n._transformStreamController,c=a._flushAlgorithm();return ra(a),W(c,()=>{if(i._state==="errored")throw i._storedError;zt(i._readableStreamController)},h=>{throw $r(n,h),i._storedError})}function Lf(n){return zr(n,!1),n._backpressureChangePromise}function jr(n){return new TypeError(`TransformStreamDefaultController.prototype.${n} can only be used on a TransformStreamDefaultController`)}function ia(n){return new TypeError(`TransformStream.prototype.${n} can only be used on a TransformStream`)}t.ByteLengthQueuingStrategy=Fr,t.CountQueuingStrategy=Nr,t.ReadableByteStreamController=lt,t.ReadableStream=$e,t.ReadableStreamBYOBReader=Lt,t.ReadableStreamBYOBRequest=Bt,t.ReadableStreamDefaultController=ht,t.ReadableStreamDefaultReader=Dt,t.TransformStream=Wr,t.TransformStreamDefaultController=jt,t.WritableStream=Nt,t.WritableStreamDefaultController=dt,t.WritableStreamDefaultWriter=Wt,Object.defineProperty(t,"__esModule",{value:!0})})});var _a=R(()=>{if(!globalThis.ReadableStream)try{let t=require("node:process"),{emitWarning:e}=t;try{t.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),t.emitWarning=e}catch(r){throw t.emitWarning=e,r}}catch{Object.assign(globalThis,ya())}try{let{Blob:t}=require("buffer");t&&!t.prototype.stream&&(t.prototype.stream=function(r){let s=0,o=this;return new ReadableStream({type:"bytes",async pull(u){let p=await o.slice(s,Math.min(o.size,s+65536)).arrayBuffer();s+=p.byteLength,u.enqueue(new Uint8Array(p)),s===o.size&&u.close()}})})}catch{}});async function*cs(t,e=!0){for(let r of t)if("stream"in r)yield*r.stream();else if(ArrayBuffer.isView(r))if(e){let s=r.byteOffset,o=r.byteOffset+r.byteLength;for(;s!==o;){let u=Math.min(o-s,ba),l=r.buffer.slice(s,s+u);s+=l.byteLength,yield new Uint8Array(l)}}else yield r;else{let s=0,o=r;for(;s!==o.size;){let l=await o.slice(s,Math.min(o.size,s+ba)).arrayBuffer();s+=l.byteLength,yield new Uint8Array(l)}}}var ny,ba,ga,Vf,De,Gt=Ht(()=>{ny=Se(_a(),1);ba=65536;ga=class fs{#e=[];#t="";#r=0;#n="transparent";constructor(e=[],r={}){if(typeof e!="object"||e===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof e[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof r!="object"&&typeof r!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");r===null&&(r={});let s=new TextEncoder;for(let u of e){let l;ArrayBuffer.isView(u)?l=new Uint8Array(u.buffer.slice(u.byteOffset,u.byteOffset+u.byteLength)):u instanceof ArrayBuffer?l=new Uint8Array(u.slice(0)):u instanceof fs?l=u:l=s.encode(`${u}`),this.#r+=ArrayBuffer.isView(l)?l.byteLength:l.size,this.#e.push(l)}this.#n=`${r.endings===void 0?"transparent":r.endings}`;let o=r.type===void 0?"":String(r.type);this.#t=/^[\x20-\x7E]*$/.test(o)?o:""}get size(){return this.#r}get type(){return this.#t}async text(){let e=new TextDecoder,r="";for await(let s of cs(this.#e,!1))r+=e.decode(s,{stream:!0});return r+=e.decode(),r}async arrayBuffer(){let e=new Uint8Array(this.size),r=0;for await(let s of cs(this.#e,!1))e.set(s,r),r+=s.length;return e.buffer}stream(){let e=cs(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(r){let s=await e.next();s.done?r.close():r.enqueue(s.value)},async cancel(){await e.return()}})}slice(e=0,r=this.size,s=""){let{size:o}=this,u=e<0?Math.max(o+e,0):Math.min(e,o),l=r<0?Math.max(o+r,0):Math.min(r,o),p=Math.max(l-u,0),d=this.#e,f=[],m=0;for(let g of d){if(m>=p)break;let S=ArrayBuffer.isView(g)?g.byteLength:g.size;if(u&&S<=u)u-=S,l-=S;else{let w;ArrayBuffer.isView(g)?(w=g.subarray(u,Math.min(S,l)),m+=w.byteLength):(w=g.slice(u,Math.min(S,l)),m+=w.size),l-=S,f.push(w),u=0}}let y=new fs([],{type:String(s).toLowerCase()});return y.#r=p,y.#e=f,y}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](e){return e&&typeof e=="object"&&typeof e.constructor=="function"&&(typeof e.stream=="function"||typeof e.arrayBuffer=="function")&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}};Object.defineProperties(ga.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});Vf=ga,De=Vf});var Kf,Jf,gt,ds=Ht(()=>{Gt();Kf=class extends De{#e=0;#t="";constructor(e,r,s={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(e,s),s===null&&(s={});let o=s.lastModified===void 0?Date.now():Number(s.lastModified);Number.isNaN(o)||(this.#e=o),this.#t=String(r)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](e){return!!e&&e instanceof De&&/^(File)$/.test(e[Symbol.toStringTag])}},Jf=Kf,gt=Jf});function Ea(t,e=De){var r=`${Sa()}${Sa()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],o=`--${r}\r
Content-Disposition: form-data; name="`;return t.forEach((u,l)=>typeof u=="string"?s.push(o+hs(l)+`"\r
\r
${u.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):s.push(o+hs(l)+`"; filename="${hs(u.name,1)}"\r
Content-Type: ${u.type||"application/octet-stream"}\r
\r
`,u,`\r
`)),s.push(`--${r}--`),new e(s,{type:"multipart/form-data; boundary="+r})}var Yt,Zf,Xf,Sa,ed,wa,hs,rt,nt,Yr=Ht(()=>{Gt();ds();({toStringTag:Yt,iterator:Zf,hasInstance:Xf}=Symbol),Sa=Math.random,ed="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),wa=(t,e,r)=>(t+="",/^(Blob|File)$/.test(e&&e[Yt])?[(r=r!==void 0?r+"":e[Yt]=="File"?e.name:"blob",t),e.name!==r||e[Yt]=="blob"?new gt([e],r,e):e]:[t,e+""]),hs=(t,e)=>(e?t:t.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),rt=(t,e,r)=>{if(e.length<r)throw new TypeError(`Failed to execute '${t}' on 'FormData': ${r} arguments required, but only ${e.length} present.`)},nt=class{#e=[];constructor(...e){if(e.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[Yt](){return"FormData"}[Zf](){return this.entries()}static[Xf](e){return e&&typeof e=="object"&&e[Yt]==="FormData"&&!ed.some(r=>typeof e[r]!="function")}append(...e){rt("append",arguments,2),this.#e.push(wa(...e))}delete(e){rt("delete",arguments,1),e+="",this.#e=this.#e.filter(([r])=>r!==e)}get(e){rt("get",arguments,1),e+="";for(var r=this.#e,s=r.length,o=0;o<s;o++)if(r[o][0]===e)return r[o][1];return null}getAll(e,r){return rt("getAll",arguments,1),r=[],e+="",this.#e.forEach(s=>s[0]===e&&r.push(s[1])),r}has(e){return rt("has",arguments,1),e+="",this.#e.some(r=>r[0]===e)}forEach(e,r){rt("forEach",arguments,1);for(var[s,o]of this)e.call(r,o,s,this)}set(...e){rt("set",arguments,2);var r=[],s=!0;e=wa(...e),this.#e.forEach(o=>{o[0]===e[0]?s&&(s=!r.push(e)):r.push(o)}),s&&r.push(e),this.#e=r}*entries(){yield*this.#e}*keys(){for(var[e]of this)yield e}*values(){for(var[,e]of this)yield e}}});var Pa=R((yy,Ca)=>{if(!globalThis.DOMException)try{let{MessageChannel:t}=require("worker_threads"),e=new t().port1,r=new ArrayBuffer;e.postMessage(r,[r,r])}catch(t){t.constructor.name==="DOMException"&&(globalThis.DOMException=t.constructor)}Ca.exports=globalThis.DOMException});var Kt,Aa,td,Kr,ms=Ht(()=>{Kt=require("node:fs"),Aa=Se(Pa(),1);ds();Gt();({stat:td}=Kt.promises),Kr=class{#e;#t;constructor(e){this.#e=e.path,this.#t=e.start,this.size=e.size,this.lastModified=e.lastModified}slice(e,r){return new Kr({path:this.#e,lastModified:this.lastModified,size:r-e,start:this.#t+e})}async*stream(){let{mtimeMs:e}=await td(this.#e);if(e>this.lastModified)throw new Aa.default("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*(0,Kt.createReadStream)(this.#e,{start:this.#t,end:this.#t+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}});var Ia={};zf(Ia,{toFormData:()=>ud});function ad(t){let e=t.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!e)return;let r=e[2]||e[3]||"",s=r.slice(r.lastIndexOf("\\")+1);return s=s.replace(/%22/g,'"'),s=s.replace(/&#(\d{4});/g,(o,u)=>String.fromCharCode(u)),s}async function ud(t,e){if(!/multipart/i.test(e))throw new TypeError("Failed to fetch");let r=e.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!r)throw new TypeError("no or bad content-type header, no multipart boundary");let s=new ys(r[1]||r[2]),o,u,l,p,d,f,m=[],y=new nt,g=k=>{l+=D.decode(k,{stream:!0})},S=k=>{m.push(k)},w=()=>{let k=new gt(m,f,{type:d});y.append(p,k)},I=()=>{y.append(p,l)},D=new TextDecoder("utf-8");D.decode(),s.onPartBegin=function(){s.onPartData=g,s.onPartEnd=I,o="",u="",l="",p="",d="",f=null,m.length=0},s.onHeaderField=function(k){o+=D.decode(k,{stream:!0})},s.onHeaderValue=function(k){u+=D.decode(k,{stream:!0})},s.onHeaderEnd=function(){if(u+=D.decode(),o=o.toLowerCase(),o==="content-disposition"){let k=u.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);k&&(p=k[2]||k[3]||""),f=ad(u),f&&(s.onPartData=S,s.onPartEnd=w)}else o==="content-type"&&(d=u);u="",o=""};for await(let k of t)s.write(k);return s.end(),y}var ve,N,Oa,je,Jr,Zr,rd,Jt,nd,sd,id,od,st,ys,Da=Ht(()=>{ms();Yr();ve=0,N={START_BOUNDARY:ve++,HEADER_FIELD_START:ve++,HEADER_FIELD:ve++,HEADER_VALUE_START:ve++,HEADER_VALUE:ve++,HEADER_VALUE_ALMOST_DONE:ve++,HEADERS_ALMOST_DONE:ve++,PART_DATA_START:ve++,PART_DATA:ve++,END:ve++},Oa=1,je={PART_BOUNDARY:Oa,LAST_BOUNDARY:Oa*=2},Jr=10,Zr=13,rd=32,Jt=45,nd=58,sd=97,id=122,od=t=>t|32,st=()=>{},ys=class{constructor(e){this.index=0,this.flags=0,this.onHeaderEnd=st,this.onHeaderField=st,this.onHeadersEnd=st,this.onHeaderValue=st,this.onPartBegin=st,this.onPartData=st,this.onPartEnd=st,this.boundaryChars={},e=`\r
--`+e;let r=new Uint8Array(e.length);for(let s=0;s<e.length;s++)r[s]=e.charCodeAt(s),this.boundaryChars[r[s]]=!0;this.boundary=r,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=N.START_BOUNDARY}write(e){let r=0,s=e.length,o=this.index,{lookbehind:u,boundary:l,boundaryChars:p,index:d,state:f,flags:m}=this,y=this.boundary.length,g=y-1,S=e.length,w,I,D=x=>{this[x+"Mark"]=r},k=x=>{delete this[x+"Mark"]},W=(x,j,M,Le)=>{(j===void 0||j!==M)&&this[x](Le&&Le.subarray(j,M))},ee=(x,j)=>{let M=x+"Mark";M in this&&(j?(W(x,this[M],r,e),delete this[M]):(W(x,this[M],e.length,e),this[M]=0))};for(r=0;r<s;r++)switch(w=e[r],f){case N.START_BOUNDARY:if(d===l.length-2){if(w===Jt)m|=je.LAST_BOUNDARY;else if(w!==Zr)return;d++;break}else if(d-1===l.length-2){if(m&je.LAST_BOUNDARY&&w===Jt)f=N.END,m=0;else if(!(m&je.LAST_BOUNDARY)&&w===Jr)d=0,W("onPartBegin"),f=N.HEADER_FIELD_START;else return;break}w!==l[d+2]&&(d=-2),w===l[d+2]&&d++;break;case N.HEADER_FIELD_START:f=N.HEADER_FIELD,D("onHeaderField"),d=0;case N.HEADER_FIELD:if(w===Zr){k("onHeaderField"),f=N.HEADERS_ALMOST_DONE;break}if(d++,w===Jt)break;if(w===nd){if(d===1)return;ee("onHeaderField",!0),f=N.HEADER_VALUE_START;break}if(I=od(w),I<sd||I>id)return;break;case N.HEADER_VALUE_START:if(w===rd)break;D("onHeaderValue"),f=N.HEADER_VALUE;case N.HEADER_VALUE:w===Zr&&(ee("onHeaderValue",!0),W("onHeaderEnd"),f=N.HEADER_VALUE_ALMOST_DONE);break;case N.HEADER_VALUE_ALMOST_DONE:if(w!==Jr)return;f=N.HEADER_FIELD_START;break;case N.HEADERS_ALMOST_DONE:if(w!==Jr)return;W("onHeadersEnd"),f=N.PART_DATA_START;break;case N.PART_DATA_START:f=N.PART_DATA,D("onPartData");case N.PART_DATA:if(o=d,d===0){for(r+=g;r<S&&!(e[r]in p);)r+=y;r-=g,w=e[r]}if(d<l.length)l[d]===w?(d===0&&ee("onPartData",!0),d++):d=0;else if(d===l.length)d++,w===Zr?m|=je.PART_BOUNDARY:w===Jt?m|=je.LAST_BOUNDARY:d=0;else if(d-1===l.length)if(m&je.PART_BOUNDARY){if(d=0,w===Jr){m&=~je.PART_BOUNDARY,W("onPartEnd"),W("onPartBegin"),f=N.HEADER_FIELD_START;break}}else m&je.LAST_BOUNDARY&&w===Jt?(W("onPartEnd"),f=N.END,m=0):d=0;if(d>0)u[d-1]=w;else if(o>0){let x=new Uint8Array(u.buffer,u.byteOffset,u.byteLength);W("onPartData",0,o,x),o=0,D("onPartData"),r--}break;case N.END:break;default:throw new Error(`Unexpected state entered: ${f}`)}ee("onHeaderField"),ee("onHeaderValue"),ee("onPartData"),this.index=d,this.state=f,this.flags=m}end(){if(this.state===N.HEADER_FIELD_START&&this.index===0||this.state===N.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==N.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var Ts=R(Xa=>{"use strict";Xa.parse=function(t,e){return new rr(t,e).parse()};var rr=class{constructor(e,r){this.source=e,this.transform=r||_d,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var e=this.source[this.position++];return e==="\\"?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}record(e){this.recorded.push(e)}newEntry(e){var r;(this.recorded.length>0||e)&&(r=this.recorded.join(""),r==="NULL"&&!e&&(r=null),r!==null&&(r=this.transform(r)),this.entries.push(r),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var e=this.nextCharacter();if(e.value==="=")break}}parse(e){var r,s,o;for(this.consumeDimensions();!this.isEof();)if(r=this.nextCharacter(),r.value==="{"&&!o)this.dimension++,this.dimension>1&&(s=new rr(this.source.substr(this.position-1),this.transform),this.entries.push(s.parse(!0)),this.position+=s.position-2);else if(r.value==="}"&&!o){if(this.dimension--,!this.dimension&&(this.newEntry(),e))return this.entries}else r.value==='"'&&!r.escaped?(o&&this.newEntry(!0),o=!o):r.value===","&&!o?this.newEntry():this.record(r.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};function _d(t){return t}});var Cs=R((A0,eu)=>{var bd=Ts();eu.exports={create:function(t,e){return{parse:function(){return bd.parse(t,e)}}}}});var As=R((O0,ru)=>{"use strict";var gd=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,Sd=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,wd=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,Ed=/^-?infinity$/;ru.exports=function(e){if(Ed.test(e))return Number(e.replace("i","I"));var r=gd.exec(e);if(!r)return Rd(e)||null;var s=!!r[8],o=parseInt(r[1],10);s&&(o=tu(o));var u=parseInt(r[2],10)-1,l=r[3],p=parseInt(r[4],10),d=parseInt(r[5],10),f=parseInt(r[6],10),m=r[7];m=m?1e3*parseFloat(m):0;var y,g=vd(e);return g!=null?(y=new Date(Date.UTC(o,u,l,p,d,f,m)),Ps(o)&&y.setUTCFullYear(o),g!==0&&y.setTime(y.getTime()-g)):(y=new Date(o,u,l,p,d,f,m),Ps(o)&&y.setFullYear(o)),y};function Rd(t){var e=Sd.exec(t);if(e){var r=parseInt(e[1],10),s=!!e[4];s&&(r=tu(r));var o=parseInt(e[2],10)-1,u=e[3],l=new Date(r,o,u);return Ps(r)&&l.setFullYear(r),l}}function vd(t){if(t.endsWith("+00"))return 0;var e=wd.exec(t.split(" ")[1]);if(e){var r=e[1];if(r==="Z")return 0;var s=r==="-"?-1:1,o=parseInt(e[2],10)*3600+parseInt(e[3]||0,10)*60+parseInt(e[4]||0,10);return o*s*1e3}}function tu(t){return-(t-1)}function Ps(t){return t>=0&&t<100}});var su=R((I0,nu)=>{nu.exports=Cd;var Td=Object.prototype.hasOwnProperty;function Cd(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Td.call(r,s)&&(t[s]=r[s])}return t}});var Is=R((D0,ou)=>{"use strict";var Pd=su();ou.exports=Et;function Et(t){if(!(this instanceof Et))return new Et(t);Pd(this,Nd(t))}var Ad=["seconds","minutes","hours","days","months","years"];Et.prototype.toPostgres=function(){var t=Ad.filter(this.hasOwnProperty,this);return this.milliseconds&&t.indexOf("seconds")<0&&t.push("seconds"),t.length===0?"0":t.map(function(e){var r=this[e]||0;return e==="seconds"&&this.milliseconds&&(r=(r+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),r+" "+e},this).join(" ")};var Od={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},Id=["years","months","days"],Dd=["hours","minutes","seconds"];Et.prototype.toISOString=Et.prototype.toISO=function(){var t=Id.map(r,this).join(""),e=Dd.map(r,this).join("");return"P"+t+"T"+e;function r(s){var o=this[s]||0;return s==="seconds"&&this.milliseconds&&(o=(o+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),o+Od[s]}};var Os="([+-]?\\d+)",xd=Os+"\\s+years?",qd=Os+"\\s+mons?",Bd=Os+"\\s+days?",kd="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",Md=new RegExp([xd,qd,Bd,kd].map(function(t){return"("+t+")?"}).join("\\s*")),iu={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},Ld=["hours","minutes","seconds","milliseconds"];function Fd(t){var e=t+"000000".slice(t.length);return parseInt(e,10)/1e3}function Nd(t){if(!t)return{};var e=Md.exec(t),r=e[8]==="-";return Object.keys(iu).reduce(function(s,o){var u=iu[o],l=e[u];return!l||(l=o==="milliseconds"?Fd(l):parseInt(l,10),!l)||(r&&~Ld.indexOf(o)&&(l*=-1),s[o]=l),s},{})}});var Ds=R((x0,au)=>{"use strict";au.exports=function(e){if(/^\\x/.test(e))return new Buffer(e.substr(2),"hex");for(var r="",s=0;s<e.length;)if(e[s]!=="\\")r+=e[s],++s;else if(/[0-7]{3}/.test(e.substr(s+1,3)))r+=String.fromCharCode(parseInt(e.substr(s+1,3),8)),s+=4;else{for(var o=1;s+o<e.length&&e[s+o]==="\\";)o++;for(var u=0;u<Math.floor(o/2);++u)r+="\\";s+=Math.floor(o/2)*2}return new Buffer(r,"binary")}});var pu=R((q0,hu)=>{var nr=Ts(),sr=Cs(),sn=As(),lu=Is(),cu=Ds();function on(t){return function(r){return r===null?r:t(r)}}function fu(t){return t===null?t:t==="TRUE"||t==="t"||t==="true"||t==="y"||t==="yes"||t==="on"||t==="1"}function Wd(t){return t?nr.parse(t,fu):null}function $d(t){return parseInt(t,10)}function xs(t){return t?nr.parse(t,on($d)):null}function Ud(t){return t?nr.parse(t,on(function(e){return du(e).trim()})):null}var zd=function(t){if(!t)return null;var e=sr.create(t,function(r){return r!==null&&(r=Ms(r)),r});return e.parse()},qs=function(t){if(!t)return null;var e=sr.create(t,function(r){return r!==null&&(r=parseFloat(r)),r});return e.parse()},pe=function(t){if(!t)return null;var e=sr.create(t);return e.parse()},Bs=function(t){if(!t)return null;var e=sr.create(t,function(r){return r!==null&&(r=sn(r)),r});return e.parse()},Qd=function(t){if(!t)return null;var e=sr.create(t,function(r){return r!==null&&(r=lu(r)),r});return e.parse()},jd=function(t){return t?nr.parse(t,on(cu)):null},ks=function(t){return parseInt(t,10)},du=function(t){var e=String(t);return/^\d+$/.test(e)?e:t},uu=function(t){return t?nr.parse(t,on(JSON.parse)):null},Ms=function(t){return t[0]!=="("?null:(t=t.substring(1,t.length-1).split(","),{x:parseFloat(t[0]),y:parseFloat(t[1])})},Hd=function(t){if(t[0]!=="<"&&t[1]!=="(")return null;for(var e="(",r="",s=!1,o=2;o<t.length-1;o++){if(s||(e+=t[o]),t[o]===")"){s=!0;continue}else if(!s)continue;t[o]!==","&&(r+=t[o])}var u=Ms(e);return u.radius=parseFloat(r),u},Gd=function(t){t(20,du),t(21,ks),t(23,ks),t(26,ks),t(700,parseFloat),t(701,parseFloat),t(16,fu),t(1082,sn),t(1114,sn),t(1184,sn),t(600,Ms),t(651,pe),t(718,Hd),t(1e3,Wd),t(1001,jd),t(1005,xs),t(1007,xs),t(1028,xs),t(1016,Ud),t(1017,zd),t(1021,qs),t(1022,qs),t(1231,qs),t(1014,pe),t(1015,pe),t(1008,pe),t(1009,pe),t(1040,pe),t(1041,pe),t(1115,Bs),t(1182,Bs),t(1185,Bs),t(1186,lu),t(1187,Qd),t(17,cu),t(114,JSON.parse.bind(JSON)),t(3802,JSON.parse.bind(JSON)),t(199,uu),t(3807,uu),t(3907,pe),t(2951,pe),t(791,pe),t(1183,pe),t(1270,pe)};hu.exports={init:Gd}});var Ls=R((B0,mu)=>{"use strict";var se=1e6;function Yd(t){var e=t.readInt32BE(0),r=t.readUInt32BE(4),s="";e<0&&(e=~e+(r===0),r=~r+1>>>0,s="-");var o="",u,l,p,d,f,m;{if(u=e%se,e=e/se>>>0,l=4294967296*u+r,r=l/se>>>0,p=""+(l-se*r),r===0&&e===0)return s+p+o;for(d="",f=6-p.length,m=0;m<f;m++)d+="0";o=d+p+o}{if(u=e%se,e=e/se>>>0,l=4294967296*u+r,r=l/se>>>0,p=""+(l-se*r),r===0&&e===0)return s+p+o;for(d="",f=6-p.length,m=0;m<f;m++)d+="0";o=d+p+o}{if(u=e%se,e=e/se>>>0,l=4294967296*u+r,r=l/se>>>0,p=""+(l-se*r),r===0&&e===0)return s+p+o;for(d="",f=6-p.length,m=0;m<f;m++)d+="0";o=d+p+o}return u=e%se,l=4294967296*u+r,p=""+l%se,s+p+o}mu.exports=Yd});var Su=R((k0,gu)=>{var Vd=Ls(),$=function(t,e,r,s,o){r=r||0,s=s||!1,o=o||function(S,w,I){return S*Math.pow(2,I)+w};var u=r>>3,l=function(S){return s?~S&255:S},p=255,d=8-r%8;e<d&&(p=255<<8-e&255,d=e),r&&(p=p>>r%8);var f=0;r%8+e>=8&&(f=o(0,l(t[u])&p,d));for(var m=e+r>>3,y=u+1;y<m;y++)f=o(f,l(t[y]),8);var g=(e+r)%8;return g>0&&(f=o(f,l(t[m])>>8-g,g)),f},bu=function(t,e,r){var s=Math.pow(2,r-1)-1,o=$(t,1),u=$(t,r,1);if(u===0)return 0;var l=1,p=function(f,m,y){f===0&&(f=1);for(var g=1;g<=y;g++)l/=2,(m&1<<y-g)>0&&(f+=l);return f},d=$(t,e,r+1,!1,p);return u==Math.pow(2,r+1)-1?d===0?o===0?1/0:-1/0:NaN:(o===0?1:-1)*Math.pow(2,u-s)*d},Kd=function(t){return $(t,1)==1?-1*($(t,15,1,!0)+1):$(t,15,1)},yu=function(t){return $(t,1)==1?-1*($(t,31,1,!0)+1):$(t,31,1)},Jd=function(t){return bu(t,23,8)},Zd=function(t){return bu(t,52,11)},Xd=function(t){var e=$(t,16,32);if(e==49152)return NaN;for(var r=Math.pow(1e4,$(t,16,16)),s=0,o=[],u=$(t,16),l=0;l<u;l++)s+=$(t,16,64+16*l)*r,r/=1e4;var p=Math.pow(10,$(t,16,48));return(e===0?1:-1)*Math.round(s*p)/p},_u=function(t,e){var r=$(e,1),s=$(e,63,1),o=new Date((r===0?1:-1)*s/1e3+9466848e5);return t||o.setTime(o.getTime()+o.getTimezoneOffset()*6e4),o.usec=s%1e3,o.getMicroSeconds=function(){return this.usec},o.setMicroSeconds=function(u){this.usec=u},o.getUTCMicroSeconds=function(){return this.usec},o},ir=function(t){for(var e=$(t,32),r=$(t,32,32),s=$(t,32,64),o=96,u=[],l=0;l<e;l++)u[l]=$(t,32,o),o+=32,o+=32;var p=function(f){var m=$(t,32,o);if(o+=32,m==4294967295)return null;var y;if(f==23||f==20)return y=$(t,m*8,o),o+=m*8,y;if(f==25)return y=t.toString(this.encoding,o>>3,(o+=m<<3)>>3),y;console.log("ERROR: ElementType not implemented: "+f)},d=function(f,m){var y=[],g;if(f.length>1){var S=f.shift();for(g=0;g<S;g++)y[g]=d(f,m);f.unshift(S)}else for(g=0;g<f[0];g++)y[g]=p(m);return y};return d(u,s)},eh=function(t){return t.toString("utf8")},th=function(t){return t===null?null:$(t,8)>0},rh=function(t){t(20,Vd),t(21,Kd),t(23,yu),t(26,yu),t(1700,Xd),t(700,Jd),t(701,Zd),t(16,th),t(1114,_u.bind(null,!1)),t(1184,_u.bind(null,!0)),t(1e3,ir),t(1007,ir),t(1016,ir),t(1008,ir),t(1009,ir),t(25,eh)};gu.exports={init:rh}});var Eu=R((M0,wu)=>{wu.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}});var ur=R(ar=>{var nh=pu(),sh=Su(),ih=Cs(),oh=Eu();ar.getTypeParser=ah;ar.setTypeParser=uh;ar.arrayParser=ih;ar.builtins=oh;var or={text:{},binary:{}};function Ru(t){return String(t)}function ah(t,e){return e=e||"text",or[e]&&or[e][t]||Ru}function uh(t,e,r){typeof e=="function"&&(r=e,e="text"),or[e][t]=r}nh.init(function(t,e){or.text[t]=e});sh.init(function(t,e){or.binary[t]=e})});var lr=R((F0,Fs)=>{"use strict";Fs.exports={host:"localhost",user:process.platform==="win32"?process.env.USERNAME:process.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var Rt=ur(),lh=Rt.getTypeParser(20,"text"),ch=Rt.getTypeParser(1016,"text");Fs.exports.__defineSetter__("parseInt8",function(t){Rt.setTypeParser(20,"text",t?Rt.getTypeParser(23,"text"):lh),Rt.setTypeParser(1016,"text",t?Rt.getTypeParser(1007,"text"):ch)})});var un=R((N0,Tu)=>{"use strict";var fh=require("crypto"),dh=lr();function hh(t){var e=t.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+e+'"'}function vu(t){for(var e="{",r=0;r<t.length;r++)r>0&&(e=e+","),t[r]===null||typeof t[r]>"u"?e=e+"NULL":Array.isArray(t[r])?e=e+vu(t[r]):t[r]instanceof Buffer?e+="\\\\x"+t[r].toString("hex"):e+=hh(an(t[r]));return e=e+"}",e}var an=function(t,e){if(t==null)return null;if(t instanceof Buffer)return t;if(ArrayBuffer.isView(t)){var r=Buffer.from(t.buffer,t.byteOffset,t.byteLength);return r.length===t.byteLength?r:r.slice(t.byteOffset,t.byteOffset+t.byteLength)}return t instanceof Date?dh.parseInputDatesAsUTC?yh(t):mh(t):Array.isArray(t)?vu(t):typeof t=="object"?ph(t,e):t.toString()};function ph(t,e){if(t&&typeof t.toPostgres=="function"){if(e=e||[],e.indexOf(t)!==-1)throw new Error('circular reference detected while preparing "'+t+'" for query');return e.push(t),an(t.toPostgres(an),e)}return JSON.stringify(t)}function K(t,e){for(t=""+t;t.length<e;)t="0"+t;return t}function mh(t){var e=-t.getTimezoneOffset(),r=t.getFullYear(),s=r<1;s&&(r=Math.abs(r)+1);var o=K(r,4)+"-"+K(t.getMonth()+1,2)+"-"+K(t.getDate(),2)+"T"+K(t.getHours(),2)+":"+K(t.getMinutes(),2)+":"+K(t.getSeconds(),2)+"."+K(t.getMilliseconds(),3);return e<0?(o+="-",e*=-1):o+="+",o+=K(Math.floor(e/60),2)+":"+K(e%60,2),s&&(o+=" BC"),o}function yh(t){var e=t.getUTCFullYear(),r=e<1;r&&(e=Math.abs(e)+1);var s=K(e,4)+"-"+K(t.getUTCMonth()+1,2)+"-"+K(t.getUTCDate(),2)+"T"+K(t.getUTCHours(),2)+":"+K(t.getUTCMinutes(),2)+":"+K(t.getUTCSeconds(),2)+"."+K(t.getUTCMilliseconds(),3);return s+="+00:00",r&&(s+=" BC"),s}function _h(t,e,r){return t=typeof t=="string"?{text:t}:t,e&&(typeof e=="function"?t.callback=e:t.values=e),r&&(t.callback=r),t}var Ns=function(t){return fh.createHash("md5").update(t,"utf-8").digest("hex")},bh=function(t,e,r){var s=Ns(e+t),o=Ns(Buffer.concat([Buffer.from(s),r]));return"md5"+o};Tu.exports={prepareValue:function(e){return an(e)},normalizeQueryConfig:_h,postgresMd5PasswordHash:bh,md5:Ns}});var Ou=R((W0,Au)=>{"use strict";var cn=require("crypto");function gh(t){if(t.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let e=cn.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:e,response:"n,,n=*,r="+e,message:"SASLInitialResponse"}}function Sh(t,e,r){if(t.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(e==="")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if(typeof r!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let s=Rh(r);if(s.nonce.startsWith(t.clientNonce)){if(s.nonce.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var o=Buffer.from(s.salt,"base64"),u=cn.pbkdf2Sync(e,o,s.iteration,32,"sha256"),l=ln(u,"Client Key"),p=Ch(l),d="n=*,r="+t.clientNonce,f="r="+s.nonce+",s="+s.salt+",i="+s.iteration,m="c=biws,r="+s.nonce,y=d+","+f+","+m,g=ln(p,y),S=Th(l,g),w=S.toString("base64"),I=ln(u,"Server Key"),D=ln(I,y);t.message="SASLResponse",t.serverSignature=D.toString("base64"),t.response=m+",p="+w}function wh(t,e){if(t.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:r}=vh(e);if(r!==t.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function Eh(t){if(typeof t!="string")throw new TypeError("SASL: text must be a string");return t.split("").map((e,r)=>t.charCodeAt(r)).every(e=>e>=33&&e<=43||e>=45&&e<=126)}function Cu(t){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(t)}function Pu(t){if(typeof t!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(t.split(",").map(e=>{if(!/^.=/.test(e))throw new Error("SASL: Invalid attribute pair entry");let r=e[0],s=e.substring(2);return[r,s]}))}function Rh(t){let e=Pu(t),r=e.get("r");if(r){if(!Eh(r))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let s=e.get("s");if(s){if(!Cu(s))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let o=e.get("i");if(o){if(!/^[1-9][0-9]*$/.test(o))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let u=parseInt(o,10);return{nonce:r,salt:s,iteration:u}}function vh(t){let r=Pu(t).get("v");if(r){if(!Cu(r))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:r}}function Th(t,e){if(!Buffer.isBuffer(t))throw new TypeError("first argument must be a Buffer");if(!Buffer.isBuffer(e))throw new TypeError("second argument must be a Buffer");if(t.length!==e.length)throw new Error("Buffer lengths must match");if(t.length===0)throw new Error("Buffers cannot be empty");return Buffer.from(t.map((r,s)=>t[s]^e[s]))}function Ch(t){return cn.createHash("sha256").update(t).digest()}function ln(t,e){return cn.createHmac("sha256",t).update(e).digest()}Au.exports={startSession:gh,continueSession:Sh,finalizeSession:wh}});var qu=R(($0,xu)=>{"use strict";var{Transform:Ph}=require("stream"),{StringDecoder:Ah}=require("string_decoder"),He=Symbol("last"),fn=Symbol("decoder");function Oh(t,e,r){let s;if(this.overflow){if(s=this[fn].write(t).split(this.matcher),s.length===1)return r();s.shift(),this.overflow=!1}else this[He]+=this[fn].write(t),s=this[He].split(this.matcher);this[He]=s.pop();for(let o=0;o<s.length;o++)try{Du(this,this.mapper(s[o]))}catch(u){return r(u)}if(this.overflow=this[He].length>this.maxLength,this.overflow&&!this.skipOverflow){r(new Error("maximum buffer reached"));return}r()}function Ih(t){if(this[He]+=this[fn].end(),this[He])try{Du(this,this.mapper(this[He]))}catch(e){return t(e)}t()}function Du(t,e){e!==void 0&&t.push(e)}function Iu(t){return t}function Dh(t,e,r){switch(t=t||/\r?\n/,e=e||Iu,r=r||{},arguments.length){case 1:typeof t=="function"?(e=t,t=/\r?\n/):typeof t=="object"&&!(t instanceof RegExp)&&(r=t,t=/\r?\n/);break;case 2:typeof t=="function"?(r=e,e=t,t=/\r?\n/):typeof e=="object"&&(r=e,e=Iu)}r=Object.assign({},r),r.autoDestroy=!0,r.transform=Oh,r.flush=Ih,r.readableObjectMode=!0;let s=new Ph(r);return s[He]="",s[fn]=new Ah("utf8"),s.matcher=t,s.mapper=e,s.maxLength=r.maxLength,s.skipOverflow=r.skipOverflow||!1,s.overflow=!1,s._destroy=function(o,u){this._writableState.errorEmitted=!1,u(o)},s}xu.exports=Dh});var Mu=R((U0,ke)=>{"use strict";var Bu=require("path"),xh=require("stream").Stream,qh=qu(),ku=require("util"),Bh=5432,dn=process.platform==="win32",cr=process.stderr,kh=56,Mh=7,Lh=61440,Fh=32768;function Nh(t){return(t&Lh)==Fh}var vt=["host","port","database","user","password"],Ws=vt.length,Wh=vt[Ws-1];function $s(){var t=cr instanceof xh&&cr.writable===!0;if(t){var e=Array.prototype.slice.call(arguments).concat(`
`);cr.write(ku.format.apply(ku,e))}}Object.defineProperty(ke.exports,"isWin",{get:function(){return dn},set:function(t){dn=t}});ke.exports.warnTo=function(t){var e=cr;return cr=t,e};ke.exports.getFileName=function(t){var e=t||process.env,r=e.PGPASSFILE||(dn?Bu.join(e.APPDATA||"./","postgresql","pgpass.conf"):Bu.join(e.HOME||"./",".pgpass"));return r};ke.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:dn?!0:(e=e||"<unkn>",Nh(t.mode)?t.mode&(kh|Mh)?($s('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:($s('WARNING: password file "%s" is not a plain file',e),!1))};var $h=ke.exports.match=function(t,e){return vt.slice(0,-1).reduce(function(r,s,o){return o==1&&Number(t[s]||Bh)===Number(e[s])?r&&!0:r&&(e[s]==="*"||e[s]===t[s])},!0)};ke.exports.getPassword=function(t,e,r){var s,o=e.pipe(qh());function u(d){var f=Uh(d);f&&zh(f)&&$h(t,f)&&(s=f[Wh],o.end())}var l=function(){e.destroy(),r(s)},p=function(d){e.destroy(),$s("WARNING: error on reading file: %s",d),r(void 0)};e.on("error",p),o.on("data",u).on("end",l).on("error",p)};var Uh=ke.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",r="",s=0,o=0,u=0,l={},p=!1,d=function(m,y,g){var S=t.substring(y,g);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(S=S.replace(/\\([:\\])/g,"$1")),l[vt[m]]=S},f=0;f<t.length-1;f+=1){if(e=t.charAt(f+1),r=t.charAt(f),p=s==Ws-1,p){d(s,o);break}f>=0&&e==":"&&r!=="\\"&&(d(s,o,f+1),o=f+2,s+=1)}return l=Object.keys(l).length===Ws?l:null,l},zh=ke.exports.isValidEntry=function(t){for(var e={0:function(l){return l.length>0},1:function(l){return l==="*"?!0:(l=Number(l),isFinite(l)&&l>0&&l<9007199254740992&&Math.floor(l)===l)},2:function(l){return l.length>0},3:function(l){return l.length>0},4:function(l){return l.length>0}},r=0;r<vt.length;r+=1){var s=e[r],o=t[vt[r]]||"",u=s(o);if(!u)return!1}return!0}});var Fu=R((Q0,Us)=>{"use strict";var z0=require("path"),Lu=require("fs"),hn=Mu();Us.exports=function(t,e){var r=hn.getFileName();Lu.stat(r,function(s,o){if(s||!hn.usePgPass(o,r))return e(void 0);var u=Lu.createReadStream(r);hn.getPassword(t,u,e)})};Us.exports.warnTo=hn.warnTo});var zs=R((j0,Nu)=>{"use strict";var Qh=ur();function pn(t){this._types=t||Qh,this.text={},this.binary={}}pn.prototype.getOverrides=function(t){switch(t){case"text":return this.text;case"binary":return this.binary;default:return{}}};pn.prototype.setTypeParser=function(t,e,r){typeof e=="function"&&(r=e,e="text"),this.getOverrides(e)[t]=r};pn.prototype.getTypeParser=function(t,e){return e=e||"text",this.getOverrides(e)[t]||this._types.getTypeParser(t,e)};Nu.exports=pn});var $u=R((H0,Wu)=>{"use strict";var jh=require("url"),Qs=require("fs");function js(t){if(t.charAt(0)==="/"){var r=t.split(" ");return{host:r[0],database:r[1]}}var e=jh.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(t)?encodeURI(t).replace(/\%25(\d\d)/g,"%$1"):t,!0),r=e.query;for(var s in r)Array.isArray(r[s])&&(r[s]=r[s][r[s].length-1]);var o=(e.auth||":").split(":");if(r.user=o[0],r.password=o.splice(1).join(":"),r.port=e.port,e.protocol=="socket:")return r.host=decodeURI(e.pathname),r.database=e.query.db,r.client_encoding=e.query.encoding,r;r.host||(r.host=e.hostname);var u=e.pathname;if(!r.host&&u&&/^%2f/i.test(u)){var l=u.split("/");r.host=decodeURIComponent(l[0]),u=l.splice(1).join("/")}switch(u&&u.charAt(0)==="/"&&(u=u.slice(1)||null),r.database=u&&decodeURI(u),(r.ssl==="true"||r.ssl==="1")&&(r.ssl=!0),r.ssl==="0"&&(r.ssl=!1),(r.sslcert||r.sslkey||r.sslrootcert||r.sslmode)&&(r.ssl={}),r.sslcert&&(r.ssl.cert=Qs.readFileSync(r.sslcert).toString()),r.sslkey&&(r.ssl.key=Qs.readFileSync(r.sslkey).toString()),r.sslrootcert&&(r.ssl.ca=Qs.readFileSync(r.sslrootcert).toString()),r.sslmode){case"disable":{r.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{r.ssl.rejectUnauthorized=!1;break}}return r}Wu.exports=js;js.parse=js});var Gs=R((G0,Qu)=>{"use strict";var Hh=require("dns"),zu=lr(),Uu=$u().parse,X=function(t,e,r){return r===void 0?r=process.env["PG"+t.toUpperCase()]:r===!1||(r=process.env[r]),e[t]||r||zu[t]},Gh=function(){switch(process.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return zu.ssl},Tt=function(t){return"'"+(""+t).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},me=function(t,e,r){var s=e[r];s!=null&&t.push(r+"="+Tt(s))},Hs=class{constructor(e){e=typeof e=="string"?Uu(e):e||{},e.connectionString&&(e=Object.assign({},e,Uu(e.connectionString))),this.user=X("user",e),this.database=X("database",e),this.database===void 0&&(this.database=this.user),this.port=parseInt(X("port",e),10),this.host=X("host",e),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:X("password",e)}),this.binary=X("binary",e),this.options=X("options",e),this.ssl=typeof e.ssl>"u"?Gh():e.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=X("client_encoding",e),this.replication=X("replication",e),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=X("application_name",e,"PGAPPNAME"),this.fallback_application_name=X("fallback_application_name",e,!1),this.statement_timeout=X("statement_timeout",e,!1),this.lock_timeout=X("lock_timeout",e,!1),this.idle_in_transaction_session_timeout=X("idle_in_transaction_session_timeout",e,!1),this.query_timeout=X("query_timeout",e,!1),e.connectionTimeoutMillis===void 0?this.connect_timeout=process.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(e.connectionTimeoutMillis/1e3),e.keepAlive===!1?this.keepalives=0:e.keepAlive===!0&&(this.keepalives=1),typeof e.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(e.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(e){var r=[];me(r,this,"user"),me(r,this,"password"),me(r,this,"port"),me(r,this,"application_name"),me(r,this,"fallback_application_name"),me(r,this,"connect_timeout"),me(r,this,"options");var s=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(me(r,s,"sslmode"),me(r,s,"sslca"),me(r,s,"sslkey"),me(r,s,"sslcert"),me(r,s,"sslrootcert"),this.database&&r.push("dbname="+Tt(this.database)),this.replication&&r.push("replication="+Tt(this.replication)),this.host&&r.push("host="+Tt(this.host)),this.isDomainSocket)return e(null,r.join(" "));this.client_encoding&&r.push("client_encoding="+Tt(this.client_encoding)),Hh.lookup(this.host,function(o,u){return o?e(o,null):(r.push("hostaddr="+Tt(u)),e(null,r.join(" ")))})}};Qu.exports=Hs});var Gu=R((Y0,Hu)=>{"use strict";var Yh=ur(),ju=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,Ys=class{constructor(e,r){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=r,this.RowCtor=null,this.rowAsArray=e==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(e){var r;e.text?r=ju.exec(e.text):r=ju.exec(e.command),r&&(this.command=r[1],r[3]?(this.oid=parseInt(r[2],10),this.rowCount=parseInt(r[3],10)):r[2]&&(this.rowCount=parseInt(r[2],10)))}_parseRowAsArray(e){for(var r=new Array(e.length),s=0,o=e.length;s<o;s++){var u=e[s];u!==null?r[s]=this._parsers[s](u):r[s]=null}return r}parseRow(e){for(var r={},s=0,o=e.length;s<o;s++){var u=e[s],l=this.fields[s].name;u!==null?r[l]=this._parsers[s](u):r[l]=null}return r}addRow(e){this.rows.push(e)}addFields(e){this.fields=e,this.fields.length&&(this._parsers=new Array(e.length));for(var r=0;r<e.length;r++){var s=e[r];this._types?this._parsers[r]=this._types.getTypeParser(s.dataTypeID,s.format||"text"):this._parsers[r]=Yh.getTypeParser(s.dataTypeID,s.format||"text")}}};Hu.exports=Ys});var Ju=R((V0,Ku)=>{"use strict";var{EventEmitter:Vh}=require("events"),Yu=Gu(),Vu=un(),Vs=class extends Vh{constructor(e,r,s){super(),e=Vu.normalizeQueryConfig(e,r,s),this.text=e.text,this.values=e.values,this.rows=e.rows,this.types=e.types,this.name=e.name,this.binary=e.binary,this.portal=e.portal||"",this.callback=e.callback,this._rowMode=e.rowMode,process.domain&&e.callback&&(this.callback=process.domain.bind(e.callback)),this._result=new Yu(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new Yu(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(e){let r;if(!this._canceledDueToError){try{r=this._result.parseRow(e.fields)}catch(s){this._canceledDueToError=s;return}this.emit("row",r,this._result),this._accumulateRows&&this._result.addRow(r)}}handleCommandComplete(e,r){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&r.sync()}handleEmptyQuery(e){this.rows&&e.sync()}handleError(e,r){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}handleReadyForQuery(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);if(this.callback)try{this.callback(null,this._results)}catch(r){process.nextTick(()=>{throw r})}this.emit("end",this._results)}submit(e){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let r=e.parsedStatements[this.name];return this.text&&r&&this.text!==r?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(e):e.query(this.text),null)}hasBeenParsed(e){return this.name&&e.parsedStatements[this.name]}handlePortalSuspended(e){this._getRows(e,this.rows)}_getRows(e,r){e.execute({portal:this.portal,rows:r}),r?e.flush():e.sync()}prepare(e){this.isPreparedStatement=!0,this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:Vu.prepareValue})}catch(r){this.handleError(r,e);return}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}handleCopyInResponse(e){e.sendCopyFail("No source stream defined")}handleCopyData(e,r){}};Ku.exports=Vs});var ci=R(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.NoticeMessage=T.DataRowMessage=T.CommandCompleteMessage=T.ReadyForQueryMessage=T.NotificationResponseMessage=T.BackendKeyDataMessage=T.AuthenticationMD5Password=T.ParameterStatusMessage=T.ParameterDescriptionMessage=T.RowDescriptionMessage=T.Field=T.CopyResponse=T.CopyDataMessage=T.DatabaseError=T.copyDone=T.emptyQuery=T.replicationStart=T.portalSuspended=T.noData=T.closeComplete=T.bindComplete=T.parseComplete=void 0;T.parseComplete={name:"parseComplete",length:5};T.bindComplete={name:"bindComplete",length:5};T.closeComplete={name:"closeComplete",length:5};T.noData={name:"noData",length:5};T.portalSuspended={name:"portalSuspended",length:5};T.replicationStart={name:"replicationStart",length:4};T.emptyQuery={name:"emptyQuery",length:4};T.copyDone={name:"copyDone",length:4};var Ks=class extends Error{constructor(e,r,s){super(e),this.length=r,this.name=s}};T.DatabaseError=Ks;var Js=class{constructor(e,r){this.length=e,this.chunk=r,this.name="copyData"}};T.CopyDataMessage=Js;var Zs=class{constructor(e,r,s,o){this.length=e,this.name=r,this.binary=s,this.columnTypes=new Array(o)}};T.CopyResponse=Zs;var Xs=class{constructor(e,r,s,o,u,l,p){this.name=e,this.tableID=r,this.columnID=s,this.dataTypeID=o,this.dataTypeSize=u,this.dataTypeModifier=l,this.format=p}};T.Field=Xs;var ei=class{constructor(e,r){this.length=e,this.fieldCount=r,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};T.RowDescriptionMessage=ei;var ti=class{constructor(e,r){this.length=e,this.parameterCount=r,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};T.ParameterDescriptionMessage=ti;var ri=class{constructor(e,r,s){this.length=e,this.parameterName=r,this.parameterValue=s,this.name="parameterStatus"}};T.ParameterStatusMessage=ri;var ni=class{constructor(e,r){this.length=e,this.salt=r,this.name="authenticationMD5Password"}};T.AuthenticationMD5Password=ni;var si=class{constructor(e,r,s){this.length=e,this.processID=r,this.secretKey=s,this.name="backendKeyData"}};T.BackendKeyDataMessage=si;var ii=class{constructor(e,r,s,o){this.length=e,this.processId=r,this.channel=s,this.payload=o,this.name="notification"}};T.NotificationResponseMessage=ii;var oi=class{constructor(e,r){this.length=e,this.status=r,this.name="readyForQuery"}};T.ReadyForQueryMessage=oi;var ai=class{constructor(e,r){this.length=e,this.text=r,this.name="commandComplete"}};T.CommandCompleteMessage=ai;var ui=class{constructor(e,r){this.length=e,this.fields=r,this.name="dataRow",this.fieldCount=r.length}};T.DataRowMessage=ui;var li=class{constructor(e,r){this.length=e,this.message=r,this.name="notice"}};T.NoticeMessage=li});var Zu=R(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.Writer=void 0;var fi=class{constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(e)}ensure(e){var r=this.buffer.length-this.offset;if(r<e){var s=this.buffer,o=s.length+(s.length>>1)+e;this.buffer=Buffer.allocUnsafe(o),s.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(!e)this.ensure(1);else{var r=Buffer.byteLength(e);this.ensure(r+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=r}return this.buffer[this.offset++]=0,this}addString(e=""){var r=Buffer.byteLength(e);return this.ensure(r),this.buffer.write(e,this.offset),this.offset+=r,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let r=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(r,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}flush(e){var r=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(this.size),r}};mn.Writer=fi});var el=R(_n=>{"use strict";Object.defineProperty(_n,"__esModule",{value:!0});_n.serialize=void 0;var di=Zu(),U=new di.Writer,Kh=t=>{U.addInt16(3).addInt16(0);for(let s of Object.keys(t))U.addCString(s).addCString(t[s]);U.addCString("client_encoding").addCString("UTF8");var e=U.addCString("").flush(),r=e.length+4;return new di.Writer().addInt32(r).add(e).flush()},Jh=()=>{let t=Buffer.allocUnsafe(8);return t.writeInt32BE(8,0),t.writeInt32BE(80877103,4),t},Zh=t=>U.addCString(t).flush(112),Xh=function(t,e){return U.addCString(t).addInt32(Buffer.byteLength(e)).addString(e),U.flush(112)},ep=function(t){return U.addString(t).flush(112)},tp=t=>U.addCString(t).flush(81),Xu=[],rp=t=>{let e=t.name||"";e.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",e,e.length),console.error("This can cause conflicts and silent errors executing queries"));let r=t.types||Xu;for(var s=r.length,o=U.addCString(e).addCString(t.text).addInt16(s),u=0;u<s;u++)o.addInt32(r[u]);return U.flush(80)},Ct=new di.Writer,np=function(t,e){for(let r=0;r<t.length;r++){let s=e?e(t[r],r):t[r];s==null?(U.addInt16(0),Ct.addInt32(-1)):s instanceof Buffer?(U.addInt16(1),Ct.addInt32(s.length),Ct.add(s)):(U.addInt16(0),Ct.addInt32(Buffer.byteLength(s)),Ct.addString(s))}},sp=(t={})=>{let e=t.portal||"",r=t.statement||"",s=t.binary||!1,o=t.values||Xu,u=o.length;return U.addCString(e).addCString(r),U.addInt16(u),np(o,t.valueMapper),U.addInt16(u),U.add(Ct.flush()),U.addInt16(s?1:0),U.flush(66)},ip=Buffer.from([69,0,0,0,9,0,0,0,0,0]),op=t=>{if(!t||!t.portal&&!t.rows)return ip;let e=t.portal||"",r=t.rows||0,s=Buffer.byteLength(e),o=4+s+1+4,u=Buffer.allocUnsafe(1+o);return u[0]=69,u.writeInt32BE(o,1),u.write(e,5,"utf-8"),u[s+5]=0,u.writeUInt32BE(r,u.length-4),u},ap=(t,e)=>{let r=Buffer.allocUnsafe(16);return r.writeInt32BE(16,0),r.writeInt16BE(1234,4),r.writeInt16BE(5678,6),r.writeInt32BE(t,8),r.writeInt32BE(e,12),r},hi=(t,e)=>{let s=4+Buffer.byteLength(e)+1,o=Buffer.allocUnsafe(1+s);return o[0]=t,o.writeInt32BE(s,1),o.write(e,5,"utf-8"),o[s]=0,o},up=U.addCString("P").flush(68),lp=U.addCString("S").flush(68),cp=t=>t.name?hi(68,`${t.type}${t.name||""}`):t.type==="P"?up:lp,fp=t=>{let e=`${t.type}${t.name||""}`;return hi(67,e)},dp=t=>U.add(t).flush(100),hp=t=>hi(102,t),yn=t=>Buffer.from([t,0,0,0,4]),pp=yn(72),mp=yn(83),yp=yn(88),_p=yn(99),bp={startup:Kh,password:Zh,requestSsl:Jh,sendSASLInitialResponseMessage:Xh,sendSCRAMClientFinalMessage:ep,query:tp,parse:rp,bind:sp,execute:op,describe:cp,close:fp,flush:()=>pp,sync:()=>mp,end:()=>yp,copyData:dp,copyDone:()=>_p,copyFail:hp,cancel:ap};_n.serialize=bp});var tl=R(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.BufferReader=void 0;var gp=Buffer.allocUnsafe(0),pi=class{constructor(e=0){this.offset=e,this.buffer=gp,this.encoding="utf-8"}setBuffer(e,r){this.offset=e,this.buffer=r}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}string(e){let r=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,r}cstring(){let e=this.offset,r=e;for(;this.buffer[r++]!==0;);return this.offset=r,this.buffer.toString(this.encoding,e,r-1)}bytes(e){let r=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,r}};bn.BufferReader=pi});var sl=R(Pt=>{"use strict";var Sp=Pt&&Pt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.Parser=void 0;var Q=ci(),wp=tl(),Ep=Sp(require("assert")),mi=1,Rp=4,rl=mi+Rp,nl=Buffer.allocUnsafe(0),yi=class{constructor(e){if(this.buffer=nl,this.bufferLength=0,this.bufferOffset=0,this.reader=new wp.BufferReader,e?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=e?.mode||"text"}parse(e,r){this.mergeBuffer(e);let s=this.bufferOffset+this.bufferLength,o=this.bufferOffset;for(;o+rl<=s;){let u=this.buffer[o],l=this.buffer.readUInt32BE(o+mi),p=mi+l;if(p+o<=s){let d=this.handlePacket(o+rl,u,l,this.buffer);r(d),o+=p}else break}o===s?(this.buffer=nl,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=s-o,this.bufferOffset=o)}mergeBuffer(e){if(this.bufferLength>0){let r=this.bufferLength+e.byteLength;if(r+this.bufferOffset>this.buffer.byteLength){let o;if(r<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)o=this.buffer;else{let u=this.buffer.byteLength*2;for(;r>=u;)u*=2;o=Buffer.allocUnsafe(u)}this.buffer.copy(o,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=o,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=r}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,r,s,o){switch(r){case 50:return Q.bindComplete;case 49:return Q.parseComplete;case 51:return Q.closeComplete;case 110:return Q.noData;case 115:return Q.portalSuspended;case 99:return Q.copyDone;case 87:return Q.replicationStart;case 73:return Q.emptyQuery;case 68:return this.parseDataRowMessage(e,s,o);case 67:return this.parseCommandCompleteMessage(e,s,o);case 90:return this.parseReadyForQueryMessage(e,s,o);case 65:return this.parseNotificationMessage(e,s,o);case 82:return this.parseAuthenticationResponse(e,s,o);case 83:return this.parseParameterStatusMessage(e,s,o);case 75:return this.parseBackendKeyData(e,s,o);case 69:return this.parseErrorMessage(e,s,o,"error");case 78:return this.parseErrorMessage(e,s,o,"notice");case 84:return this.parseRowDescriptionMessage(e,s,o);case 116:return this.parseParameterDescriptionMessage(e,s,o);case 71:return this.parseCopyInMessage(e,s,o);case 72:return this.parseCopyOutMessage(e,s,o);case 100:return this.parseCopyData(e,s,o);default:Ep.default.fail(`unknown message code: ${r.toString(16)}`)}}parseReadyForQueryMessage(e,r,s){this.reader.setBuffer(e,s);let o=this.reader.string(1);return new Q.ReadyForQueryMessage(r,o)}parseCommandCompleteMessage(e,r,s){this.reader.setBuffer(e,s);let o=this.reader.cstring();return new Q.CommandCompleteMessage(r,o)}parseCopyData(e,r,s){let o=s.slice(e,e+(r-4));return new Q.CopyDataMessage(r,o)}parseCopyInMessage(e,r,s){return this.parseCopyMessage(e,r,s,"copyInResponse")}parseCopyOutMessage(e,r,s){return this.parseCopyMessage(e,r,s,"copyOutResponse")}parseCopyMessage(e,r,s,o){this.reader.setBuffer(e,s);let u=this.reader.byte()!==0,l=this.reader.int16(),p=new Q.CopyResponse(r,o,u,l);for(let d=0;d<l;d++)p.columnTypes[d]=this.reader.int16();return p}parseNotificationMessage(e,r,s){this.reader.setBuffer(e,s);let o=this.reader.int32(),u=this.reader.cstring(),l=this.reader.cstring();return new Q.NotificationResponseMessage(r,o,u,l)}parseRowDescriptionMessage(e,r,s){this.reader.setBuffer(e,s);let o=this.reader.int16(),u=new Q.RowDescriptionMessage(r,o);for(let l=0;l<o;l++)u.fields[l]=this.parseField();return u}parseField(){let e=this.reader.cstring(),r=this.reader.int32(),s=this.reader.int16(),o=this.reader.int32(),u=this.reader.int16(),l=this.reader.int32(),p=this.reader.int16()===0?"text":"binary";return new Q.Field(e,r,s,o,u,l,p)}parseParameterDescriptionMessage(e,r,s){this.reader.setBuffer(e,s);let o=this.reader.int16(),u=new Q.ParameterDescriptionMessage(r,o);for(let l=0;l<o;l++)u.dataTypeIDs[l]=this.reader.int32();return u}parseDataRowMessage(e,r,s){this.reader.setBuffer(e,s);let o=this.reader.int16(),u=new Array(o);for(let l=0;l<o;l++){let p=this.reader.int32();u[l]=p===-1?null:this.reader.string(p)}return new Q.DataRowMessage(r,u)}parseParameterStatusMessage(e,r,s){this.reader.setBuffer(e,s);let o=this.reader.cstring(),u=this.reader.cstring();return new Q.ParameterStatusMessage(r,o,u)}parseBackendKeyData(e,r,s){this.reader.setBuffer(e,s);let o=this.reader.int32(),u=this.reader.int32();return new Q.BackendKeyDataMessage(r,o,u)}parseAuthenticationResponse(e,r,s){this.reader.setBuffer(e,s);let o=this.reader.int32(),u={name:"authenticationOk",length:r};switch(o){case 0:break;case 3:u.length===8&&(u.name="authenticationCleartextPassword");break;case 5:if(u.length===12){u.name="authenticationMD5Password";let p=this.reader.bytes(4);return new Q.AuthenticationMD5Password(r,p)}break;case 10:u.name="authenticationSASL",u.mechanisms=[];let l;do l=this.reader.cstring(),l&&u.mechanisms.push(l);while(l);break;case 11:u.name="authenticationSASLContinue",u.data=this.reader.string(r-8);break;case 12:u.name="authenticationSASLFinal",u.data=this.reader.string(r-8);break;default:throw new Error("Unknown authenticationOk message type "+o)}return u}parseErrorMessage(e,r,s,o){this.reader.setBuffer(e,s);let u={},l=this.reader.string(1);for(;l!=="\0";)u[l]=this.reader.cstring(),l=this.reader.string(1);let p=u.M,d=o==="notice"?new Q.NoticeMessage(r,p):new Q.DatabaseError(p,r,o);return d.severity=u.S,d.code=u.C,d.detail=u.D,d.hint=u.H,d.position=u.P,d.internalPosition=u.p,d.internalQuery=u.q,d.where=u.W,d.schema=u.s,d.table=u.t,d.column=u.c,d.dataType=u.d,d.constraint=u.n,d.file=u.F,d.line=u.L,d.routine=u.R,d}};Pt.Parser=yi});var _i=R(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.DatabaseError=Ge.serialize=Ge.parse=void 0;var vp=ci();Object.defineProperty(Ge,"DatabaseError",{enumerable:!0,get:function(){return vp.DatabaseError}});var Tp=el();Object.defineProperty(Ge,"serialize",{enumerable:!0,get:function(){return Tp.serialize}});var Cp=sl();function Pp(t,e){let r=new Cp.Parser;return t.on("data",s=>r.parse(s,e)),new Promise(s=>t.on("end",()=>s()))}Ge.parse=Pp});var gi=R((r_,ol)=>{"use strict";var il=require("net"),Ap=require("events").EventEmitter,{parse:Op,serialize:Y}=_i(),Ip=Y.flush(),Dp=Y.sync(),xp=Y.end(),bi=class extends Ap{constructor(e){super(),e=e||{},this.stream=e.stream||new il.Socket,typeof this.stream=="function"&&(this.stream=this.stream(e)),this._keepAlive=e.keepAlive,this._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=e.ssl||!1,this._ending=!1,this._emitMessage=!1;var r=this;this.on("newListener",function(s){s==="message"&&(r._emitMessage=!0)})}connect(e,r){var s=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,r),this.stream.once("connect",function(){s._keepAlive&&s.stream.setKeepAlive(!0,s._keepAliveInitialDelayMillis),s.emit("connect")});let o=function(u){s._ending&&(u.code==="ECONNRESET"||u.code==="EPIPE")||s.emit("error",u)};if(this.stream.on("error",o),this.stream.on("close",function(){s.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(u){var l=u.toString("utf8");switch(l){case"S":break;case"N":return s.stream.end(),s.emit("error",new Error("The server does not support SSL connections"));default:return s.stream.end(),s.emit("error",new Error("There was an error establishing an SSL connection"))}var p=require("tls");let d={socket:s.stream};s.ssl!==!0&&(Object.assign(d,s.ssl),"key"in s.ssl&&(d.key=s.ssl.key)),il.isIP(r)===0&&(d.servername=r);try{s.stream=p.connect(d)}catch(f){return s.emit("error",f)}s.attachListeners(s.stream),s.stream.on("error",o),s.emit("sslconnect")})}attachListeners(e){e.on("end",()=>{this.emit("end")}),Op(e,r=>{var s=r.name==="error"?"errorMessage":r.name;this._emitMessage&&this.emit("message",r),this.emit(s,r)})}requestSsl(){this.stream.write(Y.requestSsl())}startup(e){this.stream.write(Y.startup(e))}cancel(e,r){this._send(Y.cancel(e,r))}password(e){this._send(Y.password(e))}sendSASLInitialResponseMessage(e,r){this._send(Y.sendSASLInitialResponseMessage(e,r))}sendSCRAMClientFinalMessage(e){this._send(Y.sendSCRAMClientFinalMessage(e))}_send(e){return this.stream.writable?this.stream.write(e):!1}query(e){this._send(Y.query(e))}parse(e){this._send(Y.parse(e))}bind(e){this._send(Y.bind(e))}execute(e){this._send(Y.execute(e))}flush(){this.stream.writable&&this.stream.write(Ip)}sync(){this._ending=!0,this._send(Dp)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(xp,()=>{this.stream.end()})}close(e){this._send(Y.close(e))}describe(e){this._send(Y.describe(e))}sendCopyFromChunk(e){this._send(Y.copyData(e))}endCopyFrom(){this._send(Y.copyDone())}sendCopyFail(e){this._send(Y.copyFail(e))}};ol.exports=bi});var ll=R((n_,ul)=>{"use strict";var qp=require("events").EventEmitter,Bp=un(),Si=Ou(),kp=Fu(),Mp=zs(),Lp=Gs(),al=Ju(),Fp=lr(),Np=gi(),gn=class extends qp{constructor(e){super(),this.connectionParameters=new Lp(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var r=e||{};this._Promise=r.Promise||global.Promise,this._types=new Mp(r.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=r.connection||new Np({stream:r.stream,ssl:this.connectionParameters.ssl,keepAlive:r.keepAlive||!1,keepAliveInitialDelayMillis:r.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=r.binary||Fp.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=r.connectionTimeoutMillis||0}_errorAllQueries(e){let r=s=>{process.nextTick(()=>{s.handleError(e,this.connection)})};this.activeQuery&&(r(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(r),this.queryQueue.length=0}_connect(e){var r=this,s=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let o=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(o)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{s._ending=!0,s.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?s.connect(this.host+"/.s.PGSQL."+this.port):s.connect(this.port,this.host),s.on("connect",function(){r.ssl?s.requestSsl():s.startup(r.getStartupConf())}),s.on("sslconnect",function(){s.startup(r.getStartupConf())}),this._attachListeners(s),s.once("end",()=>{let o=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(o),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(o):this._handleErrorEvent(o):this._connectionError||this._handleErrorEvent(o)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((r,s)=>{this._connect(o=>{o?s(o):r()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let r=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(s=>{if(s!==void 0){if(typeof s!="string"){r.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=s}else this.connectionParameters.password=this.password=null;e()}).catch(s=>{r.emit("error",s)}):this.password!==null?e():kp(this.connectionParameters,s=>{s!==void 0&&(this.connectionParameters.password=this.password=s),e()})}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(()=>{let r=Bp.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(r)})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=Si.startSession(e.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(r){this.connection.emit("error",r)}})}_handleAuthSASLContinue(e){try{Si.continueSession(this.saslSession,this.password,e.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(r){this.connection.emit("error",r)}}_handleAuthSASLFinal(e){try{Si.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(r){this.connection.emit("error",r)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:r}=this;this.activeQuery=null,this.readyForQuery=!0,r&&r.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let r=this.activeQuery;if(!r){this._handleErrorEvent(e);return}this.activeQuery=null,r.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(e){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){var e=this.connectionParameters,r={user:e.user,database:e.database},s=e.application_name||e.fallback_application_name;return s&&(r.application_name=s),e.replication&&(r.replication=""+e.replication),e.statement_timeout&&(r.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(r.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(r.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(r.options=e.options),r}cancel(e,r){if(e.activeQuery===r){var s=this.connection;this.host&&this.host.indexOf("/")===0?s.connect(this.host+"/.s.PGSQL."+this.port):s.connect(this.port,this.host),s.on("connect",function(){s.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(r)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(r),1)}setTypeParser(e,r,s){return this._types.setTypeParser(e,r,s)}getTypeParser(e,r){return this._types.getTypeParser(e,r)}escapeIdentifier(e){return'"'+e.replace(/"/g,'""')+'"'}escapeLiteral(e){for(var r=!1,s="'",o=0;o<e.length;o++){var u=e[o];u==="'"?s+=u+u:u==="\\"?(s+=u+u,r=!0):s+=u}return s+="'",r===!0&&(s=" E"+s),s}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,r,s){var o,u,l,p,d;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(l=e.query_timeout||this.connectionParameters.query_timeout,u=o=e,typeof r=="function"&&(o.callback=o.callback||r)):(l=this.connectionParameters.query_timeout,o=new al(e,r,s),o.callback||(u=new this._Promise((f,m)=>{o.callback=(y,g)=>y?m(y):f(g)}))),l&&(d=o.callback,p=setTimeout(()=>{var f=new Error("Query read timeout");process.nextTick(()=>{o.handleError(f,this.connection)}),d(f),o.callback=()=>{};var m=this.queryQueue.indexOf(o);m>-1&&this.queryQueue.splice(m,1),this._pulseQueryQueue()},l),o.callback=(f,m)=>{clearTimeout(p),d(f,m)}),this.binary&&!o.binary&&(o.binary=!0),o._result&&!o._result._types&&(o._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{o.handleError(new Error("Client was closed and is not queryable"),this.connection)}),u):(this.queryQueue.push(o),this._pulseQueryQueue(),u):(process.nextTick(()=>{o.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),u)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(r=>{this.connection.once("end",r)})}};gn.Query=al;ul.exports=gn});var hl=R((s_,dl)=>{"use strict";var Wp=require("events").EventEmitter,cl=function(){},fl=(t,e)=>{let r=t.findIndex(e);return r===-1?void 0:t.splice(r,1)[0]},wi=class{constructor(e,r,s){this.client=e,this.idleListener=r,this.timeoutId=s}},At=class{constructor(e){this.callback=e}};function $p(){throw new Error("Release called on client which has already been released to the pool.")}function Sn(t,e){if(e)return{callback:e,result:void 0};let r,s,o=function(l,p){l?r(l):s(p)},u=new t(function(l,p){s=l,r=p});return{callback:o,result:u}}function Up(t,e){return function r(s){s.client=e,e.removeListener("error",r),e.on("error",()=>{t.log("additional client error after disconnection due to error",s)}),t._remove(e),t.emit("error",s,e)}}var Ei=class extends Wp{constructor(e,r){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||r||Ri().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(r=>{this._remove(r.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let r=this._idle.pop();clearTimeout(r.timeoutId);let s=r.client;s.ref&&s.ref();let o=r.idleListener;return this._acquireClient(s,e,o,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e){let r=fl(this._idle,s=>s.client===e);r!==void 0&&clearTimeout(r.timeoutId),this._clients=this._clients.filter(s=>s!==e),e.end(),this.emit("remove",e)}connect(e){if(this.ending){let o=new Error("Cannot use a pool after calling end on the pool");return e?e(o):this.Promise.reject(o)}let r=Sn(this.Promise,e),s=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new At(r.callback)),s;let o=(p,d,f)=>{clearTimeout(l),r.callback(p,d,f)},u=new At(o),l=setTimeout(()=>{fl(this._pendingQueue,p=>p.callback===o),u.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(u),s}return this.newClient(new At(r.callback)),s}newClient(e){let r=new this.Client(this.options);this._clients.push(r);let s=Up(this,r);this.log("checking client timeout");let o,u=!1;this.options.connectionTimeoutMillis&&(o=setTimeout(()=>{this.log("ending client due to timeout"),u=!0,r.connection?r.connection.stream.destroy():r.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),r.connect(l=>{if(o&&clearTimeout(o),r.on("error",s),l)this.log("client failed to connect",l),this._clients=this._clients.filter(p=>p!==r),u&&(l.message="Connection terminated due to connection timeout"),this._pulseQueue(),e.timedOut||e.callback(l,void 0,cl);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let p=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(r),this._idle.findIndex(f=>f.client===r)!==-1&&this._acquireClient(r,new At((f,m,y)=>y()),s,!1)},this.options.maxLifetimeSeconds*1e3);p.unref(),r.once("end",()=>clearTimeout(p))}return this._acquireClient(r,e,s,!0)}})}_acquireClient(e,r,s,o){o&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,s),e.removeListener("error",s),r.timedOut?o&&this.options.verify?this.options.verify(e,e.release):e.release():o&&this.options.verify?this.options.verify(e,u=>{if(u)return e.release(u),r.callback(u,void 0,cl);r.callback(void 0,e,e.release)}):r.callback(void 0,e,e.release)}_releaseOnce(e,r){let s=!1;return o=>{s&&$p(),s=!0,this._release(e,r,o)}}_release(e,r,s){if(e.on("error",r),e._poolUseCount=(e._poolUseCount||0)+1,s||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses){e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e),this._pulseQueue();return}if(this._expired.has(e)){this.log("remove expired client"),this._expired.delete(e),this._remove(e),this._pulseQueue();return}let u;this.options.idleTimeoutMillis&&(u=setTimeout(()=>{this.log("remove idle client"),this._remove(e)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&u.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new wi(e,r,u)),this._pulseQueue()}query(e,r,s){if(typeof e=="function"){let u=Sn(this.Promise,e);return setImmediate(function(){return u.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),u.result}typeof r=="function"&&(s=r,r=void 0);let o=Sn(this.Promise,s);return s=o.callback,this.connect((u,l)=>{if(u)return s(u);let p=!1,d=f=>{p||(p=!0,l.release(f),s(f))};l.once("error",d),this.log("dispatching query");try{l.query(e,r,(f,m)=>{if(this.log("query dispatched"),l.removeListener("error",d),!p)return p=!0,l.release(f),f?s(f):s(void 0,m)})}catch(f){return l.release(f),s(f)}}),o.result}end(e){if(this.log("ending"),this.ending){let s=new Error("Called end on pool more than once");return e?e(s):this.Promise.reject(s)}this.ending=!0;let r=Sn(this.Promise,e);return this._endCallback=r.callback,this._pulseQueue(),r.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,r)=>e+(this._expired.has(r)?1:0),0)}get totalCount(){return this._clients.length}};dl.exports=Ei});var ml=R((i_,pl)=>{var wn=require("path").sep||"/";pl.exports=zp;function zp(t){if(typeof t!="string"||t.length<=7||t.substring(0,7)!="file://")throw new TypeError("must pass in a file:// URI to convert to a file path");var e=decodeURI(t.substring(7)),r=e.indexOf("/"),s=e.substring(0,r),o=e.substring(r+1);return s=="localhost"&&(s=""),s&&(s=wn+wn+s),o=o.replace(/^(.+)\|/,"$1:"),wn=="\\"&&(o=o.replace(/\//g,"\\")),/^.+\:/.test(o)||(o=wn+o),s+o}});var gl=R((Ot,bl)=>{var vi=require("fs"),Rn=require("path"),Qp=ml(),En=Rn.join,jp=Rn.dirname,yl=vi.accessSync&&function(t){try{vi.accessSync(t)}catch{return!1}return!0}||vi.existsSync||Rn.existsSync,_l={arrow:process.env.NODE_BINDINGS_ARROW||" \u2192 ",compiled:process.env.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:process.platform,arch:process.arch,nodePreGyp:"node-v"+process.versions.modules+"-"+process.platform+"-"+process.arch,version:process.versions.node,bindings:"bindings.node",try:[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"],["module_root","addon-build","release","install-root","bindings"],["module_root","addon-build","debug","install-root","bindings"],["module_root","addon-build","default","install-root","bindings"],["module_root","lib","binding","nodePreGyp","bindings"]]};function Hp(t){typeof t=="string"?t={bindings:t}:t||(t={}),Object.keys(_l).map(function(d){d in t||(t[d]=_l[d])}),t.module_root||(t.module_root=Ot.getRoot(Ot.getFileName())),Rn.extname(t.bindings)!=".node"&&(t.bindings+=".node");for(var e=typeof __webpack_require__=="function"?__non_webpack_require__:require,r=[],s=0,o=t.try.length,u,l,p;s<o;s++){u=En.apply(null,t.try[s].map(function(d){return t[d]||d})),r.push(u);try{return l=t.path?e.resolve(u):e(u),t.path||(l.path=u),l}catch(d){if(d.code!=="MODULE_NOT_FOUND"&&d.code!=="QUALIFIED_PATH_RESOLUTION_FAILED"&&!/not find/i.test(d.message))throw d}}throw p=new Error(`Could not locate the bindings file. Tried:
`+r.map(function(d){return t.arrow+d}).join(`
`)),p.tries=r,p}bl.exports=Ot=Hp;Ot.getFileName=function(e){var r=Error.prepareStackTrace,s=Error.stackTraceLimit,o={},u;Error.stackTraceLimit=10,Error.prepareStackTrace=function(p,d){for(var f=0,m=d.length;f<m;f++)if(u=d[f].getFileName(),u!==__filename)if(e){if(u!==e)return}else return},Error.captureStackTrace(o),o.stack,Error.prepareStackTrace=r,Error.stackTraceLimit=s;var l="file://";return u.indexOf(l)===0&&(u=Qp(u)),u};Ot.getRoot=function(e){for(var r=jp(e),s;;){if(r==="."&&(r=process.cwd()),yl(En(r,"package.json"))||yl(En(r,"node_modules")))return r;if(s===r)throw new Error('Could not find module root given file: "'+e+'". Do you have a `package.json` file? ');s=r,r=En(r,"..")}}});var El=R((o_,Ci)=>{var C=Ci.exports=gl()("addon.node").PQ,Ee=require("assert");Ci.parent||(Sl=require("path"),console.log(Sl.normalize(__dirname+"/src")));var Sl,wl=require("events").EventEmitter,Ee=require("assert");for(Ti in wl.prototype)C.prototype[Ti]=wl.prototype[Ti];var Ti;C.prototype.connectSync=function(t){this.connected=!0,t||(t="");var e=this.$connectSync(t);if(!e){var r=new Error(this.errorMessage());throw this.finish(),r}};C.prototype.connect=function(t,e){this.connected=!0,typeof t=="function"&&(e=t,t=""),t||(t=""),Ee(e,"Must provide a connection callback"),process.domain&&(e=process.domain.bind(e)),this.$connect(t,e)};C.prototype.errorMessage=function(){return this.$getLastErrorMessage()};C.prototype.socket=function(){return this.$socket()};C.prototype.serverVersion=function(){return this.$serverVersion()};C.prototype.finish=function(){this.connected=!1,this.$finish()};C.prototype.exec=function(t){t||(t=""),this.$exec(t)};C.prototype.execParams=function(t,e){t||(t=""),e||(e=[]),Ee(Array.isArray(e),"Parameters must be an array"),this.$execParams(t,e)};C.prototype.prepare=function(t,e,r){Ee.equal(arguments.length,3,"Must supply 3 arguments"),t||(t=""),e||(e=""),r=Number(r)||0,this.$prepare(t,e,r)};C.prototype.execPrepared=function(t,e){t||(t=""),e||(e=[]),Ee(Array.isArray(e),"Parameters must be an array"),this.$execPrepared(t,e)};C.prototype.sendQuery=function(t){return t||(t=""),this.$sendQuery(t)};C.prototype.sendQueryParams=function(t,e){return t||(t=""),e||(e=[]),Ee(Array.isArray(e),"Parameters must be an array"),this.$sendQueryParams(t,e)};C.prototype.sendPrepare=function(t,e,r){return Ee.equal(arguments.length,3,"Must supply 3 arguments"),t||(t=""),e||(e=""),r=Number(r)||0,this.$sendPrepare(t,e,r)};C.prototype.sendQueryPrepared=function(t,e){return t||(t=""),e||(e=[]),Ee(Array.isArray(e),"Parameters must be an array"),this.$sendQueryPrepared(t,e)};C.prototype.getResult=function(){return this.$getResult()};C.prototype.resultStatus=function(){return this.$resultStatus()};C.prototype.resultErrorMessage=function(){return this.$resultErrorMessage()};C.prototype.resultErrorFields=function(){return this.$resultErrorFields()};C.prototype.clear=function(){this.$clear()};C.prototype.ntuples=function(){return this.$ntuples()};C.prototype.nfields=function(){return this.$nfields()};C.prototype.fname=function(t){return this.$fname(t)};C.prototype.ftype=function(t){return this.$ftype(t)};C.prototype.getvalue=function(t,e){return this.$getvalue(t,e)};C.prototype.getisnull=function(t,e){return this.$getisnull(t,e)};C.prototype.cmdStatus=function(){return this.$cmdStatus()};C.prototype.cmdTuples=function(){return this.$cmdTuples()};C.prototype.startReader=function(){Ee(this.connected,"Must be connected to start reader"),this.$startRead()};C.prototype.stopReader=function(){this.$stopRead()};C.prototype.writable=function(t){return Ee(this.connected,"Must be connected to start writer"),this.$startWrite(),this.once("writable",t)};C.prototype.consumeInput=function(){return this.$consumeInput()};C.prototype.isBusy=function(){return this.$isBusy()};C.prototype.setNonBlocking=function(t){return this.$setNonBlocking(t?1:0)};C.prototype.isNonBlocking=function(){return this.$isNonBlocking()};C.prototype.flush=function(){return this.$flush()};C.prototype.escapeLiteral=function(t){return t&&this.$escapeLiteral(t)};C.prototype.escapeIdentifier=function(t){return t&&this.$escapeIdentifier(t)};C.prototype.notifies=function(){return this.$notifies()};C.prototype.putCopyData=function(t){return Ee(t instanceof Buffer),this.$putCopyData(t)};C.prototype.putCopyEnd=function(t){return t?this.$putCopyEnd(t):this.$putCopyEnd()};C.prototype.getCopyData=function(t){return this.$getCopyData(!!t)};C.prototype.cancel=function(){return this.$cancel()}});var Pi=R(Rl=>{"use strict";Rl.parse=function(t,e){return new ot(t,e).parse()};function ot(t,e){this.source=t,this.transform=e||Gp,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}ot.prototype.isEof=function(){return this.position>=this.source.length};ot.prototype.nextCharacter=function(){var t=this.source[this.position++];return t==="\\"?{value:this.source[this.position++],escaped:!0}:{value:t,escaped:!1}};ot.prototype.record=function(t){this.recorded.push(t)};ot.prototype.newEntry=function(t){var e;(this.recorded.length>0||t)&&(e=this.recorded.join(""),e==="NULL"&&!t&&(e=null),e!==null&&(e=this.transform(e)),this.entries.push(e),this.recorded=[])};ot.prototype.parse=function(t){for(var e,r,s;!this.isEof();)if(e=this.nextCharacter(),e.value==="{"&&!s)this.dimension++,this.dimension>1&&(r=new ot(this.source.substr(this.position-1),this.transform),this.entries.push(r.parse(!0)),this.position+=r.position-2);else if(e.value==="}"&&!s){if(this.dimension--,!this.dimension&&(this.newEntry(),t))return this.entries}else e.value==='"'&&!e.escaped?(s&&this.newEntry(!0),s=!s):e.value===","&&!s?this.newEntry():this.record(e.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries};function Gp(t){return t}});var Ai=R((u_,vl)=>{var Yp=Pi();vl.exports={create:function(t,e){return{parse:function(){return Yp.parse(t,e)}}}}});var Il=R((l_,Ol)=>{var Tn=Pi(),Cn=Ai(),vn=As(),Vp=Is(),Cl=Ds();function qi(t){return function(r){return r===null?r:t(r)}}function Pl(t){return t===null?t:t==="TRUE"||t==="t"||t==="true"||t==="y"||t==="yes"||t==="on"||t==="1"}function Kp(t){return t?Tn.parse(t,Pl):null}function Jp(t){return parseInt(t,10)}function Oi(t){return t?Tn.parse(t,qi(Jp)):null}function Zp(t){return t?Tn.parse(t,qi(function(e){return Al(e).trim()})):null}var Xp=function(t){if(!t)return null;var e=Cn.create(t,function(r){return r!==null&&(r=Bi(r)),r});return e.parse()},Ii=function(t){if(!t)return null;var e=Cn.create(t,function(r){return r!==null&&(r=parseFloat(r)),r});return e.parse()},ce=function(t){if(!t)return null;var e=Cn.create(t);return e.parse()},Di=function(t){if(!t)return null;var e=Cn.create(t,function(r){return r!==null&&(r=vn(r)),r});return e.parse()},em=function(t){return t?Tn.parse(t,qi(Cl)):null},xi=function(t){return parseInt(t,10)},Al=function(t){var e=String(t);return/^\d+$/.test(e)?e:t},Tl=function(t){var e=ce(t);return e&&e.map(function(r){return JSON.parse(r)})},Bi=function(t){return t[0]!=="("?null:(t=t.substring(1,t.length-1).split(","),{x:parseFloat(t[0]),y:parseFloat(t[1])})},tm=function(t){if(t[0]!=="<"&&t[1]!=="(")return null;for(var e="(",r="",s=!1,o=2;o<t.length-1;o++){if(s||(e+=t[o]),t[o]===")"){s=!0;continue}else if(!s)continue;t[o]!==","&&(r+=t[o])}var u=Bi(e);return u.radius=parseFloat(r),u},rm=function(t){t(20,Al),t(21,xi),t(23,xi),t(26,xi),t(700,parseFloat),t(701,parseFloat),t(16,Pl),t(1082,vn),t(1114,vn),t(1184,vn),t(600,Bi),t(651,ce),t(718,tm),t(1e3,Kp),t(1001,em),t(1005,Oi),t(1007,Oi),t(1028,Oi),t(1016,Zp),t(1017,Xp),t(1021,Ii),t(1022,Ii),t(1231,Ii),t(1014,ce),t(1015,ce),t(1008,ce),t(1009,ce),t(1040,ce),t(1041,ce),t(1115,Di),t(1182,Di),t(1185,Di),t(1186,Vp),t(17,Cl),t(114,JSON.parse.bind(JSON)),t(3802,JSON.parse.bind(JSON)),t(199,Tl),t(3807,Tl),t(3907,ce),t(2951,ce),t(791,ce),t(1183,ce),t(1270,ce)};Ol.exports={init:rm}});var kl=R((c_,Bl)=>{var nm=Ls(),z=function(t,e,r,s,o){r=r||0,s=s||!1,o=o||function(S,w,I){return S*Math.pow(2,I)+w};var u=r>>3,l=function(S){return s?~S&255:S},p=255,d=8-r%8;e<d&&(p=255<<8-e&255,d=e),r&&(p=p>>r%8);var f=0;r%8+e>=8&&(f=o(0,l(t[u])&p,d));for(var m=e+r>>3,y=u+1;y<m;y++)f=o(f,l(t[y]),8);var g=(e+r)%8;return g>0&&(f=o(f,l(t[m])>>8-g,g)),f},ql=function(t,e,r){var s=Math.pow(2,r-1)-1,o=z(t,1),u=z(t,r,1);if(u===0)return 0;var l=1,p=function(f,m,y){f===0&&(f=1);for(var g=1;g<=y;g++)l/=2,(m&1<<y-g)>0&&(f+=l);return f},d=z(t,e,r+1,!1,p);return u==Math.pow(2,r+1)-1?d===0?o===0?1/0:-1/0:NaN:(o===0?1:-1)*Math.pow(2,u-s)*d},sm=function(t){return z(t,1)==1?-1*(z(t,15,1,!0)+1):z(t,15,1)},Dl=function(t){return z(t,1)==1?-1*(z(t,31,1,!0)+1):z(t,31,1)},im=function(t){return ql(t,23,8)},om=function(t){return ql(t,52,11)},am=function(t){var e=z(t,16,32);if(e==49152)return NaN;for(var r=Math.pow(1e4,z(t,16,16)),s=0,o=[],u=z(t,16),l=0;l<u;l++)s+=z(t,16,64+16*l)*r,r/=1e4;var p=Math.pow(10,z(t,16,48));return(e===0?1:-1)*Math.round(s*p)/p},xl=function(t,e){var r=z(e,1),s=z(e,63,1),o=new Date((r===0?1:-1)*s/1e3+9466848e5);return t||o.setTime(o.getTime()+o.getTimezoneOffset()*6e4),o.usec=s%1e3,o.getMicroSeconds=function(){return this.usec},o.setMicroSeconds=function(u){this.usec=u},o.getUTCMicroSeconds=function(){return this.usec},o},fr=function(t){for(var e=z(t,32),r=z(t,32,32),s=z(t,32,64),o=96,u=[],l=0;l<e;l++)u[l]=z(t,32,o),o+=32,o+=32;var p=function(f){var m=z(t,32,o);if(o+=32,m==4294967295)return null;var y;if(f==23||f==20)return y=z(t,m*8,o),o+=m*8,y;if(f==25)return y=t.toString(this.encoding,o>>3,(o+=m<<3)>>3),y;console.log("ERROR: ElementType not implemented: "+f)},d=function(f,m){var y=[],g;if(f.length>1){var S=f.shift();for(g=0;g<S;g++)y[g]=d(f,m);f.unshift(S)}else for(g=0;g<f[0];g++)y[g]=p(m);return y};return d(u,s)},um=function(t){return t.toString("utf8")},lm=function(t){return t===null?null:z(t,8)>0},cm=function(t){t(20,nm),t(21,sm),t(23,Dl),t(26,Dl),t(1700,am),t(700,im),t(701,om),t(16,lm),t(1114,xl.bind(null,!1)),t(1184,xl.bind(null,!0)),t(1e3,fr),t(1007,fr),t(1016,fr),t(1008,fr),t(1009,fr),t(25,um)};Bl.exports={init:cm}});var Ll=R(Pn=>{var fm=Il(),dm=kl(),hm=Ai();Pn.getTypeParser=pm;Pn.setTypeParser=mm;Pn.arrayParser=hm;var dr={text:{},binary:{}};function Ml(t){return String(t)}function pm(t,e){return e=e||"text",dr[e]&&dr[e][t]||Ml}function mm(t,e,r){typeof e=="function"&&(r=e,e="text"),dr[e][t]=r}fm.init(function(t,e){dr.text[t]=e});dm.init(function(t,e){dr.binary[t]=e})});var Nl=R((d_,Fl)=>{"use strict";var ki=class{constructor(e,r){this._types=e,this._arrayMode=r,this.command=void 0,this.rowCount=void 0,this.fields=[],this.rows=[]}consumeCommand(e){this.command=e.cmdStatus().split(" ")[0],this.rowCount=parseInt(e.cmdTuples(),10)}consumeFields(e){let r=e.nfields();for(var s=0;s<r;s++)this.fields.push({name:e.fname(s),dataTypeID:e.ftype(s)})}consumeRows(e){let r=e.ntuples();for(var s=0;s<r;s++){let o=this._arrayMode?this.consumeRowAsArray(e,s):this.consumeRowAsObject(e,s);this.rows.push(o)}}consumeRowAsObject(e,r){let s={};for(var o=0;o<this.fields.length;o++){let u=this.readValue(e,r,o);s[this.fields[o].name]=u}return s}consumeRowAsArray(e,r){let s=[];for(var o=0;o<this.fields.length;o++){let u=this.readValue(e,r,o);s.push(u)}return s}readValue(e,r,s){var o=e.getvalue(r,s);if(o===""&&e.getisnull(r,s))return null;let u=this.fields[s].dataTypeID;return this._types.getTypeParser(u)(o)}};function ym(t,e,r){let s=new ki(e,r);return s.consumeCommand(t),s.consumeFields(t),s.consumeRows(t),s}Fl.exports=ym});var Ul=R((h_,$l)=>{var Wl=require("stream").Duplex,_m=require("stream").Writable,bm=require("util"),hr=$l.exports=function(t,e){Wl.call(this,e),this.pq=t,this._reading=!1};bm.inherits(hr,Wl);hr.prototype._write=function(t,e,r){var s=this.pq.putCopyData(t);if(s===1)return r();if(s===-1)return r(new Error(this.pq.errorMessage()));var o=this;this.pq.writable(function(){o._write(t,e,r)})};hr.prototype.end=function(){var t=Array.prototype.slice.call(arguments,0),e=this,r=t.pop();t.length&&this.write(t[0]);var s=this.pq.putCopyEnd();if(s===1)return gm(this.pq,function(u,l){_m.prototype.end.call(e),r&&r(u)});if(s===-1){var o=new Error(this.pq.errorMessage());return this.emit("error",o)}return this.pq.writable(function(){return e.end.apply(e,r)})};hr.prototype._consumeBuffer=function(t){var e=this.pq.getCopyData(!0);if(e instanceof Buffer)return setImmediate(function(){t(null,e)});if(e===-1)return t(null,null);if(e===0){var r=this;return this.pq.once("readable",function(){r.pq.stopReader(),r.pq.consumeInput(),r._consumeBuffer(t)}),this.pq.startReader()}t(new Error("Unrecognized read status: "+e))};hr.prototype._read=function(t){if(!this._reading){this._reading=!0;var e=this;this._consumeBuffer(function(r,s){if(e._reading=!1,r)return e.emit("error",r);s!==!1&&e.push(s)})}};var gm=function(t,e){var r=function(){t.removeListener("readable",o),t.stopReader()},s=function(u){return r(),e(new Error(u||t.errorMessage()))},o=function(){if(!t.consumeInput())return s();if(!t.isBusy())return t.getResult(),t.getResult()&&t.resultStatus()!=="PGRES_COPY_OUT"?s("Only one result at a time is accepted"):t.resultStatus()==="PGRES_FATAL_ERROR"?s():(r(),e(null))};t.on("readable",o),t.startReader()}});var zl=R((p_,Sm)=>{Sm.exports={name:"pg-native",version:"3.0.1",description:"A slightly nicer interface to Postgres over node-libpq",main:"index.js",scripts:{test:"mocha && eslint ."},repository:{type:"git",url:"git://github.com/brianc/node-pg-native.git"},keywords:["postgres","pg","libpq"],author:"Brian M. Carlson",license:"MIT",bugs:{url:"https://github.com/brianc/node-pg-native/issues"},homepage:"https://github.com/brianc/node-pg-native",dependencies:{libpq:"^1.8.10","pg-types":"^1.12.1","readable-stream":"1.0.31"},devDependencies:{async:"^0.9.0","concat-stream":"^1.4.6",eslint:"4.2.0","eslint-config-standard":"10.2.1","eslint-plugin-import":"2.7.0","eslint-plugin-node":"5.1.0","eslint-plugin-promise":"3.5.0","eslint-plugin-standard":"3.0.1","generic-pool":"^2.1.1",lodash:"^2.4.1",mocha:"3.4.2",okay:"^0.3.0",pg:"*",semver:"^4.1.0"},prettier:{printWidth:200}}});var jl=R((m_,Fi)=>{var wm=El(),Ql=require("events").EventEmitter,Em=require("util"),Rm=require("assert"),vm=Ll(),Mi=Nl(),Tm=Ul(),L=Fi.exports=function(t){if(!(this instanceof L))return new L(t);t=t||{},Ql.call(this),this.pq=new wm,this._reading=!1,this._read=this._read.bind(this),this._types=t.types||vm,this.arrayMode=t.arrayMode||!1,this._resultCount=0,this._rows=void 0,this._results=void 0,this.on("newListener",e=>{e==="notification"&&this._startReading()}),this.on("result",this._onResult.bind(this)),this.on("readyForQuery",this._onReadyForQuery.bind(this))};Em.inherits(L,Ql);L.prototype.connect=function(t,e){this.pq.connect(t,e)};L.prototype.connectSync=function(t){this.pq.connectSync(t)};L.prototype.query=function(t,e,r){var s;typeof e=="function"&&(r=e),Array.isArray(e)&&e.length>0?s=function(){return o.pq.sendQueryParams(t,e)}:s=function(){return o.pq.sendQuery(t)};var o=this;o._dispatchQuery(o.pq,s,function(u){if(u)return r(u);o._awaitResult(r)})};L.prototype.prepare=function(t,e,r,s){var o=this,u=function(){return o.pq.sendPrepare(t,e,r)};o._dispatchQuery(o.pq,u,function(l){if(l)return s(l);o._awaitResult(s)})};L.prototype.execute=function(t,e,r){var s=this,o=function(){return s.pq.sendQueryPrepared(t,e)};s._dispatchQuery(s.pq,o,function(u,l){if(u)return r(u);s._awaitResult(r)})};L.prototype.getCopyStream=function(){return this.pq.setNonBlocking(!0),this._stopReading(),new Tm(this.pq)};L.prototype.cancel=function(t){Rm(t,"Callback is required");var e=this.pq.cancel();return setImmediate(function(){t(e===!0?void 0:new Error(e))})};L.prototype.querySync=function(t,e){return e?this.pq.execParams(t,e):this.pq.exec(t),Li(this.pq),Mi(this.pq,this._types,this.arrayMode).rows};L.prototype.prepareSync=function(t,e,r){this.pq.prepare(t,e,r),Li(this.pq)};L.prototype.executeSync=function(t,e){return this.pq.execPrepared(t,e),Li(this.pq),Mi(this.pq,this._types,this.arrayMode).rows};L.prototype.escapeLiteral=function(t){return this.pq.escapeLiteral(t)};L.prototype.escapeIdentifier=function(t){return this.pq.escapeIdentifier(t)};Fi.exports.version=zl().version;L.prototype.end=function(t){this._stopReading(),this.pq.finish(),t&&setImmediate(t)};L.prototype._readError=function(t){var e=new Error(t||this.pq.errorMessage());this.emit("error",e)};L.prototype._stopReading=function(){this._reading&&(this._reading=!1,this.pq.stopReader(),this.pq.removeListener("readable",this._read))};L.prototype._consumeQueryResults=function(t){return Mi(t,this._types,this.arrayMode)};L.prototype._emitResult=function(t){var e=t.resultStatus();switch(e){case"PGRES_FATAL_ERROR":this._queryError=new Error(this.pq.resultErrorMessage());break;case"PGRES_TUPLES_OK":case"PGRES_COMMAND_OK":case"PGRES_EMPTY_QUERY":let r=this._consumeQueryResults(this.pq);this.emit("result",r);break;case"PGRES_COPY_OUT":case"PGRES_COPY_BOTH":break;default:this._readError("unrecognized command status: "+e);break}return e};L.prototype._read=function(){var t=this.pq;if(!t.consumeInput())return this._readError();if(!t.isBusy()){for(;t.getResult();){let r=this._emitResult(this.pq);if(r==="PGRES_COPY_BOTH"||r==="PGRES_COPY_OUT")break;if(t.isBusy())return}this.emit("readyForQuery");for(var e=this.pq.notifies();e;)this.emit("notification",e),e=this.pq.notifies()}};L.prototype._startReading=function(){this._reading||(this._reading=!0,this.pq.on("readable",this._read),this.pq.startReader())};var Li=function(t){var e=t.resultErrorMessage()||t.errorMessage();if(e)throw new Error(e)};L.prototype._awaitResult=function(t){return this._queryCallback=t,this._startReading()};L.prototype._waitForDrain=function(t,e){var r=t.flush();if(r===0)return e();if(r===-1)return e(t.errorMessage());var s=this;return t.writable(function(){s._waitForDrain(t,e)})};L.prototype._dispatchQuery=function(t,e,r){this._stopReading();var s=t.setNonBlocking(!0);if(!s)return r(new Error("Unable to set non-blocking to true"));var o=e();if(!o)return r(new Error(t.errorMessage()||"Something went wrong dispatching the query"));this._waitForDrain(t,r)};L.prototype._onResult=function(t){this._resultCount===0?(this._results=t,this._rows=t.rows):this._resultCount===1?(this._results=[this._results,t],this._rows=[this._rows,t.rows]):(this._results.push(t),this._rows.push(t.rows)),this._resultCount++};L.prototype._onReadyForQuery=function(){let t=this._queryCallback;this._queryCallback=void 0;let e=this._queryError;this._queryError=void 0;let r=this._rows;this._rows=void 0;let s=this._results;this._results=void 0,this._resultCount=0,t&&t(e,r||[],s)}});var Yl=R((y_,Gl)=>{"use strict";var Hl=require("events").EventEmitter,Cm=require("util"),Ni=un(),It=Gl.exports=function(t,e,r){Hl.call(this),t=Ni.normalizeQueryConfig(t,e,r),this.text=t.text,this.values=t.values,this.name=t.name,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(s){s==="row"&&(this._emitRowEvents=!0)}.bind(this))};Cm.inherits(It,Hl);var Pm={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};It.prototype.handleError=function(t){var e=this.native.pq.resultErrorFields();if(e)for(var r in e){var s=Pm[r]||r;t[s]=e[r]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};It.prototype.then=function(t,e){return this._getPromise().then(t,e)};It.prototype.catch=function(t){return this._getPromise().catch(t)};It.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};It.prototype.submit=function(t){this.state="running";var e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;var r=function(u,l,p){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),u)return e.handleError(u);e._emitRowEvents&&(p.length>1?l.forEach((d,f)=>{d.forEach(m=>{e.emit("row",m,p[f])})}):l.forEach(function(d){e.emit("row",d,p)})),e.state="end",e.emit("end",p),e.callback&&e.callback(null,p)};if(process.domain&&(r=process.domain.bind(r)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var s=(this.values||[]).map(Ni.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let u=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return r(u)}return t.native.execute(this.name,s,r)}return t.native.prepare(this.name,this.text,s.length,function(u){return u?r(u):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,s,r))})}else if(this.values){if(!Array.isArray(this.values)){let u=new Error("Query values must be an array");return r(u)}var o=this.values.map(Ni.prepareValue);t.native.query(this.text,o,r)}else t.native.query(this.text,r)}});var Zl=R((__,Jl)=>{"use strict";var Am=jl(),Om=zs(),Vl=require("events").EventEmitter,Im=require("util"),Dm=Gs(),Kl=Yl(),ie=Jl.exports=function(t){Vl.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new Om(t.types),this.native=new Am({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var e=this.connectionParameters=new Dm(t);this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};ie.Query=Kl;Im.inherits(ie,Vl);ie.prototype._errorAllQueries=function(t){let e=r=>{process.nextTick(()=>{r.native=this.native,r.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};ie.prototype._connect=function(t){var e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(r,s){if(r)return t(r);e.native.connect(s,function(o){if(o)return e.native.end(),t(o);e._connected=!0,e.native.on("error",function(u){e._queryable=!1,e._errorAllQueries(u),e.emit("error",u)}),e.native.on("notification",function(u){e.emit("notification",{channel:u.relname,payload:u.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};ie.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,r)=>{this._connect(s=>{s?r(s):e()})})};ie.prototype.query=function(t,e,r){var s,o,u,l,p;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")u=t.query_timeout||this.connectionParameters.query_timeout,o=s=t,typeof e=="function"&&(t.callback=e);else if(u=this.connectionParameters.query_timeout,s=new Kl(t,e,r),!s.callback){let d,f;o=new this._Promise((m,y)=>{d=m,f=y}),s.callback=(m,y)=>m?f(m):d(y)}return u&&(p=s.callback,l=setTimeout(()=>{var d=new Error("Query read timeout");process.nextTick(()=>{s.handleError(d,this.connection)}),p(d),s.callback=()=>{};var f=this._queryQueue.indexOf(s);f>-1&&this._queryQueue.splice(f,1),this._pulseQueryQueue()},u),s.callback=(d,f)=>{clearTimeout(l),p(d,f)}),this._queryable?this._ending?(s.native=this.native,process.nextTick(()=>{s.handleError(new Error("Client was closed and is not queryable"))}),o):(this._queryQueue.push(s),this._pulseQueryQueue(),o):(s.native=this.native,process.nextTick(()=>{s.handleError(new Error("Client has encountered a connection error and is not queryable"))}),o)};ie.prototype.end=function(t){var e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));var r;return t||(r=new this._Promise(function(s,o){t=u=>u?o(u):s()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),r};ie.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};ie.prototype._pulseQueryQueue=function(t){if(this._connected&&!this._hasActiveQuery()){var e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);var r=this;e.once("_done",function(){r._pulseQueryQueue()})}};ie.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};ie.prototype.ref=function(){};ie.prototype.unref=function(){};ie.prototype.setTypeParser=function(t,e,r){return this._types.setTypeParser(t,e,r)};ie.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var Wi=R((b_,Xl)=>{"use strict";Xl.exports=Zl()});var Ri=R((S_,pr)=>{"use strict";var xm=ll(),qm=lr(),Bm=gi(),km=hl(),{DatabaseError:Mm}=_i(),Lm=t=>class extends km{constructor(r){super(r,t)}},$i=function(t){this.defaults=qm,this.Client=t,this.Query=this.Client.Query,this.Pool=Lm(this.Client),this._pools=[],this.Connection=Bm,this.types=ur(),this.DatabaseError=Mm};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?pr.exports=new $i(Wi()):(pr.exports=new $i(xm),Object.defineProperty(pr.exports,"native",{configurable:!0,enumerable:!1,get(){var t=null;try{t=new $i(Wi())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(pr.exports,"native",{value:t}),t}}))});var ec=R((w_,On)=>{"use strict";var{inherits:Fm,format:An}=require("util");function Ui(t,e,r=500,s=Error){if(!t)throw new Error("Fastify error code must not be empty");if(!e)throw new Error("Fastify error message must not be empty");t=t.toUpperCase();function o(u,l,p){if(!new.target)return new o(...arguments);switch(Error.captureStackTrace(this,o),this.name="FastifyError",this.code=t,arguments.length){case 3:this.message=An(e,u,l,p);break;case 2:this.message=An(e,u,l);break;case 1:this.message=An(e,u);break;case 0:this.message=e;break;default:this.message=An(e,...arguments)}this.statusCode=r||void 0}return o.prototype[Symbol.toStringTag]="Error",o.prototype.toString=function(){return`${this.name} [${this.code}]: ${this.message}`},Fm(o,s),o}On.exports=Ui;On.exports.default=Ui;On.exports.createError=Ui});var In=Se(ha(),1);var Ha=Se(require("node:http"),1),Ga=Se(require("node:https"),1),it=Se(require("node:zlib"),1),le=Se(require("node:stream"),1),er=require("node:buffer");function Yf(t){if(!/^data:/i.test(t))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');t=t.replace(/\r?\n/g,"");let e=t.indexOf(",");if(e===-1||e<=4)throw new TypeError("malformed data: URI");let r=t.substring(5,e).split(";"),s="",o=!1,u=r[0]||"text/plain",l=u;for(let m=1;m<r.length;m++)r[m]==="base64"?o=!0:r[m]&&(l+=`;${r[m]}`,r[m].indexOf("charset=")===0&&(s=r[m].substring(8)));!r[0]&&!s.length&&(l+=";charset=US-ASCII",s="US-ASCII");let p=o?"base64":"ascii",d=unescape(t.substring(e+1)),f=Buffer.from(d,p);return f.type=u,f.typeFull=l,f.charset=s,f}var pa=Yf;var he=Se(require("node:stream"),1),qe=require("node:util"),ue=require("node:buffer");Gt();Yr();var xe=class extends Error{constructor(e,r){super(e),Error.captureStackTrace(this,this.constructor),this.type=r}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var re=class extends xe{constructor(e,r,s){super(e,r),s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var Vr=Symbol.toStringTag,ps=t=>typeof t=="object"&&typeof t.append=="function"&&typeof t.delete=="function"&&typeof t.get=="function"&&typeof t.getAll=="function"&&typeof t.has=="function"&&typeof t.set=="function"&&typeof t.sort=="function"&&t[Vr]==="URLSearchParams",Vt=t=>t&&typeof t=="object"&&typeof t.arrayBuffer=="function"&&typeof t.type=="string"&&typeof t.stream=="function"&&typeof t.constructor=="function"&&/^(Blob|File)$/.test(t[Vr]),Ra=t=>typeof t=="object"&&(t[Vr]==="AbortSignal"||t[Vr]==="EventTarget"),va=(t,e)=>{let r=new URL(e).hostname,s=new URL(t).hostname;return r===s||r.endsWith(`.${s}`)},Ta=(t,e)=>{let r=new URL(e).protocol,s=new URL(t).protocol;return r===s};var ld=(0,qe.promisify)(he.default.pipeline),ne=Symbol("Body internals"),Te=class{constructor(e,{size:r=0}={}){let s=null;e===null?e=null:ps(e)?e=ue.Buffer.from(e.toString()):Vt(e)||ue.Buffer.isBuffer(e)||(qe.types.isAnyArrayBuffer(e)?e=ue.Buffer.from(e):ArrayBuffer.isView(e)?e=ue.Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof he.default||(e instanceof nt?(e=Ea(e),s=e.type.split("=")[1]):e=ue.Buffer.from(String(e))));let o=e;ue.Buffer.isBuffer(e)?o=he.default.Readable.from(e):Vt(e)&&(o=he.default.Readable.from(e.stream())),this[ne]={body:e,stream:o,boundary:s,disturbed:!1,error:null},this.size=r,e instanceof he.default&&e.on("error",u=>{let l=u instanceof xe?u:new re(`Invalid response body while trying to fetch ${this.url}: ${u.message}`,"system",u);this[ne].error=l})}get body(){return this[ne].stream}get bodyUsed(){return this[ne].disturbed}async arrayBuffer(){let{buffer:e,byteOffset:r,byteLength:s}=await _s(this);return e.slice(r,r+s)}async formData(){let e=this.headers.get("content-type");if(e.startsWith("application/x-www-form-urlencoded")){let s=new nt,o=new URLSearchParams(await this.text());for(let[u,l]of o)s.append(u,l);return s}let{toFormData:r}=await Promise.resolve().then(()=>(Da(),Ia));return r(this.body,e)}async blob(){let e=this.headers&&this.headers.get("content-type")||this[ne].body&&this[ne].body.type||"",r=await this.arrayBuffer();return new De([r],{type:e})}async json(){let e=await this.text();return JSON.parse(e)}async text(){let e=await _s(this);return new TextDecoder().decode(e)}buffer(){return _s(this)}};Te.prototype.buffer=(0,qe.deprecate)(Te.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(Te.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,qe.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function _s(t){if(t[ne].disturbed)throw new TypeError(`body used already for: ${t.url}`);if(t[ne].disturbed=!0,t[ne].error)throw t[ne].error;let{body:e}=t;if(e===null)return ue.Buffer.alloc(0);if(!(e instanceof he.default))return ue.Buffer.alloc(0);let r=[],s=0;try{for await(let o of e){if(t.size>0&&s+o.length>t.size){let u=new re(`content size at ${t.url} over limit: ${t.size}`,"max-size");throw e.destroy(u),u}s+=o.length,r.push(o)}}catch(o){throw o instanceof xe?o:new re(`Invalid response body while trying to fetch ${t.url}: ${o.message}`,"system",o)}if(e.readableEnded===!0||e._readableState.ended===!0)try{return r.every(o=>typeof o=="string")?ue.Buffer.from(r.join("")):ue.Buffer.concat(r,s)}catch(o){throw new re(`Could not create Buffer from response body for ${t.url}: ${o.message}`,"system",o)}else throw new re(`Premature close of server response while trying to fetch ${t.url}`)}var St=(t,e)=>{let r,s,{body:o}=t[ne];if(t.bodyUsed)throw new Error("cannot clone body after it is used");return o instanceof he.default&&typeof o.getBoundary!="function"&&(r=new he.PassThrough({highWaterMark:e}),s=new he.PassThrough({highWaterMark:e}),o.pipe(r),o.pipe(s),t[ne].stream=r,o=s),o},cd=(0,qe.deprecate)(t=>t.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),Xr=(t,e)=>t===null?null:typeof t=="string"?"text/plain;charset=UTF-8":ps(t)?"application/x-www-form-urlencoded;charset=UTF-8":Vt(t)?t.type||null:ue.Buffer.isBuffer(t)||qe.types.isAnyArrayBuffer(t)||ArrayBuffer.isView(t)?null:t instanceof nt?`multipart/form-data; boundary=${e[ne].boundary}`:t&&typeof t.getBoundary=="function"?`multipart/form-data;boundary=${cd(t)}`:t instanceof he.default?null:"text/plain;charset=UTF-8",xa=t=>{let{body:e}=t[ne];return e===null?0:Vt(e)?e.size:ue.Buffer.isBuffer(e)?e.length:e&&typeof e.getLengthSync=="function"&&e.hasKnownLength&&e.hasKnownLength()?e.getLengthSync():null},qa=async(t,{body:e})=>{e===null?t.end():await ld(e,t)};var bs=require("node:util"),Zt=Se(require("node:http"),1),en=typeof Zt.default.validateHeaderName=="function"?Zt.default.validateHeaderName:t=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(t)){let e=new TypeError(`Header name must be a valid HTTP token [${t}]`);throw Object.defineProperty(e,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),e}},gs=typeof Zt.default.validateHeaderValue=="function"?Zt.default.validateHeaderValue:(t,e)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(e)){let r=new TypeError(`Invalid character in header content ["${t}"]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_CHAR"}),r}},Z=class extends URLSearchParams{constructor(e){let r=[];if(e instanceof Z){let s=e.raw();for(let[o,u]of Object.entries(s))r.push(...u.map(l=>[o,l]))}else if(e!=null)if(typeof e=="object"&&!bs.types.isBoxedPrimitive(e)){let s=e[Symbol.iterator];if(s==null)r.push(...Object.entries(e));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");r=[...e].map(o=>{if(typeof o!="object"||bs.types.isBoxedPrimitive(o))throw new TypeError("Each header pair must be an iterable object");return[...o]}).map(o=>{if(o.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...o]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return r=r.length>0?r.map(([s,o])=>(en(s),gs(s,String(o)),[String(s).toLowerCase(),String(o)])):void 0,super(r),new Proxy(this,{get(s,o,u){switch(o){case"append":case"set":return(l,p)=>(en(l),gs(l,String(p)),URLSearchParams.prototype[o].call(s,String(l).toLowerCase(),String(p)));case"delete":case"has":case"getAll":return l=>(en(l),URLSearchParams.prototype[o].call(s,String(l).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,o,u)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(e){let r=this.getAll(e);if(r.length===0)return null;let s=r.join(", ");return/^content-encoding$/i.test(e)&&(s=s.toLowerCase()),s}forEach(e,r=void 0){for(let s of this.keys())Reflect.apply(e,r,[this.get(s),s,this])}*values(){for(let e of this.keys())yield this.get(e)}*entries(){for(let e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((e,r)=>(e[r]=this.getAll(r),e),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((e,r)=>{let s=this.getAll(r);return r==="host"?e[r]=s[0]:e[r]=s.length>1?s:s[0],e},{})}};Object.defineProperties(Z.prototype,["get","entries","forEach","values"].reduce((t,e)=>(t[e]={enumerable:!0},t),{}));function Ba(t=[]){return new Z(t.reduce((e,r,s,o)=>(s%2===0&&e.push(o.slice(s,s+2)),e),[]).filter(([e,r])=>{try{return en(e),gs(e,String(r)),!0}catch{return!1}}))}var fd=new Set([301,302,303,307,308]),tn=t=>fd.has(t);var we=Symbol("Response internals"),V=class extends Te{constructor(e=null,r={}){super(e,r);let s=r.status!=null?r.status:200,o=new Z(r.headers);if(e!==null&&!o.has("Content-Type")){let u=Xr(e,this);u&&o.append("Content-Type",u)}this[we]={type:"default",url:r.url,status:s,statusText:r.statusText||"",headers:o,counter:r.counter,highWaterMark:r.highWaterMark}}get type(){return this[we].type}get url(){return this[we].url||""}get status(){return this[we].status}get ok(){return this[we].status>=200&&this[we].status<300}get redirected(){return this[we].counter>0}get statusText(){return this[we].statusText}get headers(){return this[we].headers}get highWaterMark(){return this[we].highWaterMark}clone(){return new V(St(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(e,r=302){if(!tn(r))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new V(null,{headers:{location:new URL(e).toString()},status:r})}static error(){let e=new V(null,{status:0,statusText:""});return e[we].type="error",e}static json(e=void 0,r={}){let s=JSON.stringify(e);if(s===void 0)throw new TypeError("data is not JSON serializable");let o=new Z(r&&r.headers);return o.has("content-type")||o.set("content-type","application/json"),new V(s,{...r,headers:o})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(V.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var za=require("node:url"),Qa=require("node:util");var ka=t=>{if(t.search)return t.search;let e=t.href.length-1,r=t.hash||(t.href[e]==="#"?"#":"");return t.href[e-r.length]==="?"?"?":""};var La=require("node:net");function Ma(t,e=!1){return t==null||(t=new URL(t),/^(about|blob|data):$/.test(t.protocol))?"no-referrer":(t.username="",t.password="",t.hash="",e&&(t.pathname="",t.search=""),t)}var Fa=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Na="strict-origin-when-cross-origin";function Wa(t){if(!Fa.has(t))throw new TypeError(`Invalid referrerPolicy: ${t}`);return t}function dd(t){if(/^(http|ws)s:$/.test(t.protocol))return!0;let e=t.host.replace(/(^\[)|(]$)/g,""),r=(0,La.isIP)(e);return r===4&&/^127\./.test(e)||r===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(e)?!0:t.host==="localhost"||t.host.endsWith(".localhost")?!1:t.protocol==="file:"}function wt(t){return/^about:(blank|srcdoc)$/.test(t)||t.protocol==="data:"||/^(blob|filesystem):$/.test(t.protocol)?!0:dd(t)}function $a(t,{referrerURLCallback:e,referrerOriginCallback:r}={}){if(t.referrer==="no-referrer"||t.referrerPolicy==="")return null;let s=t.referrerPolicy;if(t.referrer==="about:client")return"no-referrer";let o=t.referrer,u=Ma(o),l=Ma(o,!0);u.toString().length>4096&&(u=l),e&&(u=e(u)),r&&(l=r(l));let p=new URL(t.url);switch(s){case"no-referrer":return"no-referrer";case"origin":return l;case"unsafe-url":return u;case"strict-origin":return wt(u)&&!wt(p)?"no-referrer":l.toString();case"strict-origin-when-cross-origin":return u.origin===p.origin?u:wt(u)&&!wt(p)?"no-referrer":l;case"same-origin":return u.origin===p.origin?u:"no-referrer";case"origin-when-cross-origin":return u.origin===p.origin?u:l;case"no-referrer-when-downgrade":return wt(u)&&!wt(p)?"no-referrer":u;default:throw new TypeError(`Invalid referrerPolicy: ${s}`)}}function Ua(t){let e=(t.get("referrer-policy")||"").split(/[,\s]+/),r="";for(let s of e)s&&Fa.has(s)&&(r=s);return r}var G=Symbol("Request internals"),Xt=t=>typeof t=="object"&&typeof t[G]=="object",hd=(0,Qa.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),Be=class extends Te{constructor(e,r={}){let s;if(Xt(e)?s=new URL(e.url):(s=new URL(e),e={}),s.username!==""||s.password!=="")throw new TypeError(`${s} is an url with embedded credentials.`);let o=r.method||e.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(o)&&(o=o.toUpperCase()),!Xt(r)&&"data"in r&&hd(),(r.body!=null||Xt(e)&&e.body!==null)&&(o==="GET"||o==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let u=r.body?r.body:Xt(e)&&e.body!==null?St(e):null;super(u,{size:r.size||e.size||0});let l=new Z(r.headers||e.headers||{});if(u!==null&&!l.has("Content-Type")){let f=Xr(u,this);f&&l.set("Content-Type",f)}let p=Xt(e)?e.signal:null;if("signal"in r&&(p=r.signal),p!=null&&!Ra(p))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let d=r.referrer==null?e.referrer:r.referrer;if(d==="")d="no-referrer";else if(d){let f=new URL(d);d=/^about:(\/\/)?client$/.test(f)?"client":f}else d=void 0;this[G]={method:o,redirect:r.redirect||e.redirect||"follow",headers:l,parsedURL:s,signal:p,referrer:d},this.follow=r.follow===void 0?e.follow===void 0?20:e.follow:r.follow,this.compress=r.compress===void 0?e.compress===void 0?!0:e.compress:r.compress,this.counter=r.counter||e.counter||0,this.agent=r.agent||e.agent,this.highWaterMark=r.highWaterMark||e.highWaterMark||16384,this.insecureHTTPParser=r.insecureHTTPParser||e.insecureHTTPParser||!1,this.referrerPolicy=r.referrerPolicy||e.referrerPolicy||""}get method(){return this[G].method}get url(){return(0,za.format)(this[G].parsedURL)}get headers(){return this[G].headers}get redirect(){return this[G].redirect}get signal(){return this[G].signal}get referrer(){if(this[G].referrer==="no-referrer")return"";if(this[G].referrer==="client")return"about:client";if(this[G].referrer)return this[G].referrer.toString()}get referrerPolicy(){return this[G].referrerPolicy}set referrerPolicy(e){this[G].referrerPolicy=Wa(e)}clone(){return new Be(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Be.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var ja=t=>{let{parsedURL:e}=t[G],r=new Z(t[G].headers);r.has("Accept")||r.set("Accept","*/*");let s=null;if(t.body===null&&/^(post|put)$/i.test(t.method)&&(s="0"),t.body!==null){let p=xa(t);typeof p=="number"&&!Number.isNaN(p)&&(s=String(p))}s&&r.set("Content-Length",s),t.referrerPolicy===""&&(t.referrerPolicy=Na),t.referrer&&t.referrer!=="no-referrer"?t[G].referrer=$a(t):t[G].referrer="no-referrer",t[G].referrer instanceof URL&&r.set("Referer",t.referrer),r.has("User-Agent")||r.set("User-Agent","node-fetch"),t.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip, deflate, br");let{agent:o}=t;typeof o=="function"&&(o=o(e)),!r.has("Connection")&&!o&&r.set("Connection","close");let u=ka(e),l={path:e.pathname+u,method:t.method,headers:r[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:t.insecureHTTPParser,agent:o};return{parsedURL:e,options:l}};var rn=class extends xe{constructor(e,r="aborted"){super(e,r)}};Yr();ms();var pd=new Set(["data:","http:","https:"]);async function tr(t,e){return new Promise((r,s)=>{let o=new Be(t,e),{parsedURL:u,options:l}=ja(o);if(!pd.has(u.protocol))throw new TypeError(`node-fetch cannot load ${t}. URL scheme "${u.protocol.replace(/:$/,"")}" is not supported.`);if(u.protocol==="data:"){let w=pa(o.url),I=new V(w,{headers:{"Content-Type":w.typeFull}});r(I);return}let p=(u.protocol==="https:"?Ga.default:Ha.default).request,{signal:d}=o,f=null,m=()=>{let w=new rn("The operation was aborted.");s(w),o.body&&o.body instanceof le.default.Readable&&o.body.destroy(w),!(!f||!f.body)&&f.body.emit("error",w)};if(d&&d.aborted){m();return}let y=()=>{m(),S()},g=p(u.toString(),l);d&&d.addEventListener("abort",y);let S=()=>{g.abort(),d&&d.removeEventListener("abort",y)};g.on("error",w=>{s(new re(`request to ${o.url} failed, reason: ${w.message}`,"system",w)),S()}),md(g,w=>{f&&f.body&&f.body.destroy(w)}),process.version<"v14"&&g.on("socket",w=>{let I;w.prependListener("end",()=>{I=w._eventsCount}),w.prependListener("close",D=>{if(f&&I<w._eventsCount&&!D){let k=new Error("Premature close");k.code="ERR_STREAM_PREMATURE_CLOSE",f.body.emit("error",k)}})}),g.on("response",w=>{g.setTimeout(0);let I=Ba(w.rawHeaders);if(tn(w.statusCode)){let x=I.get("Location"),j=null;try{j=x===null?null:new URL(x,o.url)}catch{if(o.redirect!=="manual"){s(new re(`uri requested responds with an invalid redirect URL: ${x}`,"invalid-redirect")),S();return}}switch(o.redirect){case"error":s(new re(`uri requested responds with a redirect, redirect mode is set to error: ${o.url}`,"no-redirect")),S();return;case"manual":break;case"follow":{if(j===null)break;if(o.counter>=o.follow){s(new re(`maximum redirect reached at: ${o.url}`,"max-redirect")),S();return}let M={headers:new Z(o.headers),follow:o.follow,counter:o.counter+1,agent:o.agent,compress:o.compress,method:o.method,body:St(o),signal:o.signal,size:o.size,referrer:o.referrer,referrerPolicy:o.referrerPolicy};if(!va(o.url,j)||!Ta(o.url,j))for(let oe of["authorization","www-authenticate","cookie","cookie2"])M.headers.delete(oe);if(w.statusCode!==303&&o.body&&e.body instanceof le.default.Readable){s(new re("Cannot follow redirect with body being a readable stream","unsupported-redirect")),S();return}(w.statusCode===303||(w.statusCode===301||w.statusCode===302)&&o.method==="POST")&&(M.method="GET",M.body=void 0,M.headers.delete("content-length"));let Le=Ua(I);Le&&(M.referrerPolicy=Le),r(tr(new Be(j,M))),S();return}default:return s(new TypeError(`Redirect option '${o.redirect}' is not a valid value of RequestRedirect`))}}d&&w.once("end",()=>{d.removeEventListener("abort",y)});let D=(0,le.pipeline)(w,new le.PassThrough,x=>{x&&s(x)});process.version<"v12.10"&&w.on("aborted",y);let k={url:o.url,status:w.statusCode,statusText:w.statusMessage,headers:I,size:o.size,counter:o.counter,highWaterMark:o.highWaterMark},W=I.get("Content-Encoding");if(!o.compress||o.method==="HEAD"||W===null||w.statusCode===204||w.statusCode===304){f=new V(D,k),r(f);return}let ee={flush:it.default.Z_SYNC_FLUSH,finishFlush:it.default.Z_SYNC_FLUSH};if(W==="gzip"||W==="x-gzip"){D=(0,le.pipeline)(D,it.default.createGunzip(ee),x=>{x&&s(x)}),f=new V(D,k),r(f);return}if(W==="deflate"||W==="x-deflate"){let x=(0,le.pipeline)(w,new le.PassThrough,j=>{j&&s(j)});x.once("data",j=>{(j[0]&15)===8?D=(0,le.pipeline)(D,it.default.createInflate(),M=>{M&&s(M)}):D=(0,le.pipeline)(D,it.default.createInflateRaw(),M=>{M&&s(M)}),f=new V(D,k),r(f)}),x.once("end",()=>{f||(f=new V(D,k),r(f))});return}if(W==="br"){D=(0,le.pipeline)(D,it.default.createBrotliDecompress(),x=>{x&&s(x)}),f=new V(D,k),r(f);return}f=new V(D,k),r(f)}),qa(g,o).catch(s)})}function md(t,e){let r=er.Buffer.from(`0\r
\r
`),s=!1,o=!1,u;t.on("response",l=>{let{headers:p}=l;s=p["transfer-encoding"]==="chunked"&&!p["content-length"]}),t.on("socket",l=>{let p=()=>{if(s&&!o){let f=new Error("Premature close");f.code="ERR_STREAM_PREMATURE_CLOSE",e(f)}},d=f=>{o=er.Buffer.compare(f.slice(-5),r)===0,!o&&u&&(o=er.Buffer.compare(u.slice(-3),r.slice(0,3))===0&&er.Buffer.compare(f.slice(-2),r.slice(3))===0),u=f};l.prependListener("close",p),l.on("data",d),t.on("close",()=>{l.removeListener("close",p),l.removeListener("data",d)})})}var Ya=process.env.NODE_ENV,a0=process.env.K_SERVICE,u0=process.env.PORT,l0=process.env.PROJECT_ENV,c0=process.env.FRONTEND_URL,Va=process.env.PGURI,f0=process.env.REDIS_CONNECTION_STRING,d0=process.env.GOOGLE_BARD_TOKEN,h0=process.env.GOOGLE_BARD_API_KEY,p0=process.env.GOOGLE_API_KEY,m0=process.env.GOOGLE_SEARCH_ENGINE_ID,y0=process.env.NAVER_CLIENT_ID,_0=process.env.NAVER_CLIENT_SECRET,b0=process.env.LOCALHOST_HTTPS_KEY,g0=process.env.LOCALHOST_HTTPS_CERT,Ss=process.env.POSTGRES_CA,ws=process.env.POSTGRES_CERT,Es=process.env.POSTGRES_KEY,S0=process.env.REDIS_CA,w0=process.env.REDIS_CLIENT_KEY,E0=process.env.REDIS_CLIENT_CERT,Rs=process.env.CLOUD_RUN_TASK_INDEX??"0",vs=process.env.CLOUD_RUN_TASK_COUNT??"1",Ka=process.env.LOCAL_EXPENDITURE_DATE,Ja=process.env.LOFIN_KEY,Za=process.env.CEFIN_KEY;var nn={11:"\uC11C\uC6B8",26:"\uBD80\uC0B0",27:"\uB300\uAD6C",28:"\uC778\uCC9C",29:"\uAD11\uC8FC",30:"\uB300\uC804",31:"\uC6B8\uC0B0",32:"\uC138\uC885",41:"\uACBD\uAE30",42:"\uAC15\uC6D0",43:"\uCDA9\uBD81",44:"\uCDA9\uB0A8",45:"\uC804\uBD81",46:"\uC804\uB0A8",47:"\uACBD\uBD81",48:"\uACBD\uB0A8",49:"\uC81C\uC8FC"},v0=Object.keys(nn).map(t=>+t),yd={11e5:"\uC11C\uC6B8\uBCF8\uCCAD",1111e3:"\uC11C\uC6B8\uC885\uB85C\uAD6C",1112e3:"\uC11C\uC6B8\uC911\uAD6C",1113e3:"\uC11C\uC6B8\uC6A9\uC0B0\uAD6C",1114e3:"\uC11C\uC6B8\uC131\uB3D9\uAD6C",1115e3:"\uC11C\uC6B8\uAD11\uC9C4\uAD6C",1116e3:"\uC11C\uC6B8\uB3D9\uB300\uBB38\uAD6C",1117e3:"\uC11C\uC6B8\uC911\uB791\uAD6C",1118e3:"\uC11C\uC6B8\uC131\uBD81\uAD6C",1119e3:"\uC11C\uC6B8\uAC15\uBD81\uAD6C",112e4:"\uC11C\uC6B8\uB3C4\uBD09\uAD6C",1121e3:"\uC11C\uC6B8\uB178\uC6D0\uAD6C",1122e3:"\uC11C\uC6B8\uC740\uD3C9\uAD6C",1123e3:"\uC11C\uC6B8\uC11C\uB300\uBB38\uAD6C",1124e3:"\uC11C\uC6B8\uB9C8\uD3EC\uAD6C",1125e3:"\uC11C\uC6B8\uC591\uCC9C\uAD6C",1126e3:"\uC11C\uC6B8\uAC15\uC11C\uAD6C",1127e3:"\uC11C\uC6B8\uAD6C\uB85C\uAD6C",1128e3:"\uC11C\uC6B8\uAE08\uCC9C\uAD6C",1129e3:"\uC11C\uC6B8\uC601\uB4F1\uD3EC\uAD6C",113e4:"\uC11C\uC6B8\uB3D9\uC791\uAD6C",1131e3:"\uC11C\uC6B8\uAD00\uC545\uAD6C",1132e3:"\uC11C\uC6B8\uC11C\uCD08\uAD6C",1133e3:"\uC11C\uC6B8\uAC15\uB0A8\uAD6C",1134e3:"\uC11C\uC6B8\uC1A1\uD30C\uAD6C",1135e3:"\uC11C\uC6B8\uAC15\uB3D9\uAD6C",26e5:"\uBD80\uC0B0\uBCF8\uCCAD",2611e3:"\uBD80\uC0B0\uC911\uAD6C",2612e3:"\uBD80\uC0B0\uC11C\uAD6C",2613e3:"\uBD80\uC0B0\uB3D9\uAD6C",2614e3:"\uBD80\uC0B0\uC601\uB3C4\uAD6C",2615e3:"\uBD80\uC0B0\uC9C4\uAD6C",2616e3:"\uBD80\uC0B0\uB3D9\uB798\uAD6C",2617e3:"\uBD80\uC0B0\uB0A8\uAD6C",2618e3:"\uBD80\uC0B0\uBD81\uAD6C",2619e3:"\uBD80\uC0B0\uD574\uC6B4\uB300\uAD6C",262e4:"\uBD80\uC0B0\uC0AC\uD558\uAD6C",2621e3:"\uBD80\uC0B0\uAE08\uC815\uAD6C",2622e3:"\uBD80\uC0B0\uAC15\uC11C\uAD6C",2623e3:"\uBD80\uC0B0\uC5F0\uC81C\uAD6C",2624e3:"\uBD80\uC0B0\uC218\uC601\uAD6C",2625e3:"\uBD80\uC0B0\uC0AC\uC0C1\uAD6C",2671e3:"\uBD80\uC0B0\uAE30\uC7A5\uAD70",27e5:"\uB300\uAD6C\uBCF8\uCCAD",2711e3:"\uB300\uAD6C\uC911\uAD6C",2712e3:"\uB300\uAD6C\uB3D9\uAD6C",2713e3:"\uB300\uAD6C\uC11C\uAD6C",2714e3:"\uB300\uAD6C\uB0A8\uAD6C",2715e3:"\uB300\uAD6C\uBD81\uAD6C",2716e3:"\uB300\uAD6C\uC218\uC131\uAD6C",2717e3:"\uB300\uAD6C\uB2EC\uC11C\uAD6C",2771e3:"\uB300\uAD6C\uB2EC\uC131\uAD70",28e5:"\uC778\uCC9C\uBCF8\uCCAD",2811e3:"\uC778\uCC9C\uC911\uAD6C",2812e3:"\uC778\uCC9C\uB3D9\uAD6C",2813e3:"\uC778\uCC9C\uBBF8\uCD94\uD640\uAD6C",2814e3:"\uC778\uCC9C\uC5F0\uC218\uAD6C",2815e3:"\uC778\uCC9C\uB0A8\uB3D9\uAD6C",2816e3:"\uC778\uCC9C\uBD80\uD3C9\uAD6C",2817e3:"\uC778\uCC9C\uACC4\uC591\uAD6C",2818e3:"\uC778\uCC9C\uC11C\uAD6C",2871e3:"\uC778\uCC9C\uAC15\uD654\uAD70",2872e3:"\uC778\uCC9C\uC639\uC9C4\uAD70",29e5:"\uAD11\uC8FC\uBCF8\uCCAD",2911e3:"\uAD11\uC8FC\uB3D9\uAD6C",2912e3:"\uAD11\uC8FC\uC11C\uAD6C",2913e3:"\uAD11\uC8FC\uB0A8\uAD6C",2914e3:"\uAD11\uC8FC\uBD81\uAD6C",2915e3:"\uAD11\uC8FC\uAD11\uC0B0\uAD6C",3e6:"\uB300\uC804\uBCF8\uCCAD",3011e3:"\uB300\uC804\uB3D9\uAD6C",3012e3:"\uB300\uC804\uC911\uAD6C",3013e3:"\uB300\uC804\uC11C\uAD6C",3014e3:"\uB300\uC804\uC720\uC131\uAD6C",3015e3:"\uB300\uC804\uB300\uB355\uAD6C",31e5:"\uC6B8\uC0B0\uBCF8\uCCAD",3111e3:"\uC6B8\uC0B0\uC911\uAD6C",3112e3:"\uC6B8\uC0B0\uB0A8\uAD6C",3113e3:"\uC6B8\uC0B0\uB3D9\uAD6C",3114e3:"\uC6B8\uC0B0\uBD81\uAD6C",3171e3:"\uC6B8\uC0B0\uC6B8\uC8FC\uAD70",32e5:"\uC138\uC885\uBCF8\uCCAD",41e5:"\uACBD\uAE30\uBCF8\uCCAD",4111e3:"\uACBD\uAE30\uC218\uC6D0\uC2DC",4112e3:"\uACBD\uAE30\uC131\uB0A8\uC2DC",4113e3:"\uACBD\uAE30\uC758\uC815\uBD80\uC2DC",4114e3:"\uACBD\uAE30\uC548\uC591\uC2DC",4115e3:"\uACBD\uAE30\uBD80\uCC9C\uC2DC",4116e3:"\uACBD\uAE30\uAD11\uBA85\uC2DC",4117e3:"\uACBD\uAE30\uD3C9\uD0DD\uC2DC",4118e3:"\uACBD\uAE30\uB3D9\uB450\uCC9C\uC2DC",4119e3:"\uACBD\uAE30\uC548\uC0B0\uC2DC",412e4:"\uACBD\uAE30\uACE0\uC591\uC2DC",4121e3:"\uACBD\uAE30\uACFC\uCC9C\uC2DC",4122e3:"\uACBD\uAE30\uAD6C\uB9AC\uC2DC",4123e3:"\uACBD\uAE30\uB0A8\uC591\uC8FC\uC2DC",4124e3:"\uACBD\uAE30\uC624\uC0B0\uC2DC",4125e3:"\uACBD\uAE30\uC2DC\uD765\uC2DC",4126e3:"\uACBD\uAE30\uAD70\uD3EC\uC2DC",4127e3:"\uACBD\uAE30\uC758\uC655\uC2DC",4128e3:"\uACBD\uAE30\uD558\uB0A8\uC2DC",4129e3:"\uACBD\uAE30\uC6A9\uC778\uC2DC",413e4:"\uACBD\uAE30\uD30C\uC8FC\uC2DC",4131e3:"\uACBD\uAE30\uC774\uCC9C\uC2DC",4132e3:"\uACBD\uAE30\uC548\uC131\uC2DC",4133e3:"\uACBD\uAE30\uAE40\uD3EC\uC2DC",4134e3:"\uACBD\uAE30\uD654\uC131\uC2DC",4135e3:"\uACBD\uAE30\uAD11\uC8FC\uC2DC",4136e3:"\uACBD\uAE30\uC591\uC8FC\uC2DC",4137e3:"\uACBD\uAE30\uD3EC\uCC9C\uC2DC",4138e3:"\uACBD\uAE30\uC5EC\uC8FC\uC2DC",4175e3:"\uACBD\uAE30\uC5F0\uCC9C\uAD70",4177e3:"\uACBD\uAE30\uAC00\uD3C9\uAD70",4178e3:"\uACBD\uAE30\uC591\uD3C9\uAD70",42e5:"\uAC15\uC6D0\uBCF8\uCCAD",4211e3:"\uAC15\uC6D0\uCD98\uCC9C\uC2DC",4212e3:"\uAC15\uC6D0\uC6D0\uC8FC\uC2DC",4213e3:"\uAC15\uC6D0\uAC15\uB989\uC2DC",4214e3:"\uAC15\uC6D0\uB3D9\uD574\uC2DC",4215e3:"\uAC15\uC6D0\uD0DC\uBC31\uC2DC",4216e3:"\uAC15\uC6D0\uC18D\uCD08\uC2DC",4217e3:"\uAC15\uC6D0\uC0BC\uCC99\uC2DC",4271e3:"\uAC15\uC6D0\uD64D\uCC9C\uAD70",4272e3:"\uAC15\uC6D0\uD6A1\uC131\uAD70",4273e3:"\uAC15\uC6D0\uC601\uC6D4\uAD70",4274e3:"\uAC15\uC6D0\uD3C9\uCC3D\uAD70",4275e3:"\uAC15\uC6D0\uC815\uC120\uAD70",4276e3:"\uAC15\uC6D0\uCCA0\uC6D0\uAD70",4277e3:"\uAC15\uC6D0\uD654\uCC9C\uAD70",4278e3:"\uAC15\uC6D0\uC591\uAD6C\uAD70",4279e3:"\uAC15\uC6D0\uC778\uC81C\uAD70",428e4:"\uAC15\uC6D0\uACE0\uC131\uAD70",4281e3:"\uAC15\uC6D0\uC591\uC591\uAD70",43e5:"\uCDA9\uBD81\uBCF8\uCCAD",4312e3:"\uCDA9\uBD81\uCDA9\uC8FC\uC2DC",4313e3:"\uCDA9\uBD81\uC81C\uCC9C\uC2DC",4314e3:"\uCDA9\uBD81\uCCAD\uC8FC\uC2DC",4372e3:"\uCDA9\uBD81\uBCF4\uC740\uAD70",4373e3:"\uCDA9\uBD81\uC625\uCC9C\uAD70",4374e3:"\uCDA9\uBD81\uC601\uB3D9\uAD70",4375e3:"\uCDA9\uBD81\uC9C4\uCC9C\uAD70",4376e3:"\uCDA9\uBD81\uAD34\uC0B0\uAD70",4377e3:"\uCDA9\uBD81\uC74C\uC131\uAD70",4378e3:"\uCDA9\uBD81\uB2E8\uC591\uAD70",4379e3:"\uCDA9\uBD81\uC99D\uD3C9\uAD70",44e5:"\uCDA9\uB0A8\uBCF8\uCCAD",4411e3:"\uCDA9\uB0A8\uCC9C\uC548\uC2DC",4412e3:"\uCDA9\uB0A8\uACF5\uC8FC\uC2DC",4413e3:"\uCDA9\uB0A8\uBCF4\uB839\uC2DC",4414e3:"\uCDA9\uB0A8\uC544\uC0B0\uC2DC",4415e3:"\uCDA9\uB0A8\uC11C\uC0B0\uC2DC",4416e3:"\uCDA9\uB0A8\uB17C\uC0B0\uC2DC",4417e3:"\uCDA9\uB0A8\uACC4\uB8E1\uC2DC",4418e3:"\uCDA9\uB0A8\uB2F9\uC9C4\uC2DC",4471e3:"\uCDA9\uB0A8\uAE08\uC0B0\uAD70",4473e3:"\uCDA9\uB0A8\uBD80\uC5EC\uAD70",4474e3:"\uCDA9\uB0A8\uC11C\uCC9C\uAD70",4475e3:"\uCDA9\uB0A8\uCCAD\uC591\uAD70",4476e3:"\uCDA9\uB0A8\uD64D\uC131\uAD70",4477e3:"\uCDA9\uB0A8\uC608\uC0B0\uAD70",4478e3:"\uCDA9\uB0A8\uD0DC\uC548\uAD70",45e5:"\uC804\uBD81\uBCF8\uCCAD",4511e3:"\uC804\uBD81\uC804\uC8FC\uC2DC",4512e3:"\uC804\uBD81\uAD70\uC0B0\uC2DC",4513e3:"\uC804\uBD81\uC775\uC0B0\uC2DC",4514e3:"\uC804\uBD81\uC815\uC74D\uC2DC",4515e3:"\uC804\uBD81\uB0A8\uC6D0\uC2DC",4516e3:"\uC804\uBD81\uAE40\uC81C\uC2DC",4571e3:"\uC804\uBD81\uC644\uC8FC\uAD70",4572e3:"\uC804\uBD81\uC9C4\uC548\uAD70",4573e3:"\uC804\uBD81\uBB34\uC8FC\uAD70",4574e3:"\uC804\uBD81\uC7A5\uC218\uAD70",4575e3:"\uC804\uBD81\uC784\uC2E4\uAD70",4576e3:"\uC804\uBD81\uC21C\uCC3D\uAD70",4577e3:"\uC804\uBD81\uACE0\uCC3D\uAD70",4578e3:"\uC804\uBD81\uBD80\uC548\uAD70",46e5:"\uC804\uB0A8\uBCF8\uCCAD",4611e3:"\uC804\uB0A8\uBAA9\uD3EC\uC2DC",4612e3:"\uC804\uB0A8\uC5EC\uC218\uC2DC",4613e3:"\uC804\uB0A8\uC21C\uCC9C\uC2DC",4614e3:"\uC804\uB0A8\uB098\uC8FC\uC2DC",4615e3:"\uC804\uB0A8\uAD11\uC591\uC2DC",4671e3:"\uC804\uB0A8\uB2F4\uC591\uAD70",4672e3:"\uC804\uB0A8\uACE1\uC131\uAD70",4673e3:"\uC804\uB0A8\uAD6C\uB840\uAD70",4674e3:"\uC804\uB0A8\uACE0\uD765\uAD70",4675e3:"\uC804\uB0A8\uBCF4\uC131\uAD70",4676e3:"\uC804\uB0A8\uD654\uC21C\uAD70",4677e3:"\uC804\uB0A8\uC7A5\uD765\uAD70",4678e3:"\uC804\uB0A8\uAC15\uC9C4\uAD70",4679e3:"\uC804\uB0A8\uD574\uB0A8\uAD70",468e4:"\uC804\uB0A8\uC601\uC554\uAD70",4681e3:"\uC804\uB0A8\uBB34\uC548\uAD70",4682e3:"\uC804\uB0A8\uD568\uD3C9\uAD70",4683e3:"\uC804\uB0A8\uC601\uAD11\uAD70",4684e3:"\uC804\uB0A8\uC7A5\uC131\uAD70",4685e3:"\uC804\uB0A8\uC644\uB3C4\uAD70",4686e3:"\uC804\uB0A8\uC9C4\uB3C4\uAD70",4687e3:"\uC804\uB0A8\uC2E0\uC548\uAD70",47e5:"\uACBD\uBD81\uBCF8\uCCAD",4711e3:"\uACBD\uBD81\uD3EC\uD56D\uC2DC",4712e3:"\uACBD\uBD81\uACBD\uC8FC\uC2DC",4713e3:"\uACBD\uBD81\uAE40\uCC9C\uC2DC",4714e3:"\uACBD\uBD81\uC548\uB3D9\uC2DC",4715e3:"\uACBD\uBD81\uAD6C\uBBF8\uC2DC",4716e3:"\uACBD\uBD81\uC601\uC8FC\uC2DC",4717e3:"\uACBD\uBD81\uC601\uCC9C\uC2DC",4718e3:"\uACBD\uBD81\uC0C1\uC8FC\uC2DC",4719e3:"\uACBD\uBD81\uBB38\uACBD\uC2DC",472e4:"\uACBD\uBD81\uACBD\uC0B0\uC2DC",4771e3:"\uACBD\uBD81\uAD70\uC704\uAD70",4772e3:"\uACBD\uBD81\uC758\uC131\uAD70",4773e3:"\uACBD\uBD81\uCCAD\uC1A1\uAD70",4774e3:"\uACBD\uBD81\uC601\uC591\uAD70",4775e3:"\uACBD\uBD81\uC601\uB355\uAD70",4776e3:"\uACBD\uBD81\uCCAD\uB3C4\uAD70",4777e3:"\uACBD\uBD81\uACE0\uB839\uAD70",4778e3:"\uACBD\uBD81\uC131\uC8FC\uAD70",4779e3:"\uACBD\uBD81\uCE60\uACE1\uAD70",478e4:"\uACBD\uBD81\uC608\uCC9C\uAD70",4781e3:"\uACBD\uBD81\uBD09\uD654\uAD70",4782e3:"\uACBD\uBD81\uC6B8\uC9C4\uAD70",4783e3:"\uACBD\uBD81\uC6B8\uB989\uAD70",48e5:"\uACBD\uB0A8\uBCF8\uCCAD",4811e3:"\uACBD\uB0A8\uCC3D\uC6D0\uC2DC",4813e3:"\uACBD\uB0A8\uC9C4\uC8FC\uC2DC",4815e3:"\uACBD\uB0A8\uD1B5\uC601\uC2DC",4816e3:"\uACBD\uB0A8\uC0AC\uCC9C\uC2DC",4817e3:"\uACBD\uB0A8\uAE40\uD574\uC2DC",4818e3:"\uACBD\uB0A8\uBC00\uC591\uC2DC",4819e3:"\uACBD\uB0A8\uAC70\uC81C\uC2DC",482e4:"\uACBD\uB0A8\uC591\uC0B0\uC2DC",4871e3:"\uACBD\uB0A8\uC758\uB839\uAD70",4872e3:"\uACBD\uB0A8\uD568\uC548\uAD70",4873e3:"\uACBD\uB0A8\uCC3D\uB155\uAD70",4874e3:"\uACBD\uB0A8\uACE0\uC131\uAD70",4875e3:"\uACBD\uB0A8\uB0A8\uD574\uAD70",4876e3:"\uACBD\uB0A8\uD558\uB3D9\uAD70",4877e3:"\uACBD\uB0A8\uC0B0\uCCAD\uAD70",4878e3:"\uACBD\uB0A8\uD568\uC591\uAD70",4879e3:"\uACBD\uB0A8\uAC70\uCC3D\uAD70",488e4:"\uACBD\uB0A8\uD569\uCC9C\uAD70",49e5:"\uC81C\uC8FC\uBCF8\uCCAD"},T0=Object.keys(yd).map(t=>+t);var tc=Se(Ri(),1);var Me=Se(ec(),1),E_=(0,Me.default)("400_BAD_REQUEST","%s",400),R_=(0,Me.default)("401_UNAUTHORIZED","%s",401),v_=(0,Me.default)("402_FORBIDDEN","%s",403),T_=(0,Me.default)("404_NOT_FOUND","%s",404),C_=(0,Me.default)("500_INTERNAL_SERVER_ERROR","%s",500),P_=(0,Me.default)("501_NOT_IMPLEMENTED_ERROR","%s",501),zi=(0,Me.default)("502_BAD_GATEWAY","%s",502),A_=(0,Me.default)("503_SERVICE_UNAVAILABLE","%s",503);var{Pool:Nm}=tc.default,Ye=new Nm({connectionString:Va,...Ss&&Es&&ws&&{ssl:{ca:`-----BEGIN CERTIFICATE-----
${Ss}
-----END CERTIFICATE-----`,key:`-----BEGIN PRIVATE KEY-----
${Es}
-----END PRIVATE KEY-----`,cert:`-----BEGIN CERTIFICATE-----
${ws}
-----END CERTIFICATE-----`,checkServerIdentity:()=>{}}}});Ye.on("error",t=>{throw Ya==="production"?(console.error(t.message),zi("Database query error")):zi(t.message)});function rc(t){return`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`}function Qi(t){return t.toISOString().slice(0,10).split("-").join("")}var nc=`/* @name countCenterExpenditures */
SELECT COUNT(id)
FROM center_expenditure
WHERE FSCL_YY = $1;`;var sc=`/* @name countExpenditures */
SELECT COUNT(id)
FROM local_expenditure
WHERE excut_de = $1
  AND sfrnd_code >= $2
  AND sfrnd_code < $2 + 100000;`;var ic=`/* @name createCenterExpenditures */
INSERT INTO center_expenditure (
    FSCL_YY,
    OFFC_NM,
    FLD_NM,
    SECT_NM,
    PGM_NM,
    ACTV_NM,
    SACTV_NM,
    BZ_CLS_NM,
    Y_PREY_FIRST_KCUR_AMT,
    Y_PREY_FNL_FRC_AMT,
    Y_YY_MEDI_KCUR_AMT,
    Y_YY_DFN_MEDI_KCUR_AMT
  )
SELECT *
FROM unnest(
    $1::int [],
    $2::text [],
    $3::text [],
    $4::text [],
    $5::text [],
    $6::text [],
    $7::text [],
    $8::text [],
    $9::bigint [],
    $10::bigint [],
    $11::bigint [],
    $12::bigint []
  );`;var oc=`/* @name createExpenditures */
INSERT INTO local_expenditure (
    sfrnd_code,
    detail_bsns_nm,
    excut_de,
    budget_crntam,
    nxndr,
    cty,
    signgunon,
    etc_crntam,
    expndtram,
    orgnztnam,
    realm_code,
    sect_code
  )
SELECT *
FROM unnest(
    $1::int [],
    $2::text [],
    $3::timestamptz [],
    $4::bigint [],
    $5::bigint [],
    $6::bigint [],
    $7::bigint [],
    $8::bigint [],
    $9::bigint [],
    $10::bigint [],
    $11::int [],
    $12::int []
  );`;var ac=`/* @name deleteCenterExpenditures */
DELETE FROM center_expenditure
WHERE FSCL_YY = $1;`;var uc=`/* @name deleteExpenditures */
DELETE FROM local_expenditure
WHERE excut_de = $1
  AND sfrnd_code >= $2
  AND sfrnd_code < $2 + 100000;`;Hm();async function Hm(){let t=new Date(Ka);for(t.setFullYear(t.getFullYear()-+Rs);t.getFullYear()>2e3;t.setFullYear(t.getFullYear()-+vs))await(0,In.default)(()=>lc(t),{retries:10,onRetry:(e,r)=>console.warn(r,e.message)});await(0,In.default)(()=>lc(t),{retries:10,onRetry:(e,r)=>console.warn(r,e.message)});for(let e=2023-+Rs;e>2006;e-=+vs)await(0,In.default)(()=>Gm(e),{retries:10,onRetry:(r,s)=>console.warn(s,r.message)})}async function lc(t){for(let e of Object.keys(nn)){let r=`${e}00000`;console.log("\u{1F440} - date",t,"sidoCode",e,nn[+e]);let{data:s,head:o}=await cc(1,1,r,Qi(t));if(!s)continue;let u=1e3,l=o[0].list_total_count;process.stdout.write(`\u{1F440} - totalExpenditureCount: ${l}, `);let{rows:p}=await Ye.query(sc,[t,r]),d=p[0].count;if(console.log("count:",+(d??0)),!(d&&+d===l)){await Ye.query(uc,[t,r]);for(let f=1;(f-1)*u<l;f++){process.stdout.write(`${f} `);let{data:m}=await cc(f,u,r,Qi(t));m&&Ye.query(oc,[m.map(y=>+y.sfrnd_code),m.map(y=>y.detail_bsns_nm),m.map(y=>new Date(rc(y.excut_de))),m.map(y=>+y.budget_crntam),m.map(y=>+y.nxndr),m.map(y=>+y.cty),m.map(y=>+y.signgunon),m.map(y=>+y.etc_crntam),m.map(y=>+y.expndtram),m.map(y=>+y.orgnztnam),m.map(y=>y.realm_code),m.map(y=>y.sect_code)])}console.log("")}}}async function cc(t,e,r,s){let o=s.slice(0,4),u=`https://lofin.mois.go.kr/HUB/QWGJK?key=${Ja}&type=json&pIndex=${t}&pSize=${e}&accnut_year=${o}&wdr_sfrnd_code=${r}&excut_de=${s}`,p=await(await tr(u)).json();return p.RESULT?.CODE?{head:p.RESULT,data:null}:{head:p.QWGJK[0].head,data:p.QWGJK[1].row}}async function Gm(t){console.log("\u{1F440} - year",t);let{data:e,head:r}=await fc(1,1,t);if(!e)return;let s=1e3,o=r[0].list_total_count;console.log("\u{1F440} - totalExpenditureCount",o);let{rows:u}=await Ye.query(nc,[t]),l=u[0].count;if(!(l&&+l===o)){await Ye.query(ac,[t]);for(let p=1;(p-1)*s<o;p++){process.stdout.write(`${p} `);let{data:d}=await fc(p,s,t);d&&Ye.query(ic,[d.map(f=>+f.FSCL_YY),d.map(f=>f.OFFC_NM),d.map(f=>f.FLD_NM),d.map(f=>f.SECT_NM),d.map(f=>f.PGM_NM),d.map(f=>f.ACTV_NM),d.map(f=>f.SACTV_NM),d.map(f=>f.BZ_CLS_NM),d.map(f=>+f.Y_PREY_FIRST_KCUR_AMT),d.map(f=>+f.Y_PREY_FNL_FRC_AMT),d.map(f=>+f.Y_YY_MEDI_KCUR_AMT),d.map(f=>+f.Y_YY_DFN_MEDI_KCUR_AMT)])}console.log("")}}async function fc(t,e,r){let s=await tr(`https://openapi.openfiscaldata.go.kr/TotalExpenditure5?Key=${Za}&Type=json&pIndex=${t}&pSize=${e}&FSCL_YY=${r}&BDG_FND_DIV_CD=0&ANEXP_INQ_STND_CD=1`),o=JSON.parse(await s.json());return o.RESULT?.CODE?{head:o.RESULT,data:null}:o.message?{head:o.message,data:null}:{head:o.TotalExpenditure5[0].head,data:o.TotalExpenditure5[1].row}}
/*! Bundled license information:

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)
*/
